var copyPasteInfra=function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=855)}({0:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(21);t.utils=o;var n=r(56);t.idbPromised=n;var a=r(30);t.ULS=a.ULS,t.TraceLevel=a.TraceLevel,t.LogCategory=a.LogCategory,t.NulLogger=a.NulLogger,t.ConsoleLogger=a.ConsoleLogger;var i=r(40);t.browserSupport=i;var s=r(41);t.perfWatch=s;var c=r(57);t.initEwaUtils=c.initEwaUtils,t.ewaUtils=c.ewaUtils;var l=r(58);t.initStopwatchFactory=l.initStopwatchFactory;var d=r(59);t.getNewGuid=d.getNewGuid},1:function(e,t,r){"use strict";var o={};r.r(o),r.d(o,"sharedClipboardSettingsVariableName",function(){return ge}),r.d(o,"defaultPromiseTimeoutInMinutes",function(){return Ce}),r.d(o,"getSharedClipboardSettings",function(){return Se}),r.d(o,"initializeSharedClipboardSettingsFromWindow",function(){return be}),r.d(o,"initializeSharedClipboardSettings",function(){return we}),r.d(o,"createEmptySharedClipboardSettings",function(){return Ee});var n={};r.r(n),r.d(n,"divTagName",function(){return Zt}),r.d(n,"preTagName",function(){return $t}),r.d(n,"tableTagName",function(){return er}),r.d(n,"trTagName",function(){return tr}),r.d(n,"tdTagName",function(){return rr}),r.d(n,"ccpTimestampHtmlCustomAttributeName",function(){return ur}),r.d(n,"minCcpTimestampHtmlCustomAttributeValue",function(){return pr}),r.d(n,"ensureOneLFPerNewLine",function(){return gr}),r.d(n,"trimToLength",function(){return fr}),r.d(n,"createTextHtmlFromTextPlain",function(){return mr}),r.d(n,"createHtmlItemFromTextPlain",function(){return hr}),r.d(n,"createPlainTextFromHtml",function(){return yr}),r.d(n,"isContainsTimestampWrapper",function(){return Sr}),r.d(n,"addClipboardWrapperForEdge",function(){return br}),r.d(n,"getFragmentFromTextHtml",function(){return wr}),r.d(n,"getCcpTimestampHtmlCustomAttributeFromWrappingTag",function(){return vr}),r.d(n,"encodeAngleBrackets",function(){return Er}),r.d(n,"wrapContentWithTagAndAttributes",function(){return Lr});var a,i=r(0);function s(){return a}function c(e){if(!e)throw new Error("The 'logger' argument is missing");a=i.ULS.getFromExternalLogger(e)}var l,d,u,p,g,f=r(2),m="";function h(e,t){return y(e,[t])}function y(e,t){if(!function(e){if(!(e&&"object"==typeof e&&"reason"in e))return!1;if(!function(e){if(!e&&0!==e)return!1;var t=Number(e);if(isNaN(t)||t.toString()!==e.toString())return!1;return!0}(e.reason))return!1;return!0}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;var r=e.reason;return t.indexOf(r)>=0}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.SystemClipboardAndIndexedDB=1]="SystemClipboardAndIndexedDB",e[e.IndexedDB=2]="IndexedDB",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory"}(l||(l={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.IndexedDBSetClipboardItems=4]="IndexedDBSetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.IndexedDBGetClipboardItems=6]="IndexedDBGetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.SelectClipboardStrategy=14]="SelectClipboardStrategy",e[e.IndexedDBProviderNotSupported=15]="IndexedDBProviderNotSupported",e[e.IndexedDBCacheInitialization=16]="IndexedDBCacheInitialization",e[e.IndexedDBGetCache=17]="IndexedDBGetCache",e[e.IndexedDBDeleteDb=18]="IndexedDBDeleteDb",e[e.IndexedDBSetItem=19]="IndexedDBSetItem",e[e.IndexedDBGetItem=20]="IndexedDBGetItem",e[e.IndexedDBGetAllKeys=21]="IndexedDBGetAllKeys",e[e.IndexedDBGetAllItems=22]="IndexedDBGetAllItems",e[e.IndexedDBRemoveItem=23]="IndexedDBRemoveItem",e[e.IndexedDBRemoveAllItems=24]="IndexedDBRemoveAllItems",e[e.IndexedDBClearAll=25]="IndexedDBClearAll",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IndexedDBCacheInitializationTimeout=30]="IndexedDBCacheInitializationTimeout",e[e.IndexedDBSetTimeout=31]="IndexedDBSetTimeout",e[e.IndexedDBGetTimeout=32]="IndexedDBGetTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(p||(p={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(g||(g={}));var C=function(e){function t(r,o,n){var a=this,c=t.augmentParameterValue(r);if((a=e.call(this,c)||this).name=t.augmentParameterValue(o),a.errorName=a.name,a.name?s().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '"+a.name+"': "+c):s().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: "+c),n){a.innerError=n;var l=a.innerError.message;l||(l=a.innerError.name);var d=t.augmentParameterValue(l);d.length>0&&s().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: "+d)}return a.stack||(a.stack=(new Error).stack),a}return f.__extends(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():m},t}(Error),S=function(e){function t(r,o,n){var a=this,i=C.augmentParameterValue(o),s=t.getDefaultMessage(i),c=C.augmentParameterValue(r);return 0===c.length&&(c=s),(a=e.call(this,c,"MissingArgumentError",n)||this).name=i,a}return f.__extends(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '"+e+"'"),t},t}(C),b=function(e){function t(r,o,n,a){var i=this,s=C.augmentParameterValue(o),c=n;c||(c=m);var l=t.getDefaultMessage(s,c),d=C.augmentParameterValue(r);return 0===r.length&&(d=l),(i=e.call(this,d,"InvalidArgumentError",a)||this).name=s,i.value=c,i}return f.__extends(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '"+e+"' argument: '"+t+"'":"Invalid argument"},t}(C),w=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return f.__extends(t,e),t}(C),v=function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}return f.__extends(t,e),t}(C),E=function(e){function t(t,r,o,n,a){return e.call(this,t+". Data version: "+r+", Infra version: "+o+", blockMismatchDataVersion: "+n,"MismatchVersionError",a)||this}return f.__extends(t,e),t}(C),L=function(e){function t(t,r,o,n){return e.call(this,t+". Duration in clipboard (ms) : "+r+", TTL (ms): "+o,"TTLClipboardDataError",n)||this}return f.__extends(t,e),t}(C),P=function(e){function t(t,r,o,n){return e.call(this,t+". Data User Hash : "+r+", infra User Hash: "+o,"UserHashMismatchError",n)||this}return f.__extends(t,e),t}(C),T=function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}return f.__extends(t,e),t}(C);function I(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:m}var _=function(e){function t(t,r,o,n,a){var i=e.call(this,r||"reason="+t,o,n)||this;return i.reason=t,a&&(i.errorName=a),i}return f.__extends(t,e),t}(C),x=function(e){function t(t,r,o){return e.call(this,t,r,"CopyError",o,I(t,u))||this}return f.__extends(t,e),t}(_),A=function(e){function t(t,r,o){return e.call(this,t,r,"PasteError",o,I(t,p))||this}return f.__extends(t,e),t}(_),F=function(e){function t(t,r,o){return e.call(this,t,r,"CancelError",o,I(t,g))||this}return f.__extends(t,e),t}(_),M=function(e){function t(t,r,o){return e.call(this,t,r,"ClipboardPlatformError",o,I(t,d))||this}return f.__extends(t,e),t}(_),O=function(e){function t(t,r,o){return e.call(this,t,r,"SharedClipboardError",o,I(t,d))||this}return f.__extends(t,e),t}(_);function W(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach(function(e){if(t+=1,e)try{e()}catch(e){s().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" threw an exception: "+e.message),r||(r=new w(e.message,e))}else s().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" is empty")}),r)throw r}else s().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}function j(){return D}var D={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:m},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:m}},U={};function J(){U={}}var H=new RegExp("(\\bTrident/| MSIE )"),R=16.16299,N=17.17123,k=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function z(){if(void 0===U.isIEProperty){U.isIEProperty=!1;var e=j();if(e&&e.userAgent&&"function"==typeof e.userAgent){var t=e.userAgent();if(t){var r=t.match(H);r&&2===r.length&&(U.isIEProperty=!0)}}}return U.isIEProperty}function V(){if(void 0===U.isEdgeProperty){U.isEdgeProperty=!1,U.isEdgeWithTextHtmlClipboardSupportProperty=!1,U.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=j();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(k);if(r&&2===r.length){U.isEdgeProperty=!0;var o=Number(r[1]);isNaN(o)||(o>=R&&(U.isEdgeWithTextHtmlClipboardSupportProperty=!0),o>=N&&(U.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return U.isEdgeProperty}function B(){return V()&&U.isEdgeWithTextHtmlClipboardSupportProperty}function G(){return V()&&U.isEdgeVersionWithTextHtmlWrapperSupportProperty}function K(){return q}var q={postMessage:function(e,t,r,o){e.postMessage(t,r,o)}},X=function(e,t,r,o){return void 0===o&&(o=!1),e.addEventListener(t,r,o),function(){e.removeEventListener(t,r,o)}},Q="text/plain";function Y(){return{items:{}}}var Z,$,ee,te,re=(Z={items:{}},{getData:function(){return Z},getItem:function(e){},setItem:function(e,t){throw new w("Cannot set an item with clipboard data format '"+e+"' in an immutable empty clipboard (content is "+(t&&t.length>0?"not ":m)+"empty)")},get:function(){return ue(void 0)}});function oe(){return re}function ne(e){return e&&e.items?Object.keys(e.items).length:0}function ae(e){return ne(e&&e.getData())}function ie(e){void 0===e&&(e=void 0);var t=e;return t||(t={items:{}}),{getItem:function(e){return se(t,e)},setItem:function(e,r){!function(e,t,r){if(!e)throw new S(m,"clipboardItemsData");if(!e.items)throw new b(m,"clipboardItemsData.items");e.items[t]=r}(t,e,r)},getData:function(){return t},get:function(){return ue(t)}}}function se(e,t){if(!e)throw new S(m,"clipboardItemsData");if(!e.items)throw new b(m,"clipboardItemsData.items");return e.items[t]}function ce(e,t){if(!e||0===e.length||!t||!t.trim())return m;var r=void 0;return e.forEach(function(e){e.clipboardDataFormat===t&&(r=e.data)}),r||m}function le(e){return ce(e,Q)}function de(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:Q,data:m}),t}function ue(e){var t=[];if(0===ne(e))return t;for(var r in e.items){var o=se(e,r);o||(o=m);var n={clipboardDataFormat:r,data:o};t.push(n)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.IndexedDB=1]="IndexedDB",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage"}($||($={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose"}(ee||(ee={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(te||(te={}));var pe="-",ge="sharedClipboardSettings",fe=Ee(),me=!1,he=1,ye=3600,Ce=2;function Se(){if(!me)throw new w("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return fe}function be(){me=!1,function(){if(!(window&&ge in window))return fe=Ee(),void(me=!0);var e=window[ge];if(!e||"object"!=typeof e)return fe=Ee(),void(me=!0);ve(e)}()}function we(e){me=!1,ve(e)}function ve(e){if(!e)throw new S(m,"sharedClipboardSettingsCandidate");var t=Ee();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return fe=t,void(me=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return s().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),fe=t,void(me=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,o=r.indexOf(pe);o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(e){}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some(function(e){return!e||!e.trim()}))return s().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],fe=t,void(me=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(e){}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some(function(e){return!e||!e.trim()}))return s().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],fe=t,void(me=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return s().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],fe=t,void(me=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return s().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' or '"+r+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],fe=t,void(me=!0)}t.whitelistOriginComponents=!0,fe=t,me=!0}function Ee(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:m,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:he,sharedClipboardExpirationInMinutes:ye,clipboardPromiseTimeoutInMinutes:Ce,remoteLoggerPath:m}}function Le(){var e=m;return window&&window.location&&window.location.origin?(e=window.location.origin)||(e=m):(s().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: "+!!window+". is window.location exist: "+(window&&!!window.location)+". is window.location.origin exist "+(window&&window.location&&!!window.location.origin)+". is window.location.protocol exist "+(window&&window.location&&!!window.location.protocol)+". is window.location.hostname exist "+(window&&window.location&&!!window.location.hostname)+". is window.location.port exist "+(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}var Pe,Te,Ie="://",_e="http",xe="https",Ae=".",Fe="/",Me=":",Oe=new RegExp("^\\d+$"),We=!1;function je(e){if(!e)throw new S(m,"origin");var t=e.trim().toLowerCase(),r=m,o=t.split(Ie,3);if(!o||0===o.length||!o[0]||o[0]!==_e&&o[0]!==xe)throw new b("Missing protocol","origin",e);if(1===o.length)throw new b("Missing domain","origin",e);if(o.length>2)throw new b("'"+Ie+"' should appear once","origin",e);var n=o[1];if(!n)throw new b("Missing domain","origin",e);if(r=o[0]+Ie,!(o=(n=n.trim()).trim().split(Fe,3))||0===o.length||!o[0]||!o[0].trim())throw new b("Missing domain","origin",e);if(o.length>2)throw new b("The last part of the origin should be the domain","origin",e);if(2===o.length&&o[1])throw new b("The last part of the origin should be the domain","origin",e);if(!(o=n.split(Me,3))||0===o.length||!o[0]||!o[0].trim())throw new b("Missing domain","origin",e);if(o.length>2||2===o.length&&(!o[1]||!o[1].trim()))throw new b("The last part of the origin should be the domain and an optional port number","origin",e);if(r+=n=o[0].trim(),2===o.length){var a=o[1].trim(),c=Oe.exec(a);if(!c||1!==c.length)throw new b("Invalid port number","origin",e);var l=Number(a);if(isNaN(l))throw new b("Invalid port number","origin",e);r+=Me+a}return s().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getValidatedOrigin: origin = '"+e+"'; validated origin = '"+r+"'"),r}function De(e){Ne();var t=je(e),r=t.split(Ie);if(!r||2!==r.length||!r[0]||!r[1])throw new b("Invalid origin","parentOrigin",e);var o=Se(),n=m;if(o.whitelistOriginComponents){var a=r[0]+Ie;if(!(r=r[1].split(Ae))||r.length<2||!r[0])throw new b("Invalid origin","parentOrigin",e);r.splice(0,1,o.sharedClipboardHostingApp),n=a+r.join(Ae)}else n=t;return s().ULS.traceTag(596452424,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getSharedClipboardValidatedOrigin: app's origin = '"+e+"'; Shared Clipboard iframe origin = '"+n+"' components="+JSON.stringify(r)),n}function Ue(e){Ne();var t=je(e),r=je(Le().origin);if(t===r)return t;if(!Se().whitelistOriginComponents)throw new w("validateOriginForReceivedMessage: Caller origin '"+e+"' doesn't match the current window's origin '"+r+"'");var o=Je(t),n=Je(r);if(o.protocol!==n.protocol)throw new w("validateRemoteWindowOrigin: Caller origin's protocol '"+o.protocol+"' doesn't match the current window origin's protocol '"+n.protocol+"'");if(o.environment!==n.environment)throw new w("validateRemoteWindowOrigin: Caller origin's environment '"+o.environment+"' doesn't match the current window origin's environment '"+n.environment+"'");return t}function Je(e){Ne();var t=e.split(Ie,2),r=t[0],o=He(t[1]),n={protocol:r};if(n.environment=Re(e,o,Te),o.length<=n.environment.length+1)throw new b("Missing app component","origin",e);if(o.charAt(n.environment.length)!==Ae)throw new b("Missing a domain separator after the environment component","origin",e);var a=o.substr(n.environment.length+Ae.length);if(n.app=Re(e,a,Pe),n.app.length<a.length&&a.charAt(n.app.length)!==pe)throw new b("When the Office Online app name is not the domain prefix, '"+pe+"' should precede it","origin",e);return n}function He(e){if(!e)throw new S(m,"stringToReverse");for(var t=e.length,r=m,o=t-1;o>=0;o-=1)r+=e.charAt(o);return r}function Re(e,t,r){if(!t)throw new S(m,"reversedValidatedHostname");if(!r)throw new S(m,"reversedStringsToLengthMap");var o=t.length,n=Object.keys(r).filter(function(e){var n=r[e];return n<=o&&t.substr(0,n)===e});if(n&&n.length>0)return He(n[0]);throw new b("Invalid origin","validatedOrigin",e)}function Ne(){if(!We){var e=Se();e.whitelistOriginComponents&&(Pe=ke(e.sharedClipboardHostingApps),Te=ke(e.sharedClipboardHostingEnvironments),We=!0)}}function ke(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach(function(e){t[He(e)]=e.length}),t):t}var ze=1;function Ve(e){null==e?s().ULS.traceTag(595973151,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"validateUserHash: userHash is undefined."):e===ze&&s().ULS.traceTag(596451804,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"validateUserHash: userHash is set to the default non-user-hash value of "+ze)}function Be(e,t){return Ve(t),null==e||e===ze||null==t||e!==t}function Ge(){return Xe()}function Ke(){return Xe()}function qe(e){if(!e)throw new S(m,"id");var t=e.trim().toLowerCase();if(0===t.length)throw new b(m,"id");return t}function Xe(){return(Math.random()+1).toString(36).substring(7)}function Qe(e,t,r,o,n){var a={id:e,operationCode:t,destination:r,userHash:o,clipboardItemsData:n};return $e(a),a}var Ye=function(){function e(){}return e.localStorageData="localStorage/data",e.indexedDBData="indexedDB/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function Ze(e){return"get"===e||"set"===e||"init"===e}var $e=function(e){if(!e)throw new S(m,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new S(m,"id");if(!e.operationCode)throw new S(m,"operationCode");if(!e.destination)throw new S(m,"destination");if(!Ze(e.operationCode))throw new b(m,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new b("'"+e.operationCode+"' expects no clipboard items","clipboardItemsData")};function et(e,t,r,o,n){var a={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:n};return tt(a),a}var tt=function(e){if(!e)throw new S(m,"clipboardOperationResultMessage");if(!e.id||0===e.id.trim().length)throw new S(m,"id");if(!e.operationCode)throw new S(m,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new b(m,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new b("A failed '"+e.operationCode+"' operation expects a non-empty error argument","error");if(e.clipboardItemsData)throw new b("A failed '"+e.operationCode+"' operation does not expect a clipboardItemsData argument","clipboardItemsData")}else{if(e.error)throw new b("'"+e.operationCode+"' expects an empty error argument","error");if("unknownresult"===e.operationCode)throw new b("'"+e.operationCode+"' can only be used with a failure message","operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new b("'"+e.operationCode+"' expects a clipboardItems argument","clipboardItemsData")}else if(e.clipboardItemsData)throw new b("'"+e.operationCode+"' expects no clipboardItemsData argument","clipboardItemsData")};function rt(e){if(!e||0===e.trim().length)throw new b(m,"className",e);return function(){var t=!1;function r(t){return e+":"+t+": already disposed"}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&s().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new w(r(e))}}}()}var ot=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=rt(""+e)}return e.prototype.initialize=function(e){var t=this;return e.then(function(e){return t.clipboardStorage=e,s().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '"+t.clipboardStrategyType+"' was initialized."),Promise.resolve(t)},function(e){return s().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Failed to initialize clipboard strategy type '"+t.clipboardStrategyType+"'. Error: "+i.utils.getStringifiedError(e)),Promise.reject(e)})},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new M(d.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new M(d.SetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new M(d.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then(function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)})}catch(e){return Promise.reject(new M(d.GetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(oe(),e):(s().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new M(d.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new M(d.ClearClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").onSystemClipboardChangedExternally",e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),nt=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function at(e){var t=e;return t&&0!==t.trim().length||(t=Ge()),new lt(t)}function it(){return nt?window.performance.now():Date.now()}function st(e){return nt?new Date(e+window.performance.timing.navigationStart):new Date(e)}function ct(e,t,r){if(!r)throw new S(m,"creationTimestamp");return(e?"Fulfilled":"Still unfulfilled")+" after "+(e?t?t-r:"?":it()-r)+"ms"}var lt=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=qe(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=it(),s().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #"+this.sequenceId+" with id '"+this.id+"' on "+st(this.creationTimestamp)),this.promise=new Promise(function(e,t){s().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #"+r.sequenceId+" with id '"+r.id+"' on "+st(it())),r.internalResolve=e,r.internalReject=t})}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):s().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):s().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=it(),s().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #"+this.sequenceId+" with id '"+this.id+"' as fulfilled ("+(this.rejected?"rejected":"resolved")+"). "+ct(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)))},e.prototype.fulfillmentCheck=function(e){return s().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"'"),this.isFulfilled&&s().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"' since it was "+(this.rejected?"rejected":"resolved")+" already on "+st(this.fulfillmentTimestamp)+". "+ct(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)),this.isFulfilled},e.sequenceId=0,e}();function dt(){return new ut}var ut=function(){function e(){this.deferredResultMessagePromiseCache={}}return e.prototype.getDeferredPromise=function(e){var t=qe(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return s().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '"+e+"'."),t.promise;s().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '"+e+"'.")},e.prototype.addNewPromise=function(e){var t=at(e);if(this.getDeferredPromise(t.id))throw new b("A deferred promise already exists in the cache for the specified id","id",t.id);var r=qe(t.id);return this.deferredResultMessagePromiseCache[r]=t,s().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '"+t.id+"'."),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=qe(e);delete this.deferredResultMessagePromiseCache[t],s().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '"+e+"'.")}else s().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '"+e+"' since this id is not associated with an existing deferred promise.")},e.prototype.clear=function(){if(s().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing "+this.getLength()+" items from the cache"),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){s().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '"+e+"' with this exception: "+t.message+". Ignoring.")}}this.deferredResultMessagePromiseCache={}},e}();function pt(e){if(!e)throw new S(m,"validator");return{deserialize:function(t){return function(e,t){if(!e)throw new S(m,"incomingMessage");if(!t)throw new S(m,"validator");if(0===e.length)throw new b("An empty message is invalid","incomingMessage");var r,o=e.trim();if(0===o.length)throw new b("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(o)}catch(t){throw new b("Deserialization failed","incomingMessage","Contains "+e.length.toString()+" characters",t)}if(!r)throw new b("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function gt(e){if(!e)throw new S(m,"validator");return{serialize:function(t){return function(e,t){if(!e)throw new S(m,"outgoingMessage");if(!t)throw new S(m,"validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new b("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return s().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}}function ft(e){if(!e)throw new S(m,"remoteWindow");if(!("window"in e&&e.window))throw new S(m,"remoteWindow.window");if(!("windowOrigin"in e&&e.windowOrigin))throw new S(m,"remoteWindow.windowOrigin");var t=Ue(e.windowOrigin);return{window:e.window,windowOrigin:t}}var mt=function(){function e(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=rt(o)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(W([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new S(m,"outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw s().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new w(t)}this.sender.postMessage(e)},e}();function ht(){return yt}var yt={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};function Ct(e,t,r){return new wt(e,t,r)}function St(e,t,r){return new wt(e,t,r)}var bt="message",wt=function(){function e(e,t,r){var o=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return o.onMessageReceived(e)},!e)throw new S(m,"deserializer");if(!t)throw new S(m,"handler");if(!r)throw new S(m,"windowRPC");this.disposableImplementationExtension=rt("WindowRPCReceiverInternal"),this.remoteWindow=r.remoteWindow,ht().addEventListener(bt,this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(ht().removeEventListener(bt,this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return s().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return s().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return s().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return s().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){s().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to deserialize incoming message. "+i.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(i.utils.getStringifiedError(e))}catch(e){s().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+i.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch(function(e){s().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))})}catch(e){s().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}else s().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();function vt(e,t){return new Lt(e,t)}function Et(e,t){return new Lt(e,t)}var Lt=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new S(m,"serializer");if(!t)throw new S(m,"windowRPC");this.disposableImplementationExtension=rt("WindowRPCSenderInternal"),this.remoteWindow=t.remoteWindow}return e.prototype.postMessage=function(e){if(!e)throw new S(m,"outgoingMessage");if(!this.remoteWindow.window)throw new w("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new w("The remote window does not support postMessage");var t=this.serializer.serialize(e);K().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}(),Pt="OfficeOnlineCCP_Metadata_",Tt="OfficeOnlineCCP_Data_",It="_LocalStorageChangedFlag";function _t(){try{return localStorage.setItem("XLO_CCP","1"),"1"===localStorage.getItem("XLO_CCP")}catch(e){return!1}}function xt(e){return Tt+e}function At(e){return Pt+e}function Ft(e){return At(e)+It}var Mt,Ot=function(){this.copyStatus=Mt.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0},Wt=function(){};function jt(){return{}}function Dt(e){var t=void 0;return e&&e.lastCopy&&(t=f.__assign({},e.lastCopy)),{lastCopy:t}}function Ut(e){try{s().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '"+$.LocalStorage+"'");var t=new Jt(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(Mt||(Mt={}));var Jt=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new M(d.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: filed access to localStorage",e)}if(!e)throw new M(d.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=$.LocalStorage,this.disposableImplementationExtension=rt("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),s().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters='"+(e?JSON.stringify(e):m)+"'");var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(oe());try{var r=JSON.parse(t);if(!r||0===ne(r))return Promise.resolve(oe());var o=ie(r);return Promise.resolve(o)}catch(e){return Promise.resolve(oe())}},e.prototype.set=function(e,t){if(this.disposableImplementationExtension.throwIfDisposed("set"),s().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count="+ae(e)+"'; commandParameters='"+(t?JSON.stringify(t):m)+"'"),0===ae(e))localStorage.removeItem(this.localStorageKey);else{localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r=""+(this.localStorageKey+It),o=Ge();s().ULS.traceTag(595715530,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = "+r+". eventFlagValue = "+o),localStorage.setItem(r,o)}return Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[Q,"text/html","data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Ht(e){return s().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '"+l.LocalStorage+"' with localStorageKey: '"+e+"'"),(new Rt).initialize(Ut(e))}var Rt=function(e){function t(t){return e.call(this,l.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return f.__extends(t,e),t}(ot),Nt=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this))}return e.prototype.onStorageChanged=function(e){var t=this;s().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),s().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = "+e.key+". localStorageKeyToWatch = "+this.localStorageKeyToWatch+". lastLocalStorageValue = "+this.lastLocalStorageValue),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),s().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then(function(){t.raiseMetadataChangedEvent()},function(){s().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")}))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return s().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = "+this.lastLocalStorageValue),this.clipboardStrategy.get({userHash:0}).then(function(t){e.listener(t),s().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = "+e.lastLocalStorageValue)},function(e){s().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")})},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return s().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = "+this.lastLocalStorageValue+". currentLocalStorageValue = "+e),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(s().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged())return s().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = "+this.lastLocalStorageValue),Promise.resolve();var r=at(),o=new Date,n=setInterval(function(){var a=(new Date).getTime()-o.getTime();s().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = "+o+". elapseTime = "+a+". lastLocalStorageValue = "+t.lastLocalStorageValue),t.isLocalStorageValueChanged()?(clearInterval(n),s().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = "+o+". elapseTime = "+a+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.resolve()):a>e&&(clearInterval(n),s().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = "+o+". elapseTime = "+a+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.reject())},200);return r.promise},e}(),kt="\t",zt="\n",Vt="\r",Bt=new RegExp("("+zt+Vt+")|("+Vt+zt+")|("+Vt+")","g"),Gt=new RegExp("("+kt+")","g"),Kt=10240,qt=new RegExp("<","g"),Xt="&lt;",Qt=new RegExp(">","g"),Yt="&gt;",Zt="div",$t="pre",er="table",tr="tr",rr="td",or="\x3c!--StartFragment--\x3e",nr="\x3c!--EndFragment--\x3e",ar=or.length,ir=nr.length,sr="Version:0.9"+zt+"StartHTML:0000000100"+zt+"EndHTML:{EndHTML0}"+zt+"StartFragment:0000000134"+zt+"EndFragment:{EndFragm}"+zt+"<html>"+zt+"<body>"+zt+or+zt,cr=""+nr+zt+"</body>"+zt+"</html>",lr="0000000000",dr="</html>".length,ur="data-ccp-timestamp",pr=0;function gr(e){return e?e.replace(Bt,zt):e}function fr(e){return e?e.length<=Kt?e:e.substr(0,Kt):m}function mr(e){var t,r=Er(e),o=function(e){return e?e.replace(Bt,"</"+rr+"></"+tr+"><"+tr+"><"+rr+">"):e}((t=r)?t.replace(Gt,"</"+rr+"><"+rr+">"):t);return"<"+er+"><"+tr+"><"+rr+">"+o+"</"+rr+"></"+tr+"></"+er+">"}function hr(e,t,r){if(r!==pr&&!r)throw new S(m,"timestamp");if(isNaN(r))throw new b(m,"timestamp",r.toString());return br(function(e,t,r){return"<"+e+" "+ur+"='"+r+"'>"+t+"</"+e+">"}(e,mr(t),r))}function yr(e){var t=[],r=e.getElementsByTagName("tr");if(r.length>0){var o=Cr(r[0]);t.push(o);for(var n=1;n<r.length;n+=1){t.push(Vt),t.push(zt);var a=Cr(r[n]);t.push(a)}}return t.join("")}function Cr(e){var t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(var o=1;o<r.length;o+=1)t.push(kt),t.push(r[o].innerText)}return t.join("")}function Sr(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(ur)}function br(e){if(!V()||G())return e;var t=lr.length,r=sr.length+e.length+cr.length,o=(r-cr.length).toString();if(o.length<t&&(o=lr.substr(0,t-o.length)+o),o.length!==t){var n="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is "+o.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128536,i.LogCategory.msoulscat_ES_EWAJS,!1,n),new M(d.UnexpectedClipboardTextHtmlContentLength,n)}var a=(r-dr).toString();if(a.length<t&&(a=lr.substr(0,t-a.length)+a),a.length!==t){n="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is "+a.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128537,i.LogCategory.msoulscat_ES_EWAJS,!1,n),new M(d.UnexpectedClipboardTextHtmlContentLength,n)}var c=sr.replace("{EndHTML0}",a).replace("{EndFragm}",o)+e+cr;return s().ULS.shipAssertTag(596128538,i.LogCategory.msoulscat_ES_EWAJS,c.length===r,"addClipboardWrapperForEdge: The resulting text/html payload length of "+c.length+" differs from the expected length of "+r),c}function wr(e){if(!e)return m;if(!e.trim())return e;var t=e.indexOf(or),r=e.indexOf(nr);if(t<0||r<0||t>r)return e;var o=t+ar,n=r-o,a=e.indexOf(or,o),i=e.indexOf(nr,r+ir);return a>=0||i>=0?e:e.substr(o,n)}function vr(e){var t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new S(m,"attributeName");var r=new RegExp(t+"=['\"](\\d+)['\"]","i").exec(e);if(!r||r.length<2)return;return r[1]}(e,ur);if(t&&t.trim()){var r=Number(t);if((r||r===pr)&&!isNaN(r))return r}}function Er(e){return e?e.replace(qt,Xt).replace(Qt,Yt):m}function Lr(e,t,r){var o="";return r&&(o=Object.keys(r).reduce(function(e,t){return t?e+" "+t+"='"+r[t]+"'":e},"")),"<"+t+o+">"+e+"</"+t+">"}r.d(t,"cc",function(){return s}),r.d(t,"Db",function(){return c}),r.d(t,"Fb",function(){return h}),r.d(t,"Gb",function(){return y}),r.d(t,"a",function(){return C}),r.d(t,"B",function(){return S}),r.d(t,"t",function(){return b}),r.d(t,"u",function(){return w}),r.d(t,"L",function(){return v}),r.d(t,"A",function(){return E}),r.d(t,"J",function(){return L}),r.d(t,"M",function(){return P}),r.d(t,"K",function(){return T}),r.d(t,"b",function(){return _}),r.d(t,"m",function(){return x}),r.d(t,"G",function(){return A}),r.d(t,"c",function(){return F}),r.d(t,"e",function(){return M}),r.d(t,"I",function(){return O}),r.d(t,"Yb",function(){return W}),r.d(t,"Cb",function(){return J}),r.d(t,"Kb",function(){return z}),r.d(t,"Hb",function(){return V}),r.d(t,"Jb",function(){return B}),r.d(t,"Ib",function(){return G}),r.d(t,"zb",function(){return K}),r.d(t,"ib",function(){return m}),r.d(t,"Ub",function(){return" "}),r.d(t,"Tb",function(){return"."}),r.d(t,"Rb",function(){return"1"}),r.d(t,"Sb",function(){return"1"}),r.d(t,"i",function(){return l}),r.d(t,"j",function(){return"copy"}),r.d(t,"p",function(){return"cut"}),r.d(t,"D",function(){return"paste"}),r.d(t,"k",function(){return"copy"}),r.d(t,"q",function(){return"cut"}),r.d(t,"E",function(){return"paste"}),r.d(t,"O",function(){return X}),r.d(t,"gb",function(){return Q}),r.d(t,"hb",function(){return"Text"}),r.d(t,"bc",function(){return"text/html"}),r.d(t,"Bb",function(){return"image/png"}),r.d(t,"Pb",function(){return"metadata/is-last-copy-was-external"}),r.d(t,"Qb",function(){return"metadata/is-last-copy-was-external-XLO-source"}),r.d(t,"Ob",function(){return"metadata/ccp-infra-version"}),r.d(t,"Nb",function(){return"copyId"}),r.d(t,"pb",function(){return Y}),r.d(t,"rb",function(){return oe}),r.d(t,"nb",function(){return ne}),r.d(t,"mb",function(){return ae}),r.d(t,"Q",function(){return ie}),r.d(t,"lb",function(){return se}),r.d(t,"kb",function(){return ce}),r.d(t,"ob",function(){return le}),r.d(t,"sb",function(){return de}),r.d(t,"g",function(){return $}),r.d(t,"r",function(){return ee}),r.d(t,"f",function(){return d}),r.d(t,"n",function(){return u}),r.d(t,"H",function(){return p}),r.d(t,"d",function(){return g}),r.d(t,"s",function(){return te}),r.d(t,"wb",function(){return De}),r.d(t,"gc",function(){return Ue}),r.d(t,"C",function(){return ze}),r.d(t,"hc",function(){return Ve}),r.d(t,"ac",function(){return Be}),r.d(t,"ab",function(){return Ge}),r.d(t,"T",function(){return Ke}),r.d(t,"jb",function(){return qe}),r.d(t,"R",function(){return Qe}),r.d(t,"z",function(){return Ye}),r.d(t,"Mb",function(){return Ze}),r.d(t,"ec",function(){return $e}),r.d(t,"S",function(){return et}),r.d(t,"fc",function(){return tt}),r.d(t,"h",function(){return ot}),r.d(t,"U",function(){return at}),r.d(t,"V",function(){return dt}),r.d(t,"W",function(){return rt}),r.d(t,"Z",function(){return pt}),r.d(t,"bb",function(){return gt}),r.d(t,"Eb",function(){return"initmessageid"}),r.d(t,"dc",function(){return"unknownmessageid"}),r.d(t,"Vb",function(){return"CreatorOrigin"}),r.d(t,"xb",function(){return ft}),r.d(t,"N",function(){return mt}),r.d(t,"eb",function(){return Ct}),r.d(t,"cb",function(){return St}),r.d(t,"fb",function(){return vt}),r.d(t,"db",function(){return Et}),r.d(t,"v",function(){return It}),r.d(t,"Lb",function(){return _t}),r.d(t,"tb",function(){return xt}),r.d(t,"ub",function(){return At}),r.d(t,"vb",function(){return Ft}),r.d(t,"l",function(){return Ot}),r.d(t,"F",function(){return Wt}),r.d(t,"o",function(){return Mt}),r.d(t,"qb",function(){return jt}),r.d(t,"P",function(){return Dt}),r.d(t,"yb",function(){return Le}),r.d(t,"Y",function(){return Ht}),r.d(t,"x",function(){return Rt}),r.d(t,"X",function(){return Ut}),r.d(t,"w",function(){return Jt}),r.d(t,"y",function(){return Nt}),r.d(t,"Wb",function(){return"SessionId"}),r.d(t,"Xb",function(){return"WacCluster"}),r.d(t,"Ab",function(){return n}),r.d(t,"Zb",function(){return o})},2:function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return n}),r.d(t,"__assign",function(){return a}),r.d(t,"__rest",function(){return i}),r.d(t,"__decorate",function(){return s}),r.d(t,"__param",function(){return c}),r.d(t,"__metadata",function(){return l}),r.d(t,"__awaiter",function(){return d}),r.d(t,"__generator",function(){return u}),r.d(t,"__exportStar",function(){return p}),r.d(t,"__values",function(){return g}),r.d(t,"__read",function(){return f}),r.d(t,"__spread",function(){return m}),r.d(t,"__spreadArrays",function(){return h}),r.d(t,"__await",function(){return y}),r.d(t,"__asyncGenerator",function(){return C}),r.d(t,"__asyncDelegator",function(){return S}),r.d(t,"__asyncValues",function(){return b}),r.d(t,"__makeTemplateObject",function(){return w}),r.d(t,"__importStar",function(){return v}),r.d(t,"__importDefault",function(){return E});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function n(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function s(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,o){t(r,o,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,r,o){return new(r||(r=Promise))(function(n,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(i,s)}c((o=o.apply(e,t||[])).next())})}function u(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function p(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function g(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function f(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function h(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,n++)o[n]=a[i];return o}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function C(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){n[e]&&(o[e]=function(t){return new Promise(function(r,o){a.push([e,t,r,o])>1||s(e,t)})})}function s(e,t){try{(r=n[e](t)).value instanceof y?Promise.resolve(r.value.v).then(c,l):d(a[0][2],r)}catch(e){d(a[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function S(e){var t,r;return t={},o("next"),o("throw",function(e){throw e}),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:y(e[o](t)),done:"return"===o}:n?n(t):t}:n}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=g(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise(function(o,n){(function(e,t,r,o){Promise.resolve(o).then(function(t){e({value:t,done:r})},t)})(o,n,(t=e[r](t)).done,t.value)})}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function E(e){return e&&e.__esModule?e:{default:e}}},21:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce(function(e,o){return e.then(function(){return r&&r.stop?Promise.resolve(void 0):t(o,r)})},Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>o)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])});var a=Object.getPrototypeOf(t);a&&"object"==typeof a&&Object.keys(a).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])});var i={};Object.keys(n).forEach(function(t){i[t]=e(n[t],r+1)});return i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var o=5;var n="_",a=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(a,n).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===n&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===n&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(void 0),o=function(t){r=r.catch(function(r){return e(t,r)})},n=1;n<=t;n+=1)o(n);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.resolve();for(var r=t(e[0]),o=function(o){var n=e[o];r=r.catch(function(){return t(n)})},n=1;n<e.length;n+=1)o(n);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,o=e.length,n=0;n<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(n)),n!==o-1);n+=2)r=4294967295&((r<<5)+r^e.charCodeAt(n+1));var a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a},t.getCharIndexInTextFromPoint=function(e,t){var r=-1,o=null;if(void 0!==document.caretPositionFromPoint)null!==(n=document.caretPositionFromPoint(e,t))&&(r=n.offset,o=null!=n.offsetNode&&null!=n.offsetNode.parentElement&&"SPAN"===n.offsetNode.parentElement.nodeName?n.offsetNode.parentElement:n.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(n=document.caretRangeFromPoint(e,t))&&(r=n.startOffset,o=null!=n.startContainer&&null!=n.startContainer.parentElement&&"SPAN"===n.startContainer.parentElement.nodeName?n.startContainer.parentElement:n.startContainer)}else try{var n;o=document.elementFromPoint(e,t),(n=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(o),a.setEndPoint("EndToStart",n),r=a.text.length}catch(e){return r}for(;null!=o;)null!=(o=o.previousSibling)&&null!=o.textContent&&(r+=o.textContent.length);return r}},30:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,o){return t.traceTag(0,e,r,o)},traceTag:function(e,r,o,n){return t.traceTag(e,r,o,n)},debugTrace:function(e,r,o){return t.debugTraceTag(0,e,r,o)},debugTraceTag:function(e,r,o,n){return t.debugTraceTag(e,r,o,n)},assert:function(e,r,o){return t.assertTag(0,e,r,o)},assertTag:function(e,r,o,n){return t.assertTag(e,r,o,n)},shipAssert:function(e,r,o){return t.shipAssertTag(0,e,r,o)},shipAssertTag:function(e,r,o,n){return t.shipAssertTag(e,r,o,n)}}}}};var o=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)},e.prototype.assertTag=function(e,t,r,o){console.assert(r,"assertTag",e,t,o)},e.prototype.traceTag=function(e,t,r,o){console.log("traceTag",e,o,t,r)},e.prototype.debugTraceTag=function(e,t,r,o){console.log("debugTraceTag",e,o,t,r)},e}();t.ConsoleLogger=o;var n=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=n},40:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={},n="promises";t.promises=function(){return void 0===o[n]&&(o[n]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),o[n]}},41:function(e,t,r){"use strict";function o(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function n(e,t,r){e[t]=o()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=o(),r=e,a=t,i={},s=function(e,t,o){return function(e,t,r,o,a,i){n(e,"end",r);var s={sessionName:t,result:o?"success":"failure",message:i,marks:e},c=JSON.stringify(s);a(c)}(i,r,a,e,t,o)};return i.start=0,{mark:function(e){return function(e){return n(i,e,a)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)}},56:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=r(21);function a(e,t,r){return e?!(t&&!e.objectStoreNames.contains(t))||(r({name:"ValidationError",message:"The database doesn't contain store name: "+t}),!1):(r({name:"ValidationError",message:"The database should be initialized"}),!1)}var i=void 0;function s(e){void 0!==i&&i(e)}function c(e,t,r,o){return new Promise(function(n,i){if(a(e,t,i)){var s,c=e.transaction([t],r);c.oncomplete=function(){return n()},c.onerror=function(){return i(s||c.error)},c.onabort=function(){return i(s||c.error)};var l=c.objectStore(t),d=o(l);d.onerror=function(){s=d.error}}})}t.registerTraceSubscriber=function(e){i=e},t.clearTraceSubscriber=function(){i=void 0},t.setTestDbFactory=function(e){o=e},t.getDbFactory=function(){if(o)return o;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(r){var e=n.getStringifiedError(r);e&&e!==n.defaultToJSONResultWhenStringifyFails||!r||!r.message||(e=r.message);var t=n.getPerfWatchMarkName(e);s("indexedDB_access_error"+(t&&t.length>0?"_":"")+t)}},t.getStoreReadinessPromise=function(e){return new Promise(function(t,r){e.transaction.oncomplete=function(){return t()},e.transaction.onerror=function(){return r(e.transaction.error)}})},t.initDb=function(e,t,r,o){return new Promise(function(n,a){s("idb_open");var i,c,l,d,u=r||0===r?e.open(t,r):e.open(t),p=(i=!1,c=!1,l=function(e){s("idb_open_"+e)},d=function(){return c?(l("already_resolved"),!1):!i||(l("already_rejected"),!1)},{rejectOnce:function(e){l("should_reject"),d()&&(l("rejecting"),i=!0,a(e))},resolveOnce:function(e){l("should_resolve"),d()&&(l("resolving"),c=!0,n(e))}});u.onupgradeneeded=function(e){s("idb_open_onupgradeneeded_start");var r=e.target.result;if(e.oldVersion>0&&function(e){s("idb_open_onupgradeneeded_deleteAllObjectStores");for(var t=[],r=e.objectStoreNames.length-1;r>=0;r-=1){var o=e.objectStoreNames.item(r);(o||""===o)&&t.push(o)}t.forEach(function(t){s("idb_open_onupgradeneeded_delete_store_"+t),e.deleteObjectStore(t)})}(r),o){s("idb_open_onupgradeneeded_create_stores");var n=o(r);n&&n.length>0&&Promise.all(n).then(function(){s("idb_open_onupgradeneeded_stores_ready"),p.resolveOnce({db:r,dbName:t})},function(e){s("idb_open_onupgradeneeded_stores_ready_error"),p.rejectOnce(e)})}s("idb_open_onupgradeneeded_end")},u.onsuccess=function(e){s("idb_open_onsuccess"),p.resolveOnce({db:e.target.result,dbName:t})},u.onerror=function(){s("idb_open_onerror"),p.rejectOnce(u.error)},u.onblocked=function(e){s("idb_open_onblocked"),p.rejectOnce(e)}})},t.deleteDb=function(e,t){return new Promise(function(r,o){var n=e.deleteDatabase(t);n.onsuccess=function(){return r()},n.onblocked=function(){return r()},n.onerror=function(){return o(n.error)}})},t.doTransactionAction=c,t.put=function(e,t,r,o){return c(e,t,"readwrite",function(e){return r?e.put(o,r):e.put(o)})},t.get=function(e,t,r){return new Promise(function(o,n){if(a(e,void 0,n)){var i;e.objectStoreNames.contains(t)||o(void 0);var s=void 0,c=e.transaction([t],"readonly");c.oncomplete=function(){return o(s)},c.onerror=function(){return n(i||c.error)},c.onabort=function(){return n(i||c.error)};var l=c.objectStore(t).get(r);l.onsuccess=function(e){s=e.target.result},l.onerror=function(){i=l.error}}})},t.getAllItems=function(e,t){return new Promise(function(r,o){if(a(e,t,o)){var n,i=[],s=e.transaction([t],"readonly");s.oncomplete=function(){return r(i)},s.onerror=function(){return o(n||s.error)},s.onabort=function(){return o(n||s.error)};var c=s.objectStore(t).openCursor();c.onsuccess=function(e){var t=e.target.result;t&&(i.push(t.value),t.continue())},c.onerror=function(){n=c.error}}})},t.getAllKeys=function(e,t){return new Promise(function(r,o){if(a(e,t,o)){var n,i=[],s=e.transaction([t],"readonly");s.oncomplete=function(){return r(i)},s.onerror=function(){return o(n||s.error)},s.onabort=function(){return o(n||s.error)};var c=s.objectStore(t).openCursor();c.onsuccess=function(e){var t=e.target.result;t&&(i.push(t.key),t.continue())},c.onerror=function(){n=c.error}}})},t.remove=function(e,t,r){return c(e,t,"readwrite",function(e){return e.delete(r)})},t.removeAll=function(e,t){return c(e,t,"readwrite",function(e){return e.clear()})}},57:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return o},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");o=e}},58:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(o=function(){return self.performance.now()}),function(r){var n=o(),a=r;return{reset:function(e){null!=e&&(a=e),n=o()},stop:function(){var r=o()-n,i=JSON.stringify({Target:a,Duration:r.toFixed(t)});e(i)}}}}},59:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var o=!1,n=window.performance;try{n&&n.now&&n.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var a=0;a<e.length;a+=1){try{if(o){t.perfNow=!0;var i=Math.floor(100*n.now())%10;(i<0||i>9)&&(i=0);for(var s=0;s<i;s+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[a]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)}),t]}},855:function(e,t,r){"use strict";r.r(t);var o=r(1),n=r(2),a=r(0);function i(e,t,r,o){return o&&Object(a.initEwaUtils)(o),new c(e,t,r)}var s="CopyPasteFlowManagerOnMetadataChangedListener",c=function(){function e(e,t,r){if(this.clipboardPlatformEnvironment=e,this.applicationHost=t,this.inProgressCopyContext=void 0,this.deferredPasteData=void 0,!r)throw new o.B(o.ib,"logger");Object(o.Db)(r),Object(o.cc)().ULS.shipAssertTag(596456157,a.LogCategory.msoulscat_ES_EWAJS,!!e,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'clipboardPlatformEnvironment' argument"),Object(o.cc)().ULS.shipAssertTag(596456158,a.LogCategory.msoulscat_ES_EWAJS,!!t,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'applicationHost' argument"),this.metadataManager=e.getMetadataManager(),this.metadataManager.addMetadataChangeListener(s,this.onMetadataChanged.bind(this)),Object(o.cc)().ULS.shipAssertTag(596456156,a.LogCategory.msoulscat_ES_EWAJS,!!this.metadataManager,"CopyPasteInfra.copyPasteFlowManager.ctor: metadataManager is not valid")}return Object.defineProperty(e.prototype,"clipboardStrategy",{get:function(){if(this.clipboardPlatformEnvironment)return this.clipboardPlatformEnvironment.getClipboardStrategy();throw new o.u("clipboardPlatformEnvironment is missing")},enumerable:!0,configurable:!0}),e.prototype.onCopy=function(e){var t,r,n=this;if(!e)return Promise.reject(new o.m(o.n.MissingArgumentError,"Missing commandParameters argument",new o.B(o.ib,"commandParameters")));t=new o.l;try{t.id=Object(o.T)(),Object(o.cc)().ULS.traceTag(595937123,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: copy "+t.id+" started."),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e;var i=this.getCopyFlowHandler(t);t.sourceItem=this.getSourceItem(i,t),this.clearInProgressCopyIfNeeded(t),this.inProgressCopyContext=t,r=this.serialize(i,t),Object(o.cc)().ULS.traceTag(595937152,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,"CopyPasteFlowManager.onCopy: updating metadata for copy id "+t.id+" after serialize."),this.metadataManager.updateMetadata({lastCopy:t})}catch(r){return t?Object(o.cc)().ULS.traceTag(595734742,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: catching error for copy id "+t.id+" during serialize."):Object(o.cc)().ULS.traceTag(595734743,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.onCopy: catching error and no copy context during serialize."),this.copyCompleteCleanup(t,e),Promise.reject(r)}try{return Promise.all([this.setClipboardSync(r.synchronousResult,e,t).then(function(){return n.rejectIfCopyCancelled(t)}).then(function(){t.copyStatus=o.o.SynchronousPhaseCompleted,Object(o.cc)().ULS.traceTag(595937153,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: updating metadata for copy id "+t.id+" after status changed to SynchronousPhaseCompleted."),n.metadataManager.updateMetadata({lastCopy:t})}).catch(function(e){if(t?Object(o.cc)().ULS.traceTag(595734744,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: catch error for copy id "+t.id+"."):Object(o.cc)().ULS.traceTag(595734745,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.onCopy: no copy context."),e&&e.reason){var r=e.reason;if(r===o.n.SuccessiveCutCopyOverridingPendingCutCopy||r===o.n.BlockedSynchronousCutCopy||r===o.n.CopyOperationCancelled)return Object(o.cc)().ULS.traceTag(595734746,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Rejecting the promise: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),Promise.reject(e)}return Object(o.cc)().ULS.traceTag(596456159,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),n.metadataManager.updateMetadata({lastCopy:t}),Promise.resolve()}),this.rejectIfCopyCancelled(t).then(function(){return n.setClipboardAsync(r.asynchronousResult,e,t)})]).then(function(){return n.rejectIfCopyCancelled(t)}).then(function(){return n.copyCompleteCleanup(t,e),t},function(r){Object(o.cc)().ULS.traceTag(595734747,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: got error for copy id "+t.id+".");var i=r;return n.copyCompleteCleanup(t,e),i||(Object(o.cc)().ULS.shipAssertTag(595854806,a.LogCategory.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onCopy: promise rejected without error"),i=new o.m(o.n.UnknownCopyErrorType,"copyPasteFlowManager.onCopy failed without specified error")),i.copyContext=t,Promise.reject(i)})}catch(r){return this.copyCompleteCleanup(t,e),Object(o.cc)().ULS.traceTag(596456160,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. Exception: "+a.utils.getStringifiedError(r)+". Call stack: "+(r.stack?r.stack:"NA")),Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to store content in the clipboard (with an exception): "+r.message,r))}},e.prototype.onPaste=function(e){var t=this,r=new o.F;try{if(!e)return Promise.reject(new o.G(o.H.MissingArgumentError,"Missing commandParameters argument",new o.B(o.ib,"commandParameters")));e.isTimestampStoredInSystemClipboard=!0,r.id=Object(o.ab)(),r.sessionId=this.applicationHost.getSessionId(),r.commandParameters=e,r.clipboardItems=Object(o.rb)(),r.isClipboardInaccessible=!1;var n=this.metadataManager.getCachedMetadata();r.copyContextSnapshot=n.lastCopy,this.applicationHost.initializePasteContext(r),r.copyContextSnapshot?Object(o.cc)().ULS.traceTag(595937154,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: paste started for copy id "+r.copyContextSnapshot.id):Object(o.cc)().ULS.traceTag(595730637,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: paste started and copy context is null");return(e.skipClipboardAccess?Promise.resolve():this.readFromClipboard(r,e).then(function(e){r.clipboardItems=e},function(e){return e&&e.reason&&e.reason===o.H.ClipboardIsInaccessible?(r.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e)})).then(function(){return t.readClipboardItemsAgainIfMetadataNotSync(r,e)}).then(function(){return t.getPasteFlowHandler(r)}).then(function(n){if(r.copyContextSnapshot&&r.copyContextSnapshot.copyStatus!==o.o.Completed&&n.shouldWaitForCopyToComplete(r)){Object(o.cc)().ULS.traceTag(595937155,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: pasteFlowHandler ask to waiting for copy ("+r.copyContextSnapshot.id+") to complete. current status "+r.copyContextSnapshot.copyStatus+". copy session id is "+r.copyContextSnapshot.sessionId),n.onDeferredPasteStarted(r);var i=t.continueWhenCopyComplete(e,r).then(function(e){return n.onDeferredPasteCompleted(r),r.copyContextSnapshot=t.metadataManager.getCachedMetadata().lastCopy,r.clipboardItems=e,n},function(e){return n.onDeferredPasteCompleted(r),Object(o.cc)().ULS.traceTag(595882504,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"CopyPasteFlowManager.onPaste: got error while wait for deferred paste to complete. error: ["+e+"]"),Promise.reject(e)});return t.testHook("continueWhenCopyComplete"),i}return Object(o.cc)().ULS.traceTag(595940941,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: not wait for copy("+(r.copyContextSnapshot&&r.copyContextSnapshot.id)+") to complete. is copyContextSnapshot defined: "+(void 0!==r.copyContextSnapshot)+". copyStatus: "+(r.copyContextSnapshot&&r.copyContextSnapshot.copyStatus)),n}).then(function(e){return t.deserialize(e,r)}).then(function(){Object(a.ewaUtils)().isChangeGateEnabled("OfficeVSO:3191744_CCP_ClearCopyOnExternalSystemClipboardChange")&&(r.clipboardItems&&r.clipboardItems.getItem(o.Pb)===o.Rb&&t.onSystemClipboardChangedExternally())}).then(function(){return r}).catch(function(e){var t=e;return t||(Object(o.cc)().ULS.shipAssertTag(595858762,a.LogCategory.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onPaste: promise rejected without error"),t=new o.G(o.H.UnknownPasteError,"copyPasteFlowManager.onPaste failed without specified error")),t.pasteContext=r,Promise.reject(t)})}catch(e){return Object(o.cc)().ULS.shipAssertTag(596456161,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Exception: "+a.utils.getStringifiedError(e)),Promise.reject(new o.G(o.H.FailedToReadFromClipboard,"Failed to read data from the clipboard (with an exception): "+e.message,e,r))}},e.prototype.onCancelCopy=function(e){try{if(this.inProgressCopyContext?(this.inProgressCopyContext.markForCancellation=!0,Object(o.cc)().ULS.traceTag(595734748,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCancelCopy: canceling copy for copy id "+this.inProgressCopyContext.id+".")):Object(o.cc)().ULS.traceTag(595734749,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCancelCopy: no inProgressCopyContext."),!e)return Promise.resolve();this.metadataManager.clear();var t=Object(o.rb)(),r={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:o.r.Copy};return this.clipboardStrategy.set(t,r).catch(function(e){return Object(o.cc)().ULS.traceTag(596456162,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),Promise.reject(new o.c(o.d.FailedToClearClipboard,"Failed to clear the clipboard: "+e.message,e))})}catch(e){return Object(o.cc)().ULS.traceTag(596456163,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard. Exception: "+a.utils.getStringifiedError(e)),Promise.reject(new o.c(o.d.FailedToClearClipboard,"Failed to clear the clipboard (with an exception): "+e.message,e))}},e.prototype.onSystemClipboardChangedExternally=function(){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return this.onCancelCopy(!1),this.metadataManager.updateMetadata({lastCopy:void 0}),e={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:o.r.Copy},[4,this.clipboardStrategy.onSystemClipboardChangedExternally(e)];case 1:return t.sent(),[2]}})})},e.prototype.readClipboardItemsAgainIfMetadataNotSync=function(e,t){var r=this,n=!1;return this.metadataManager.getMetadataSyncPromise().then(function(t){t&&t.lastCopy?(e.copyContextSnapshot&&(n=t.lastCopy.id!==e.copyContextSnapshot.id||t.lastCopy.copyStatus!==e.copyContextSnapshot.copyStatus),e.copyContextSnapshot=t.lastCopy,Object(o.cc)().ULS.traceTag(595937158,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata is sync. copy id = "+e.copyContextSnapshot.id+". copy status = "+e.copyContextSnapshot.copyStatus+". isMetadataChanged = "+n)):Object(o.cc)().ULS.traceTag(595937025,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata or metadata.lastCopy are not defined. This should be possible only when the last copy was external (i.e. there is no previous copy operation in xlo). do nothing")}).then(function(){return n?r.readRichClipboardOnly(e,t,e.clipboardItems):Promise.resolve(e.clipboardItems)}).then(function(t){return e.clipboardItems=t,e})},e.prototype.getCopyFlowHandler=function(e){var t;try{t=this.applicationHost.getCopyFlowHandler(e)}catch(e){throw Object(o.cc)().ULS.shipAssertTag(596456192,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler failed with an exception: "+a.utils.getStringifiedError(e)),new o.m(o.n.FetchCopyFlowHandlerFailed,"applicationHost.getCopyFlowHandler failed with an exception: "+e.message,e)}if(!t){var r="CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw Object(o.cc)().ULS.shipAssertTag(596456193,a.LogCategory.msoulscat_ES_EWAJS,!1,r),new o.m(o.n.CopyFlowHandlerNotFound,r)}return t},e.prototype.getSourceItem=function(e,t){try{return e.getSourceItem(t)}catch(e){throw Object(o.cc)().ULS.shipAssertTag(596456194,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.getSourceItem failed with an exception: "+a.utils.getStringifiedError(e)),new o.m(o.n.FetchSourceItemFailed,"applicationHost.getSourceItem failed with an exception: "+e.message,e)}},e.prototype.serialize=function(e,t){try{e.beforeSerialize(t)}catch(e){throw Object(o.cc)().ULS.shipAssertTag(596456195,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception: "+a.utils.getStringifiedError(e)),new o.m(o.n.BeforeSerializeFailed,"copyFlowHandler.beforeSerialize failed with an exception: "+e.message,e)}var r;try{r=e.serialize(t)}catch(e){throw Object(o.cc)().ULS.shipAssertTag(596456196,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize failed with an exception: "+a.utils.getStringifiedError(e)),new o.m(o.n.SerializeFailed,"copyFlowHandler.serialize failed with an exception: "+e.message,e)}if(!r)throw Object(o.cc)().ULS.shipAssertTag(596456197,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize should return a non null result"),new o.m(o.n.SerializeResultNotValid,"copyFlowHandler.serialize should return a non null result");return r},e.prototype.setClipboardSync=function(e,t,r){try{r?Object(o.cc)().ULS.traceTag(595734750,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.setClipboardSync: start setClipboardSync for copy id "+r.id+"."):Object(o.cc)().ULS.traceTag(595734751,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.setClipboardSync: no copy context.");var n=e;return n||(n=Object(o.rb)()),this.clipboardStrategy.set(n,t).catch(function(e){if(Object(o.cc)().ULS.traceTag(596456198,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. isKeyboardEvent: "+t.isKeyboardEvent+", Error: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),e&&void 0!==e.reason){var r=e;if(r.reason===o.f.ClipboardIsInaccessible)return Promise.reject(new o.m(o.n.ClipboardIsInaccessible,r.message,r));if(r.reason===o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation)return Promise.reject(new o.m(o.n.SuccessiveCutCopyOverridingPendingCutCopy,"A successive Cut/Copy user event occurred before the last Cut/Copy browser event fired: "+r.message,r));if(r.reason===o.f.RejectingBlockedSyncCutCopyPromise)return Promise.reject(new o.m(o.n.BlockedSynchronousCutCopy,"In the user Cut/Copy operation, the async part occurred before its predecessor sync Cut/Copy browser event fired: "+r.message,r))}return Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to synchronously store content in the clipboard: "+e.message,e))}).then(function(){r.succeededPopulatingSystemClipboardSync=t.isTimestampStoredInSystemClipboard})}catch(e){return Object(o.cc)().ULS.shipAssertTag(596456199,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. Exception: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to synchronously store content in the clipboard (with an exception): "+e.message,e))}},e.prototype.setClipboardAsync=function(e,t,r){var n=this;return Object(o.cc)().ULS.traceTag(595734752,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.setClipboardAsync: start setClipboardAsync for copy id "+r.id+"."),e?e.then(function(e){try{if(n.isEmptyClipboard(e))return Promise.resolve();var i=t.stopwatch;t.stopwatch=void 0;var s=JSON.parse(JSON.stringify(t));return s.isTimestampStoredInSystemClipboard=!1,t.stopwatch=i,t.isKeyboardEvent&&(s.isKeyboardEvent=!1,s.silentClipboardAccessFailures=!0),n.clipboardStrategy.set(e,s).catch(function(e){if((Object(o.cc)().ULS.traceTag(596456200,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),e&&void 0!==e.reason)&&e.reason===o.f.ClipboardIsInaccessible)return Promise.resolve();return Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to asynchronously store content in the clipboard: "+(e&&e.message),e))}).then(function(){r.succeededPopulatingSystemClipboardAsync=s.isTimestampStoredInSystemClipboard})}catch(e){return Object(o.cc)().ULS.shipAssertTag(596456201,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard. Exception: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to asynchronously store content in the clipboard (with an exception): "+e.message,e))}},function(e){return r.isAsyncSerializeFailed=!0,Object(o.cc)().ULS.traceTag(596456202,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. Error: "+a.utils.getStringifiedError(e)+". Call stack: "+(e&&e.stack?e.stack:"NA")),Promise.reject(new o.m(o.n.AsyncSerializeFailed,"Failed to asynchronously serialize the content. Error: "+(e?e.message:"..."),e))}):(Object(o.cc)().ULS.traceTag(595734753,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.setClipboardAsync: no clipboardItemsPromise. resolving promise for copy id "+r.id+"."),Promise.resolve())},e.prototype.isEmptyClipboard=function(e){return e?0===Object(o.mb)(e)&&(Object(o.cc)().ULS.traceTag(596456204,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result does not contain items."),!0):(Object(o.cc)().ULS.traceTag(596456203,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result is undefined."),!0)},e.prototype.readFromClipboard=function(e,t){e.copyContextSnapshot&&(t.isTimestampStoredInSystemClipboard=e.copyContextSnapshot.isTimestampStoredInSystemClipboard);var r=this.clipboardStrategy.get(t);return r?r.then(function(e){return e?Promise.resolve(e):(Object(o.cc)().ULS.traceTag(596456206,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Intercepted a missing clipboard item collection"),Promise.reject(new o.G(o.H.FailedToReadFromClipboard,"Failed to read data from the clipboard. Intercepted a missing clipboard item collection",new o.G(o.H.ClipboardIsEmpty,o.ib))))},function(e){Object(o.cc)().ULS.traceTag(596456207,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA"));var t=e;return Object(o.Fb)(e,o.f.ClipboardIsInaccessible)?Promise.reject(new o.G(o.H.ClipboardIsInaccessible,t.message,t)):Object(o.Fb)(e,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(new o.G(o.H.SuccessivePasteOverridingPendingPaste,"A successive Paste user event occurred before the last Paste browser event fired: "+t.message,t)):Promise.reject(new o.G(o.H.FailedToReadFromClipboard,"Failed to read data from the clipboard: "+e.message,e))}):(Object(o.cc)().ULS.shipAssertTag(596456205,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. clipboardStrategy.get() did not return an object"),Promise.reject(new o.G(o.H.FailedToReadFromClipboard,"Failed to read data from the clipboard. clipboardStrategy.get() did not return an object",new o.G(o.H.ReadFromClipboardReturnNullOrUndefined,o.ib))))},e.prototype.getPasteFlowHandler=function(e){var t;try{t=this.applicationHost.getPasteFlowHandler(e)}catch(e){throw Object(o.cc)().ULS.shipAssertTag(596456208,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler failed. Exception: "+a.utils.getStringifiedError(e)),new o.G(o.H.FetchPasteFlowHandlerFailed,"applicationHost.getPasteFlowHandler failed with an exception: "+e.message,e)}if(!t){var r="CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw Object(o.cc)().ULS.shipAssertTag(596456209,a.LogCategory.msoulscat_ES_EWAJS,!1,r),new o.G(o.H.PasteFlowHandlerNotFound,r)}return t},e.prototype.deserialize=function(e,t){return e.deserialize(t).catch(function(e){var t=a.utils.getStringifiedError(e);return Object(o.cc)().ULS.traceTag(596456210,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onPaste: Deserialization failed: "+t+"."),Promise.reject(new o.G(o.H.DeserializeOperationFailed,"Deserialization failed: "+t,e))})},e.prototype.copyCompleteCleanup=function(e,t){e?(Object(o.cc)().ULS.traceTag(595734754,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.copyCompleteCleanup: start copy complete for copy id "+e.id+"."),t&&(e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard),e&&this.inProgressCopyContext&&e.id===this.inProgressCopyContext.id?(this.inProgressCopyContext=void 0,e.copyStatus=o.o.Completed,Object(o.cc)().ULS.traceTag(595937159,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.copyCompleteCleanup: updating metadata for copy id "+e.id+" after copy completed."),this.metadataManager.updateMetadata({lastCopy:e})):Object(o.cc)().ULS.traceTag(595734755,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.copyCompleteCleanup: not setting copy status to complete state for copy id "+e.id+".")):Object(o.cc)().ULS.traceTag(595734784,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.copyCompleteCleanup: no copy context.")},e.prototype.readRichClipboardOnly=function(e,t,r){return t.skipSystemClipboardAccess=!0,this.readFromClipboard(e,t).then(function(e){return Object(o.cc)().ULS.traceTag(595937160,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.readRichClipboardOnly: get clipboard items."),e},function(e){return Object(o.cc)().ULS.traceTag(595940942,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.readRichClipboardOnly: reading form rich clipboard failed with error: "+a.utils.getStringifiedError(e)+". use clipboard items from the first read as fallback."),Promise.resolve(r)})},e.prototype.continueWhenCopyComplete=function(e,t){var r=this;if(!t||!t.copyContextSnapshot)return Promise.resolve();if(t.copyContextSnapshot.copyStatus===o.o.Completed)return Promise.resolve();if(this.deferredPasteData&&this.deferredPasteData.copyContextId!==t.copyContextSnapshot.id&&(Object(o.cc)().ULS.shipAssertTag(595937161,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteFlowManager.continueWhenCopyComplete: deferred paste for another copy("+this.deferredPasteData.copyContextId+" !== "+t.copyContextSnapshot.id+") exist, this is not expected as we should clean deferred paste data when new copy started(both same and cross session)"),this.rejectDeferredPasteData(o.H.DeferredPasteRejectedBecauseOtherCopyCompleted)),!this.deferredPasteData){var n=this.metadataManager.getCachedMetadata();if(n&&n.lastCopy&&n.lastCopy.copyStatus===o.o.Completed&&n.lastCopy.id===t.copyContextSnapshot.id)return Object(o.cc)().ULS.traceTag(595937162,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.continueWhenCopyComplete: copy "+n.lastCopy.id+" already completed, not need for waiting any longer, reading the rich clipboard items"),this.readRichClipboardOnly(t,e,t.clipboardItems);var i=Object(o.U)(),s=i.promise.then(function(){return r.readRichClipboardOnly(t,e,t.clipboardItems)});this.deferredPasteData={copyContextId:t.copyContextSnapshot.id,copyCompleteDeferredPromise:i,readClipboardPromise:s,numberOfDeferredPaste:0,createdDate:new Date}}return this.deferredPasteData.numberOfDeferredPaste+=1,Object(o.cc)().ULS.traceTag(595937163,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.continueWhenCopyComplete: new deferred paste created for copy id: "+this.deferredPasteData.copyContextId+". number of deferred paste for this copy is: "+this.deferredPasteData.numberOfDeferredPaste+". first deferred paste created time: "+this.deferredPasteData.createdDate.toUTCString()),this.deferredPasteData.readClipboardPromise},e.prototype.rejectDeferredPasteData=function(e){if(this.deferredPasteData){Object(o.cc)().ULS.traceTag(595937164,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred pastes for copy id: "+this.deferredPasteData.copyContextId+". number of deferred paste for this copy is: "+this.deferredPasteData.numberOfDeferredPaste+". first deferred paste created time: "+this.deferredPasteData.createdDate.toUTCString()+". totalTime = "+((new Date).getTime()-this.deferredPasteData.createdDate.getTime())+"ms");var t=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,t.reject(new o.G(e,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred paste"))}},e.prototype.resolveDeferredPasteData=function(){if(this.deferredPasteData){Object(o.cc)().ULS.traceTag(595937165,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.resolveDeferredPasteData: resolve deferred pastes for copy id: "+this.deferredPasteData.copyContextId+". number of deferred paste for this copy is: "+this.deferredPasteData.numberOfDeferredPaste+". first deferred paste created time: "+this.deferredPasteData.createdDate.toUTCString()+". totalTime = "+((new Date).getTime()-this.deferredPasteData.createdDate.getTime())+"ms");var e=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,e.resolve()}},e.prototype.rejectIfCopyCancelled=function(e){return e?Object(o.cc)().ULS.traceTag(595734785,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.rejectIfCopyCancelled: start rejectIfCopyCancelled for copy id "+e.id+"."):Object(o.cc)().ULS.traceTag(595734786,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.rejectIfCopyCancelled: no copy context."),e&&e.markForCancellation?(Object(o.cc)().ULS.traceTag(595734787,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.rejectIfCopyCancelled: reject for copy id "+e.id+"."),Promise.reject(new o.m(o.n.CopyOperationCancelled,"CopyPasteFlowManager.rejectIfCopyCancelled: Rejecting since copyContext with id "+e.id+" is marked for cancellation"))):(e&&Object(o.cc)().ULS.traceTag(595734788,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.rejectIfCopyCancelled: resolve for copy id "+e.id+"."),Promise.resolve())},e.prototype.clearInProgressCopyIfNeeded=function(e){e&&e.markForCancellation||!this.inProgressCopyContext||e&&this.inProgressCopyContext.id===e.id||(Object(o.cc)().ULS.traceTag(595937166,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.clearInProgressCopyIfNeeded: cancel previous in-progress copy (id = "+this.inProgressCopyContext.id+") as new copy started ("+e.id+")"),this.inProgressCopyContext.markForCancellation=!0,this.inProgressCopyContext=void 0)},e.prototype.onMetadataChanged=function(e){e&&e.lastCopy?(Object(o.cc)().ULS.traceTag(595937167,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onMetadataChanged: the status of copy id "+e.lastCopy.id+" from session "+e.lastCopy.sessionId+" changed to "+e.lastCopy.copyStatus),this.clearInProgressCopyIfNeeded(e.lastCopy),this.deferredPasteData&&e.lastCopy.id!==this.deferredPasteData.copyContextId&&(Object(o.cc)().ULS.traceTag(595734789,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because copy id "+e.lastCopy.id+" is not equal to "+this.deferredPasteData.copyContextId),this.rejectDeferredPasteData(o.H.DeferredPasteRejectedBecauseOtherCopyStarted)),e.lastCopy.copyStatus===o.o.Completed&&this.onCopyCompletedSuccessfully(e.lastCopy)):(Object(o.cc)().ULS.traceTag(595734790,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.onMetadataChanged: no metadata or no metadata.lastCopy"),this.deferredPasteData&&(Object(o.cc)().ULS.traceTag(595724049,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because metadata update without copy context"),Object(a.ewaUtils)().isChangeGateEnabled("OfficeVSO:3364513_FixRejectDeferredPasteCrossSession")&&this.rejectDeferredPasteData(o.H.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext)))},e.prototype.onCopyCompletedSuccessfully=function(e){e?Object(o.cc)().ULS.traceTag(595734791,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopyCompletedSuccessfully: start onCopyCompletedSuccessfully for copy id "+e.id+"."):Object(o.cc)().ULS.traceTag(595734792,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.onCopyCompletedSuccessfully: no copy context."),this.deferredPasteData&&e&&e.copyStatus===o.o.Completed&&e.id===this.deferredPasteData.copyContextId&&this.resolveDeferredPasteData()},e.prototype.testHook=function(e){},e}(),l=r(21);r.d(t,"createCopyPasteInfra",function(){return i}),r.d(t,"getStringifiedError",function(){return l.getStringifiedError}),r.d(t,"queryStringSessionIdParameter",function(){return o.Wb}),r.d(t,"queryStringWacClusterParameter",function(){return o.Xb}),r.d(t,"htmlClipboardItem",function(){return o.Ab}),r.d(t,"sharedClipboardSettings",function(){return o.Zb}),r.d(t,"ulsLogger",function(){return o.cc}),r.d(t,"initLogger",function(){return o.Db}),r.d(t,"isClipboardPlatformErrorType",function(){return o.Fb}),r.d(t,"isClipboardPlatformErrorTypes",function(){return o.Gb}),r.d(t,"BaseError",function(){return o.a}),r.d(t,"MissingArgumentError",function(){return o.B}),r.d(t,"InvalidArgumentError",function(){return o.t}),r.d(t,"InvalidOperationError",function(){return o.u}),r.d(t,"UnsupportedError",function(){return o.L}),r.d(t,"MismatchVersionError",function(){return o.A}),r.d(t,"TTLClipboardDataError",function(){return o.J}),r.d(t,"UserHashMismatchError",function(){return o.M}),r.d(t,"UnexpectedError",function(){return o.K}),r.d(t,"CCPError",function(){return o.b}),r.d(t,"CopyError",function(){return o.m}),r.d(t,"PasteError",function(){return o.G}),r.d(t,"CancelError",function(){return o.c}),r.d(t,"ClipboardPlatformError",function(){return o.e}),r.d(t,"SharedClipboardError",function(){return o.I}),r.d(t,"rethrowAfterAllActions",function(){return o.Yb}),r.d(t,"init",function(){return o.Cb}),r.d(t,"isIE",function(){return o.Kb}),r.d(t,"isEdge",function(){return o.Hb}),r.d(t,"isEdgeWithTextHtmlClipboardSupport",function(){return o.Jb}),r.d(t,"isEdgeVersionWithTextHtmlWrapperSupport",function(){return o.Ib}),r.d(t,"getWindowMessaging",function(){return o.zb}),r.d(t,"emptyString",function(){return o.ib}),r.d(t,"oneSpace",function(){return o.Ub}),r.d(t,"oneDot",function(){return o.Tb}),r.d(t,"metadataLastCopyWasExternal",function(){return o.Rb}),r.d(t,"metadataLastCopyWasExternalXLOSource",function(){return o.Sb}),r.d(t,"ClipboardStrategyType",function(){return o.i}),r.d(t,"CopyClipboardCommand",function(){return o.j}),r.d(t,"CutClipboardCommand",function(){return o.p}),r.d(t,"PasteClipboardCommand",function(){return o.D}),r.d(t,"CopyClipboardEvent",function(){return o.k}),r.d(t,"CutClipboardEvent",function(){return o.q}),r.d(t,"PasteClipboardEvent",function(){return o.E}),r.d(t,"addEventListener",function(){return o.O}),r.d(t,"defaultClipboardDataFormat",function(){return o.gb}),r.d(t,"defaultIEClipboardDataFormat",function(){return o.hb}),r.d(t,"textHtmlClipboardDataFormat",function(){return o.bc}),r.d(t,"imageClipboardDataFormat",function(){return o.Bb}),r.d(t,"metadataIsLastCopyWasExternal",function(){return o.Pb}),r.d(t,"metadataIsLastCopyWasExternalXLOSource",function(){return o.Qb}),r.d(t,"metadataInfraVersionFormat",function(){return o.Ob}),r.d(t,"metadataCopyId",function(){return o.Nb}),r.d(t,"getEmptyClipboardItemsData",function(){return o.pb}),r.d(t,"getImmutableEmptyClipboardItems",function(){return o.rb}),r.d(t,"getClipboardItemsDataCount",function(){return o.nb}),r.d(t,"getClipboardItemsCount",function(){return o.mb}),r.d(t,"createClipboardItems",function(){return o.Q}),r.d(t,"getClipboardItemContent",function(){return o.lb}),r.d(t,"getClipboardItem",function(){return o.kb}),r.d(t,"getDefaultClipboardData",function(){return o.ob}),r.d(t,"getItemsFromClipboardItems",function(){return o.sb}),r.d(t,"ClipboardStorageType",function(){return o.g}),r.d(t,"CutCopyPasteFlags",function(){return o.r}),r.d(t,"ClipboardPlatformErrorTypes",function(){return o.f}),r.d(t,"CopyErrorTypes",function(){return o.n}),r.d(t,"PasteErrorTypes",function(){return o.H}),r.d(t,"CancelErrorTypes",function(){return o.d}),r.d(t,"InfraInitializationErrorTypes",function(){return o.s}),r.d(t,"getSharedClipboardValidatedOrigin",function(){return o.wb}),r.d(t,"validateRemoteWindowOrigin",function(){return o.gc}),r.d(t,"NoUserHash",function(){return o.C}),r.d(t,"validateUserHash",function(){return o.hc}),r.d(t,"shouldClearClipboard",function(){return o.ac}),r.d(t,"createMessageId",function(){return o.ab}),r.d(t,"createContextId",function(){return o.T}),r.d(t,"getCanonicalValidatedMessageId",function(){return o.jb}),r.d(t,"createClipboardOperationMessage",function(){return o.R}),r.d(t,"MessageDestinationConst",function(){return o.z}),r.d(t,"isValidClipboardOperationCode",function(){return o.Mb}),r.d(t,"validateClipboardOperationMessage",function(){return o.ec}),r.d(t,"createClipboardOperationResultMessage",function(){return o.S}),r.d(t,"validateClipboardOperationResultMessage",function(){return o.fc}),r.d(t,"ClipboardStrategyBase",function(){return o.h}),r.d(t,"createDeferredPromise",function(){return o.U}),r.d(t,"createDeferredPromiseCache",function(){return o.V}),r.d(t,"createDisposableImplementationExtension",function(){return o.W}),r.d(t,"createMessageDeserializer",function(){return o.Z}),r.d(t,"createMessageSerializer",function(){return o.bb}),r.d(t,"initMessageIdPrefix",function(){return o.Eb}),r.d(t,"unknownMessageId",function(){return o.dc}),r.d(t,"queryStringCreatorOriginParameter",function(){return o.Vb}),r.d(t,"getValidatedRemoteWindow",function(){return o.xb}),r.d(t,"WindowRPCBase",function(){return o.N}),r.d(t,"createWindowRPCServerReceiver",function(){return o.eb}),r.d(t,"createWindowRPCClientReceiver",function(){return o.cb}),r.d(t,"createWindowRPCServerSender",function(){return o.fb}),r.d(t,"createWindowRPCClientSender",function(){return o.db}),r.d(t,"LocalStorageChangedEventFlagPostfix",function(){return o.v}),r.d(t,"isLocalStorageSupported",function(){return o.Lb}),r.d(t,"getLocalStorageDataKey",function(){return o.tb}),r.d(t,"getLocalStorageMetadataKey",function(){return o.ub}),r.d(t,"getLocalStorageMetadataKeyToWatch",function(){return o.vb}),r.d(t,"CopyContext",function(){return o.l}),r.d(t,"PasteContext",function(){return o.F}),r.d(t,"CopyStatus",function(){return o.o}),r.d(t,"getEmptyMetadata",function(){return o.qb}),r.d(t,"cloneMetadata",function(){return o.P}),r.d(t,"getWindowLocation",function(){return o.yb}),r.d(t,"createLocalStorageClipboardStrategy",function(){return o.Y}),r.d(t,"LocalStorageClipboardStrategy",function(){return o.x}),r.d(t,"createLocalStorageClipboardStorage",function(){return o.X}),r.d(t,"LocalStorageClipboardStorage",function(){return o.w}),r.d(t,"LocalStorageKeyChangeTracker",function(){return o.y})}});
//# sourceMappingURL=copyPasteInfra.min.js.map
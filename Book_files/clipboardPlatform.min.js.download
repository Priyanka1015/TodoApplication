var clipboardPlatform=function(e){var t={};function r(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=851)}({0:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(21);t.utils=a;var o=r(56);t.idbPromised=o;var n=r(30);t.ULS=n.ULS,t.TraceLevel=n.TraceLevel,t.LogCategory=n.LogCategory,t.NulLogger=n.NulLogger,t.ConsoleLogger=n.ConsoleLogger;var i=r(40);t.browserSupport=i;var s=r(41);t.perfWatch=s;var c=r(57);t.initEwaUtils=c.initEwaUtils,t.ewaUtils=c.ewaUtils;var l=r(58);t.initStopwatchFactory=l.initStopwatchFactory;var d=r(59);t.getNewGuid=d.getNewGuid},1:function(e,t,r){"use strict";var a={};r.r(a),r.d(a,"sharedClipboardSettingsVariableName",function(){return pe}),r.d(a,"defaultPromiseTimeoutInMinutes",function(){return Se}),r.d(a,"getSharedClipboardSettings",function(){return Ce}),r.d(a,"initializeSharedClipboardSettingsFromWindow",function(){return ye}),r.d(a,"initializeSharedClipboardSettings",function(){return ve}),r.d(a,"createEmptySharedClipboardSettings",function(){return we});var o={};r.r(o),r.d(o,"divTagName",function(){return Zt}),r.d(o,"preTagName",function(){return $t}),r.d(o,"tableTagName",function(){return er}),r.d(o,"trTagName",function(){return tr}),r.d(o,"tdTagName",function(){return rr}),r.d(o,"ccpTimestampHtmlCustomAttributeName",function(){return ur}),r.d(o,"minCcpTimestampHtmlCustomAttributeValue",function(){return gr}),r.d(o,"ensureOneLFPerNewLine",function(){return pr}),r.d(o,"trimToLength",function(){return fr}),r.d(o,"createTextHtmlFromTextPlain",function(){return mr}),r.d(o,"createHtmlItemFromTextPlain",function(){return br}),r.d(o,"createPlainTextFromHtml",function(){return hr}),r.d(o,"isContainsTimestampWrapper",function(){return Cr}),r.d(o,"addClipboardWrapperForEdge",function(){return yr}),r.d(o,"getFragmentFromTextHtml",function(){return vr}),r.d(o,"getCcpTimestampHtmlCustomAttributeFromWrappingTag",function(){return Er}),r.d(o,"encodeAngleBrackets",function(){return wr}),r.d(o,"wrapContentWithTagAndAttributes",function(){return Lr});var n,i=r(0);function s(){return n}function c(e){if(!e)throw new Error("The 'logger' argument is missing");n=i.ULS.getFromExternalLogger(e)}var l,d,u,g,p,f=r(2),m="";function b(e,t){return h(e,[t])}function h(e,t){if(!function(e){if(!(e&&"object"==typeof e&&"reason"in e))return!1;if(!function(e){if(!e&&0!==e)return!1;var t=Number(e);if(isNaN(t)||t.toString()!==e.toString())return!1;return!0}(e.reason))return!1;return!0}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;var r=e.reason;return t.indexOf(r)>=0}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.SystemClipboardAndIndexedDB=1]="SystemClipboardAndIndexedDB",e[e.IndexedDB=2]="IndexedDB",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory"}(l||(l={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.IndexedDBSetClipboardItems=4]="IndexedDBSetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.IndexedDBGetClipboardItems=6]="IndexedDBGetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.SelectClipboardStrategy=14]="SelectClipboardStrategy",e[e.IndexedDBProviderNotSupported=15]="IndexedDBProviderNotSupported",e[e.IndexedDBCacheInitialization=16]="IndexedDBCacheInitialization",e[e.IndexedDBGetCache=17]="IndexedDBGetCache",e[e.IndexedDBDeleteDb=18]="IndexedDBDeleteDb",e[e.IndexedDBSetItem=19]="IndexedDBSetItem",e[e.IndexedDBGetItem=20]="IndexedDBGetItem",e[e.IndexedDBGetAllKeys=21]="IndexedDBGetAllKeys",e[e.IndexedDBGetAllItems=22]="IndexedDBGetAllItems",e[e.IndexedDBRemoveItem=23]="IndexedDBRemoveItem",e[e.IndexedDBRemoveAllItems=24]="IndexedDBRemoveAllItems",e[e.IndexedDBClearAll=25]="IndexedDBClearAll",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IndexedDBCacheInitializationTimeout=30]="IndexedDBCacheInitializationTimeout",e[e.IndexedDBSetTimeout=31]="IndexedDBSetTimeout",e[e.IndexedDBGetTimeout=32]="IndexedDBGetTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(g||(g={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(p||(p={}));var S=function(e){function t(r,a,o){var n=this,c=t.augmentParameterValue(r);if((n=e.call(this,c)||this).name=t.augmentParameterValue(a),n.errorName=n.name,n.name?s().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '"+n.name+"': "+c):s().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: "+c),o){n.innerError=o;var l=n.innerError.message;l||(l=n.innerError.name);var d=t.augmentParameterValue(l);d.length>0&&s().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: "+d)}return n.stack||(n.stack=(new Error).stack),n}return f.__extends(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():m},t}(Error),C=function(e){function t(r,a,o){var n=this,i=S.augmentParameterValue(a),s=t.getDefaultMessage(i),c=S.augmentParameterValue(r);return 0===c.length&&(c=s),(n=e.call(this,c,"MissingArgumentError",o)||this).name=i,n}return f.__extends(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '"+e+"'"),t},t}(S),y=function(e){function t(r,a,o,n){var i=this,s=S.augmentParameterValue(a),c=o;c||(c=m);var l=t.getDefaultMessage(s,c),d=S.augmentParameterValue(r);return 0===r.length&&(d=l),(i=e.call(this,d,"InvalidArgumentError",n)||this).name=s,i.value=c,i}return f.__extends(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '"+e+"' argument: '"+t+"'":"Invalid argument"},t}(S),v=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return f.__extends(t,e),t}(S),E=function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}return f.__extends(t,e),t}(S),w=function(e){function t(t,r,a,o,n){return e.call(this,t+". Data version: "+r+", Infra version: "+a+", blockMismatchDataVersion: "+o,"MismatchVersionError",n)||this}return f.__extends(t,e),t}(S),L=function(e){function t(t,r,a,o){return e.call(this,t+". Duration in clipboard (ms) : "+r+", TTL (ms): "+a,"TTLClipboardDataError",o)||this}return f.__extends(t,e),t}(S),T=function(e){function t(t,r,a,o){return e.call(this,t+". Data User Hash : "+r+", infra User Hash: "+a,"UserHashMismatchError",o)||this}return f.__extends(t,e),t}(S),_=function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}return f.__extends(t,e),t}(S);function I(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:m}var P=function(e){function t(t,r,a,o,n){var i=e.call(this,r||"reason="+t,a,o)||this;return i.reason=t,n&&(i.errorName=n),i}return f.__extends(t,e),t}(S),O=function(e){function t(t,r,a){return e.call(this,t,r,"CopyError",a,I(t,u))||this}return f.__extends(t,e),t}(P),A=function(e){function t(t,r,a){return e.call(this,t,r,"PasteError",a,I(t,g))||this}return f.__extends(t,e),t}(P),x=function(e){function t(t,r,a){return e.call(this,t,r,"CancelError",a,I(t,p))||this}return f.__extends(t,e),t}(P),j=function(e){function t(t,r,a){return e.call(this,t,r,"ClipboardPlatformError",a,I(t,d))||this}return f.__extends(t,e),t}(P),D=function(e){function t(t,r,a){return e.call(this,t,r,"SharedClipboardError",a,I(t,d))||this}return f.__extends(t,e),t}(P);function M(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach(function(e){if(t+=1,e)try{e()}catch(e){s().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" threw an exception: "+e.message),r||(r=new v(e.message,e))}else s().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" is empty")}),r)throw r}else s().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}function W(){return U}var U={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:m},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:m}},R={};function J(){R={}}var F=new RegExp("(\\bTrident/| MSIE )"),N=16.16299,z=17.17123,k=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function H(){if(void 0===R.isIEProperty){R.isIEProperty=!1;var e=W();if(e&&e.userAgent&&"function"==typeof e.userAgent){var t=e.userAgent();if(t){var r=t.match(F);r&&2===r.length&&(R.isIEProperty=!0)}}}return R.isIEProperty}function V(){if(void 0===R.isEdgeProperty){R.isEdgeProperty=!1,R.isEdgeWithTextHtmlClipboardSupportProperty=!1,R.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=W();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(k);if(r&&2===r.length){R.isEdgeProperty=!0;var a=Number(r[1]);isNaN(a)||(a>=N&&(R.isEdgeWithTextHtmlClipboardSupportProperty=!0),a>=z&&(R.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return R.isEdgeProperty}function B(){return V()&&R.isEdgeWithTextHtmlClipboardSupportProperty}function K(){return V()&&R.isEdgeVersionWithTextHtmlWrapperSupportProperty}function G(){return Q}var Q={postMessage:function(e,t,r,a){e.postMessage(t,r,a)}},q=function(e,t,r,a){return void 0===a&&(a=!1),e.addEventListener(t,r,a),function(){e.removeEventListener(t,r,a)}},X="text/plain";function Y(){return{items:{}}}var Z,$,ee,te,re=(Z={items:{}},{getData:function(){return Z},getItem:function(e){},setItem:function(e,t){throw new v("Cannot set an item with clipboard data format '"+e+"' in an immutable empty clipboard (content is "+(t&&t.length>0?"not ":m)+"empty)")},get:function(){return ue(void 0)}});function ae(){return re}function oe(e){return e&&e.items?Object.keys(e.items).length:0}function ne(e){return oe(e&&e.getData())}function ie(e){void 0===e&&(e=void 0);var t=e;return t||(t={items:{}}),{getItem:function(e){return se(t,e)},setItem:function(e,r){!function(e,t,r){if(!e)throw new C(m,"clipboardItemsData");if(!e.items)throw new y(m,"clipboardItemsData.items");e.items[t]=r}(t,e,r)},getData:function(){return t},get:function(){return ue(t)}}}function se(e,t){if(!e)throw new C(m,"clipboardItemsData");if(!e.items)throw new y(m,"clipboardItemsData.items");return e.items[t]}function ce(e,t){if(!e||0===e.length||!t||!t.trim())return m;var r=void 0;return e.forEach(function(e){e.clipboardDataFormat===t&&(r=e.data)}),r||m}function le(e){return ce(e,X)}function de(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:X,data:m}),t}function ue(e){var t=[];if(0===oe(e))return t;for(var r in e.items){var a=se(e,r);a||(a=m);var o={clipboardDataFormat:r,data:a};t.push(o)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.IndexedDB=1]="IndexedDB",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage"}($||($={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose"}(ee||(ee={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(te||(te={}));var ge="-",pe="sharedClipboardSettings",fe=we(),me=!1,be=1,he=3600,Se=2;function Ce(){if(!me)throw new v("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return fe}function ye(){me=!1,function(){if(!(window&&pe in window))return fe=we(),void(me=!0);var e=window[pe];if(!e||"object"!=typeof e)return fe=we(),void(me=!0);Ee(e)}()}function ve(e){me=!1,Ee(e)}function Ee(e){if(!e)throw new C(m,"sharedClipboardSettingsCandidate");var t=we();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return fe=t,void(me=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return s().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),fe=t,void(me=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,a=r.indexOf(ge);a>=0&&(r=r.substr(a+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(e){}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some(function(e){return!e||!e.trim()}))return s().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],fe=t,void(me=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(e){}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some(function(e){return!e||!e.trim()}))return s().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],fe=t,void(me=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return s().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],fe=t,void(me=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return s().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' or '"+r+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],fe=t,void(me=!0)}t.whitelistOriginComponents=!0,fe=t,me=!0}function we(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:m,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:be,sharedClipboardExpirationInMinutes:he,clipboardPromiseTimeoutInMinutes:Se,remoteLoggerPath:m}}function Le(){var e=m;return window&&window.location&&window.location.origin?(e=window.location.origin)||(e=m):(s().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: "+!!window+". is window.location exist: "+(window&&!!window.location)+". is window.location.origin exist "+(window&&window.location&&!!window.location.origin)+". is window.location.protocol exist "+(window&&window.location&&!!window.location.protocol)+". is window.location.hostname exist "+(window&&window.location&&!!window.location.hostname)+". is window.location.port exist "+(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}var Te,_e,Ie="://",Pe="http",Oe="https",Ae=".",xe="/",je=":",De=new RegExp("^\\d+$"),Me=!1;function We(e){if(!e)throw new C(m,"origin");var t=e.trim().toLowerCase(),r=m,a=t.split(Ie,3);if(!a||0===a.length||!a[0]||a[0]!==Pe&&a[0]!==Oe)throw new y("Missing protocol","origin",e);if(1===a.length)throw new y("Missing domain","origin",e);if(a.length>2)throw new y("'"+Ie+"' should appear once","origin",e);var o=a[1];if(!o)throw new y("Missing domain","origin",e);if(r=a[0]+Ie,!(a=(o=o.trim()).trim().split(xe,3))||0===a.length||!a[0]||!a[0].trim())throw new y("Missing domain","origin",e);if(a.length>2)throw new y("The last part of the origin should be the domain","origin",e);if(2===a.length&&a[1])throw new y("The last part of the origin should be the domain","origin",e);if(!(a=o.split(je,3))||0===a.length||!a[0]||!a[0].trim())throw new y("Missing domain","origin",e);if(a.length>2||2===a.length&&(!a[1]||!a[1].trim()))throw new y("The last part of the origin should be the domain and an optional port number","origin",e);if(r+=o=a[0].trim(),2===a.length){var n=a[1].trim(),c=De.exec(n);if(!c||1!==c.length)throw new y("Invalid port number","origin",e);var l=Number(n);if(isNaN(l))throw new y("Invalid port number","origin",e);r+=je+n}return s().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getValidatedOrigin: origin = '"+e+"'; validated origin = '"+r+"'"),r}function Ue(e){ze();var t=We(e),r=t.split(Ie);if(!r||2!==r.length||!r[0]||!r[1])throw new y("Invalid origin","parentOrigin",e);var a=Ce(),o=m;if(a.whitelistOriginComponents){var n=r[0]+Ie;if(!(r=r[1].split(Ae))||r.length<2||!r[0])throw new y("Invalid origin","parentOrigin",e);r.splice(0,1,a.sharedClipboardHostingApp),o=n+r.join(Ae)}else o=t;return s().ULS.traceTag(596452424,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getSharedClipboardValidatedOrigin: app's origin = '"+e+"'; Shared Clipboard iframe origin = '"+o+"' components="+JSON.stringify(r)),o}function Re(e){ze();var t=We(e),r=We(Le().origin);if(t===r)return t;if(!Ce().whitelistOriginComponents)throw new v("validateOriginForReceivedMessage: Caller origin '"+e+"' doesn't match the current window's origin '"+r+"'");var a=Je(t),o=Je(r);if(a.protocol!==o.protocol)throw new v("validateRemoteWindowOrigin: Caller origin's protocol '"+a.protocol+"' doesn't match the current window origin's protocol '"+o.protocol+"'");if(a.environment!==o.environment)throw new v("validateRemoteWindowOrigin: Caller origin's environment '"+a.environment+"' doesn't match the current window origin's environment '"+o.environment+"'");return t}function Je(e){ze();var t=e.split(Ie,2),r=t[0],a=Fe(t[1]),o={protocol:r};if(o.environment=Ne(e,a,_e),a.length<=o.environment.length+1)throw new y("Missing app component","origin",e);if(a.charAt(o.environment.length)!==Ae)throw new y("Missing a domain separator after the environment component","origin",e);var n=a.substr(o.environment.length+Ae.length);if(o.app=Ne(e,n,Te),o.app.length<n.length&&n.charAt(o.app.length)!==ge)throw new y("When the Office Online app name is not the domain prefix, '"+ge+"' should precede it","origin",e);return o}function Fe(e){if(!e)throw new C(m,"stringToReverse");for(var t=e.length,r=m,a=t-1;a>=0;a-=1)r+=e.charAt(a);return r}function Ne(e,t,r){if(!t)throw new C(m,"reversedValidatedHostname");if(!r)throw new C(m,"reversedStringsToLengthMap");var a=t.length,o=Object.keys(r).filter(function(e){var o=r[e];return o<=a&&t.substr(0,o)===e});if(o&&o.length>0)return Fe(o[0]);throw new y("Invalid origin","validatedOrigin",e)}function ze(){if(!Me){var e=Ce();e.whitelistOriginComponents&&(Te=ke(e.sharedClipboardHostingApps),_e=ke(e.sharedClipboardHostingEnvironments),Me=!0)}}function ke(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach(function(e){t[Fe(e)]=e.length}),t):t}var He=1;function Ve(e){null==e?s().ULS.traceTag(595973151,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"validateUserHash: userHash is undefined."):e===He&&s().ULS.traceTag(596451804,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"validateUserHash: userHash is set to the default non-user-hash value of "+He)}function Be(e,t){return Ve(t),null==e||e===He||null==t||e!==t}function Ke(){return qe()}function Ge(){return qe()}function Qe(e){if(!e)throw new C(m,"id");var t=e.trim().toLowerCase();if(0===t.length)throw new y(m,"id");return t}function qe(){return(Math.random()+1).toString(36).substring(7)}function Xe(e,t,r,a,o){var n={id:e,operationCode:t,destination:r,userHash:a,clipboardItemsData:o};return $e(n),n}var Ye=function(){function e(){}return e.localStorageData="localStorage/data",e.indexedDBData="indexedDB/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function Ze(e){return"get"===e||"set"===e||"init"===e}var $e=function(e){if(!e)throw new C(m,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new C(m,"id");if(!e.operationCode)throw new C(m,"operationCode");if(!e.destination)throw new C(m,"destination");if(!Ze(e.operationCode))throw new y(m,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new y("'"+e.operationCode+"' expects no clipboard items","clipboardItemsData")};function et(e,t,r,a,o){var n={id:e,operationCode:t,failed:r,error:a,clipboardItemsData:o};return tt(n),n}var tt=function(e){if(!e)throw new C(m,"clipboardOperationResultMessage");if(!e.id||0===e.id.trim().length)throw new C(m,"id");if(!e.operationCode)throw new C(m,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new y(m,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new y("A failed '"+e.operationCode+"' operation expects a non-empty error argument","error");if(e.clipboardItemsData)throw new y("A failed '"+e.operationCode+"' operation does not expect a clipboardItemsData argument","clipboardItemsData")}else{if(e.error)throw new y("'"+e.operationCode+"' expects an empty error argument","error");if("unknownresult"===e.operationCode)throw new y("'"+e.operationCode+"' can only be used with a failure message","operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new y("'"+e.operationCode+"' expects a clipboardItems argument","clipboardItemsData")}else if(e.clipboardItemsData)throw new y("'"+e.operationCode+"' expects no clipboardItemsData argument","clipboardItemsData")};function rt(e){if(!e||0===e.trim().length)throw new y(m,"className",e);return function(){var t=!1;function r(t){return e+":"+t+": already disposed"}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&s().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new v(r(e))}}}()}var at=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=rt(""+e)}return e.prototype.initialize=function(e){var t=this;return e.then(function(e){return t.clipboardStorage=e,s().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '"+t.clipboardStrategyType+"' was initialized."),Promise.resolve(t)},function(e){return s().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Failed to initialize clipboard strategy type '"+t.clipboardStrategyType+"'. Error: "+i.utils.getStringifiedError(e)),Promise.reject(e)})},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new j(d.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new j(d.SetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new j(d.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then(function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)})}catch(e){return Promise.reject(new j(d.GetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(ae(),e):(s().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new j(d.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new j(d.ClearClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").onSystemClipboardChangedExternally",e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),ot=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function nt(e){var t=e;return t&&0!==t.trim().length||(t=Ke()),new lt(t)}function it(){return ot?window.performance.now():Date.now()}function st(e){return ot?new Date(e+window.performance.timing.navigationStart):new Date(e)}function ct(e,t,r){if(!r)throw new C(m,"creationTimestamp");return(e?"Fulfilled":"Still unfulfilled")+" after "+(e?t?t-r:"?":it()-r)+"ms"}var lt=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=Qe(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=it(),s().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #"+this.sequenceId+" with id '"+this.id+"' on "+st(this.creationTimestamp)),this.promise=new Promise(function(e,t){s().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #"+r.sequenceId+" with id '"+r.id+"' on "+st(it())),r.internalResolve=e,r.internalReject=t})}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):s().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):s().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=it(),s().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #"+this.sequenceId+" with id '"+this.id+"' as fulfilled ("+(this.rejected?"rejected":"resolved")+"). "+ct(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)))},e.prototype.fulfillmentCheck=function(e){return s().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"'"),this.isFulfilled&&s().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"' since it was "+(this.rejected?"rejected":"resolved")+" already on "+st(this.fulfillmentTimestamp)+". "+ct(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)),this.isFulfilled},e.sequenceId=0,e}();function dt(){return new ut}var ut=function(){function e(){this.deferredResultMessagePromiseCache={}}return e.prototype.getDeferredPromise=function(e){var t=Qe(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return s().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '"+e+"'."),t.promise;s().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '"+e+"'.")},e.prototype.addNewPromise=function(e){var t=nt(e);if(this.getDeferredPromise(t.id))throw new y("A deferred promise already exists in the cache for the specified id","id",t.id);var r=Qe(t.id);return this.deferredResultMessagePromiseCache[r]=t,s().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '"+t.id+"'."),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=Qe(e);delete this.deferredResultMessagePromiseCache[t],s().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '"+e+"'.")}else s().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '"+e+"' since this id is not associated with an existing deferred promise.")},e.prototype.clear=function(){if(s().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing "+this.getLength()+" items from the cache"),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){s().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '"+e+"' with this exception: "+t.message+". Ignoring.")}}this.deferredResultMessagePromiseCache={}},e}();function gt(e){if(!e)throw new C(m,"validator");return{deserialize:function(t){return function(e,t){if(!e)throw new C(m,"incomingMessage");if(!t)throw new C(m,"validator");if(0===e.length)throw new y("An empty message is invalid","incomingMessage");var r,a=e.trim();if(0===a.length)throw new y("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(a)}catch(t){throw new y("Deserialization failed","incomingMessage","Contains "+e.length.toString()+" characters",t)}if(!r)throw new y("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function pt(e){if(!e)throw new C(m,"validator");return{serialize:function(t){return function(e,t){if(!e)throw new C(m,"outgoingMessage");if(!t)throw new C(m,"validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new y("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return s().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}}function ft(e){if(!e)throw new C(m,"remoteWindow");if(!("window"in e&&e.window))throw new C(m,"remoteWindow.window");if(!("windowOrigin"in e&&e.windowOrigin))throw new C(m,"remoteWindow.windowOrigin");var t=Re(e.windowOrigin);return{window:e.window,windowOrigin:t}}var mt=function(){function e(e,t,r,a){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=rt(a)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(M([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new C(m,"outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw s().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new v(t)}this.sender.postMessage(e)},e}();function bt(){return ht}var ht={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};function St(e,t,r){return new vt(e,t,r)}function Ct(e,t,r){return new vt(e,t,r)}var yt="message",vt=function(){function e(e,t,r){var a=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return a.onMessageReceived(e)},!e)throw new C(m,"deserializer");if(!t)throw new C(m,"handler");if(!r)throw new C(m,"windowRPC");this.disposableImplementationExtension=rt("WindowRPCReceiverInternal"),this.remoteWindow=r.remoteWindow,bt().addEventListener(yt,this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(bt().removeEventListener(yt,this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return s().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return s().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return s().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return s().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){s().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to deserialize incoming message. "+i.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(i.utils.getStringifiedError(e))}catch(e){s().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+i.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch(function(e){s().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))})}catch(e){s().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}else s().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();function Et(e,t){return new Lt(e,t)}function wt(e,t){return new Lt(e,t)}var Lt=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new C(m,"serializer");if(!t)throw new C(m,"windowRPC");this.disposableImplementationExtension=rt("WindowRPCSenderInternal"),this.remoteWindow=t.remoteWindow}return e.prototype.postMessage=function(e){if(!e)throw new C(m,"outgoingMessage");if(!this.remoteWindow.window)throw new v("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new v("The remote window does not support postMessage");var t=this.serializer.serialize(e);G().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}(),Tt="OfficeOnlineCCP_Metadata_",_t="OfficeOnlineCCP_Data_",It="_LocalStorageChangedFlag";function Pt(){try{return localStorage.setItem("XLO_CCP","1"),"1"===localStorage.getItem("XLO_CCP")}catch(e){return!1}}function Ot(e){return _t+e}function At(e){return Tt+e}function xt(e){return At(e)+It}var jt,Dt=function(){this.copyStatus=jt.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0},Mt=function(){};function Wt(){return{}}function Ut(e){var t=void 0;return e&&e.lastCopy&&(t=f.__assign({},e.lastCopy)),{lastCopy:t}}function Rt(e){try{s().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '"+$.LocalStorage+"'");var t=new Jt(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(jt||(jt={}));var Jt=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new j(d.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: filed access to localStorage",e)}if(!e)throw new j(d.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=$.LocalStorage,this.disposableImplementationExtension=rt("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),s().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters='"+(e?JSON.stringify(e):m)+"'");var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(ae());try{var r=JSON.parse(t);if(!r||0===oe(r))return Promise.resolve(ae());var a=ie(r);return Promise.resolve(a)}catch(e){return Promise.resolve(ae())}},e.prototype.set=function(e,t){if(this.disposableImplementationExtension.throwIfDisposed("set"),s().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count="+ne(e)+"'; commandParameters='"+(t?JSON.stringify(t):m)+"'"),0===ne(e))localStorage.removeItem(this.localStorageKey);else{localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r=""+(this.localStorageKey+It),a=Ke();s().ULS.traceTag(595715530,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = "+r+". eventFlagValue = "+a),localStorage.setItem(r,a)}return Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[X,"text/html","data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Ft(e){return s().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '"+l.LocalStorage+"' with localStorageKey: '"+e+"'"),(new Nt).initialize(Rt(e))}var Nt=function(e){function t(t){return e.call(this,l.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return f.__extends(t,e),t}(at),zt=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this))}return e.prototype.onStorageChanged=function(e){var t=this;s().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),s().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = "+e.key+". localStorageKeyToWatch = "+this.localStorageKeyToWatch+". lastLocalStorageValue = "+this.lastLocalStorageValue),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),s().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then(function(){t.raiseMetadataChangedEvent()},function(){s().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")}))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return s().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = "+this.lastLocalStorageValue),this.clipboardStrategy.get({userHash:0}).then(function(t){e.listener(t),s().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = "+e.lastLocalStorageValue)},function(e){s().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")})},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return s().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = "+this.lastLocalStorageValue+". currentLocalStorageValue = "+e),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(s().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged())return s().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = "+this.lastLocalStorageValue),Promise.resolve();var r=nt(),a=new Date,o=setInterval(function(){var n=(new Date).getTime()-a.getTime();s().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = "+a+". elapseTime = "+n+". lastLocalStorageValue = "+t.lastLocalStorageValue),t.isLocalStorageValueChanged()?(clearInterval(o),s().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = "+a+". elapseTime = "+n+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.resolve()):n>e&&(clearInterval(o),s().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = "+a+". elapseTime = "+n+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.reject())},200);return r.promise},e}(),kt="\t",Ht="\n",Vt="\r",Bt=new RegExp("("+Ht+Vt+")|("+Vt+Ht+")|("+Vt+")","g"),Kt=new RegExp("("+kt+")","g"),Gt=10240,Qt=new RegExp("<","g"),qt="&lt;",Xt=new RegExp(">","g"),Yt="&gt;",Zt="div",$t="pre",er="table",tr="tr",rr="td",ar="\x3c!--StartFragment--\x3e",or="\x3c!--EndFragment--\x3e",nr=ar.length,ir=or.length,sr="Version:0.9"+Ht+"StartHTML:0000000100"+Ht+"EndHTML:{EndHTML0}"+Ht+"StartFragment:0000000134"+Ht+"EndFragment:{EndFragm}"+Ht+"<html>"+Ht+"<body>"+Ht+ar+Ht,cr=""+or+Ht+"</body>"+Ht+"</html>",lr="0000000000",dr="</html>".length,ur="data-ccp-timestamp",gr=0;function pr(e){return e?e.replace(Bt,Ht):e}function fr(e){return e?e.length<=Gt?e:e.substr(0,Gt):m}function mr(e){var t,r=wr(e),a=function(e){return e?e.replace(Bt,"</"+rr+"></"+tr+"><"+tr+"><"+rr+">"):e}((t=r)?t.replace(Kt,"</"+rr+"><"+rr+">"):t);return"<"+er+"><"+tr+"><"+rr+">"+a+"</"+rr+"></"+tr+"></"+er+">"}function br(e,t,r){if(r!==gr&&!r)throw new C(m,"timestamp");if(isNaN(r))throw new y(m,"timestamp",r.toString());return yr(function(e,t,r){return"<"+e+" "+ur+"='"+r+"'>"+t+"</"+e+">"}(e,mr(t),r))}function hr(e){var t=[],r=e.getElementsByTagName("tr");if(r.length>0){var a=Sr(r[0]);t.push(a);for(var o=1;o<r.length;o+=1){t.push(Vt),t.push(Ht);var n=Sr(r[o]);t.push(n)}}return t.join("")}function Sr(e){var t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(var a=1;a<r.length;a+=1)t.push(kt),t.push(r[a].innerText)}return t.join("")}function Cr(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(ur)}function yr(e){if(!V()||K())return e;var t=lr.length,r=sr.length+e.length+cr.length,a=(r-cr.length).toString();if(a.length<t&&(a=lr.substr(0,t-a.length)+a),a.length!==t){var o="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is "+a.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128536,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new j(d.UnexpectedClipboardTextHtmlContentLength,o)}var n=(r-dr).toString();if(n.length<t&&(n=lr.substr(0,t-n.length)+n),n.length!==t){o="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is "+n.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128537,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new j(d.UnexpectedClipboardTextHtmlContentLength,o)}var c=sr.replace("{EndHTML0}",n).replace("{EndFragm}",a)+e+cr;return s().ULS.shipAssertTag(596128538,i.LogCategory.msoulscat_ES_EWAJS,c.length===r,"addClipboardWrapperForEdge: The resulting text/html payload length of "+c.length+" differs from the expected length of "+r),c}function vr(e){if(!e)return m;if(!e.trim())return e;var t=e.indexOf(ar),r=e.indexOf(or);if(t<0||r<0||t>r)return e;var a=t+nr,o=r-a,n=e.indexOf(ar,a),i=e.indexOf(or,r+ir);return n>=0||i>=0?e:e.substr(a,o)}function Er(e){var t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new C(m,"attributeName");var r=new RegExp(t+"=['\"](\\d+)['\"]","i").exec(e);if(!r||r.length<2)return;return r[1]}(e,ur);if(t&&t.trim()){var r=Number(t);if((r||r===gr)&&!isNaN(r))return r}}function wr(e){return e?e.replace(Qt,qt).replace(Xt,Yt):m}function Lr(e,t,r){var a="";return r&&(a=Object.keys(r).reduce(function(e,t){return t?e+" "+t+"='"+r[t]+"'":e},"")),"<"+t+a+">"+e+"</"+t+">"}r.d(t,"cc",function(){return s}),r.d(t,"Db",function(){return c}),r.d(t,"Fb",function(){return b}),r.d(t,"Gb",function(){return h}),r.d(t,"a",function(){return S}),r.d(t,"B",function(){return C}),r.d(t,"t",function(){return y}),r.d(t,"u",function(){return v}),r.d(t,"L",function(){return E}),r.d(t,"A",function(){return w}),r.d(t,"J",function(){return L}),r.d(t,"M",function(){return T}),r.d(t,"K",function(){return _}),r.d(t,"b",function(){return P}),r.d(t,"m",function(){return O}),r.d(t,"G",function(){return A}),r.d(t,"c",function(){return x}),r.d(t,"e",function(){return j}),r.d(t,"I",function(){return D}),r.d(t,"Yb",function(){return M}),r.d(t,"Cb",function(){return J}),r.d(t,"Kb",function(){return H}),r.d(t,"Hb",function(){return V}),r.d(t,"Jb",function(){return B}),r.d(t,"Ib",function(){return K}),r.d(t,"zb",function(){return G}),r.d(t,"ib",function(){return m}),r.d(t,"Ub",function(){return" "}),r.d(t,"Tb",function(){return"."}),r.d(t,"Rb",function(){return"1"}),r.d(t,"Sb",function(){return"1"}),r.d(t,"i",function(){return l}),r.d(t,"j",function(){return"copy"}),r.d(t,"p",function(){return"cut"}),r.d(t,"D",function(){return"paste"}),r.d(t,"k",function(){return"copy"}),r.d(t,"q",function(){return"cut"}),r.d(t,"E",function(){return"paste"}),r.d(t,"O",function(){return q}),r.d(t,"gb",function(){return X}),r.d(t,"hb",function(){return"Text"}),r.d(t,"bc",function(){return"text/html"}),r.d(t,"Bb",function(){return"image/png"}),r.d(t,"Pb",function(){return"metadata/is-last-copy-was-external"}),r.d(t,"Qb",function(){return"metadata/is-last-copy-was-external-XLO-source"}),r.d(t,"Ob",function(){return"metadata/ccp-infra-version"}),r.d(t,"Nb",function(){return"copyId"}),r.d(t,"pb",function(){return Y}),r.d(t,"rb",function(){return ae}),r.d(t,"nb",function(){return oe}),r.d(t,"mb",function(){return ne}),r.d(t,"Q",function(){return ie}),r.d(t,"lb",function(){return se}),r.d(t,"kb",function(){return ce}),r.d(t,"ob",function(){return le}),r.d(t,"sb",function(){return de}),r.d(t,"g",function(){return $}),r.d(t,"r",function(){return ee}),r.d(t,"f",function(){return d}),r.d(t,"n",function(){return u}),r.d(t,"H",function(){return g}),r.d(t,"d",function(){return p}),r.d(t,"s",function(){return te}),r.d(t,"wb",function(){return Ue}),r.d(t,"gc",function(){return Re}),r.d(t,"C",function(){return He}),r.d(t,"hc",function(){return Ve}),r.d(t,"ac",function(){return Be}),r.d(t,"ab",function(){return Ke}),r.d(t,"T",function(){return Ge}),r.d(t,"jb",function(){return Qe}),r.d(t,"R",function(){return Xe}),r.d(t,"z",function(){return Ye}),r.d(t,"Mb",function(){return Ze}),r.d(t,"ec",function(){return $e}),r.d(t,"S",function(){return et}),r.d(t,"fc",function(){return tt}),r.d(t,"h",function(){return at}),r.d(t,"U",function(){return nt}),r.d(t,"V",function(){return dt}),r.d(t,"W",function(){return rt}),r.d(t,"Z",function(){return gt}),r.d(t,"bb",function(){return pt}),r.d(t,"Eb",function(){return"initmessageid"}),r.d(t,"dc",function(){return"unknownmessageid"}),r.d(t,"Vb",function(){return"CreatorOrigin"}),r.d(t,"xb",function(){return ft}),r.d(t,"N",function(){return mt}),r.d(t,"eb",function(){return St}),r.d(t,"cb",function(){return Ct}),r.d(t,"fb",function(){return Et}),r.d(t,"db",function(){return wt}),r.d(t,"v",function(){return It}),r.d(t,"Lb",function(){return Pt}),r.d(t,"tb",function(){return Ot}),r.d(t,"ub",function(){return At}),r.d(t,"vb",function(){return xt}),r.d(t,"l",function(){return Dt}),r.d(t,"F",function(){return Mt}),r.d(t,"o",function(){return jt}),r.d(t,"qb",function(){return Wt}),r.d(t,"P",function(){return Ut}),r.d(t,"yb",function(){return Le}),r.d(t,"Y",function(){return Ft}),r.d(t,"x",function(){return Nt}),r.d(t,"X",function(){return Rt}),r.d(t,"w",function(){return Jt}),r.d(t,"y",function(){return zt}),r.d(t,"Wb",function(){return"SessionId"}),r.d(t,"Xb",function(){return"WacCluster"}),r.d(t,"Ab",function(){return o}),r.d(t,"Zb",function(){return a})},2:function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return n}),r.d(t,"__rest",function(){return i}),r.d(t,"__decorate",function(){return s}),r.d(t,"__param",function(){return c}),r.d(t,"__metadata",function(){return l}),r.d(t,"__awaiter",function(){return d}),r.d(t,"__generator",function(){return u}),r.d(t,"__exportStar",function(){return g}),r.d(t,"__values",function(){return p}),r.d(t,"__read",function(){return f}),r.d(t,"__spread",function(){return m}),r.d(t,"__spreadArrays",function(){return b}),r.d(t,"__await",function(){return h}),r.d(t,"__asyncGenerator",function(){return S}),r.d(t,"__asyncDelegator",function(){return C}),r.d(t,"__asyncValues",function(){return y}),r.d(t,"__makeTemplateObject",function(){return v}),r.d(t,"__importStar",function(){return E}),r.d(t,"__importDefault",function(){return w});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var n=function(){return(n=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]])}return r}function s(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,a){t(r,a,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,r,a){return new(r||(r=Promise))(function(o,n){function i(e){try{c(a.next(e))}catch(e){n(e)}}function s(e){try{c(a.throw(e))}catch(e){n(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,s)}c((a=a.apply(e,t||[])).next())})}function u(e,t){var r,a,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return i.label++,{value:n[1],done:!1};case 5:i.label++,a=n[1],n=[0];continue;case 7:n=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){i=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){i.label=n[1];break}if(6===n[0]&&i.label<o[1]){i.label=o[1],o=n;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(n);break}o[2]&&i.ops.pop(),i.trys.pop();continue}n=t.call(e,i)}catch(e){n=[6,e],a=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}function g(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function f(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,o,n=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(e){o={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<r;t++)for(var n=arguments[t],i=0,s=n.length;i<s;i++,o++)a[o]=n[i];return a}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function S(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,o=r.apply(e,t||[]),n=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(e){o[e]&&(a[e]=function(t){return new Promise(function(r,a){n.push([e,t,r,a])>1||s(e,t)})})}function s(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,l):d(n[0][2],r)}catch(e){d(n[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),n.shift(),n.length&&s(n[0][0],n[0][1])}}function C(e){var t,r;return t={},a("next"),a("throw",function(e){throw e}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,o){t[a]=e[a]?function(t){return(r=!r)?{value:h(e[a](t)),done:"return"===a}:o?o(t):t}:o}}function y(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(r){t[r]=e[r]&&function(t){return new Promise(function(a,o){(function(e,t,r,a){Promise.resolve(a).then(function(t){e({value:t,done:r})},t)})(a,o,(t=e[r](t)).done,t.value)})}}}function v(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function w(e){return e&&e.__esModule?e:{default:e}}},21:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce(function(e,a){return e.then(function(){return r&&r.stop?Promise.resolve(void 0):t(a,r)})},Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>a)return t;if(null==t||"object"!=typeof t)return t;var o={};Object.getOwnPropertyNames(t).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])});var n=Object.getPrototypeOf(t);n&&"object"==typeof n&&Object.keys(n).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])});var i={};Object.keys(o).forEach(function(t){i[t]=e(o[t],r+1)});return i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var a=5;var o="_",n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,o).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===o&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===o&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(void 0),a=function(t){r=r.catch(function(r){return e(t,r)})},o=1;o<=t;o+=1)a(o);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.resolve();for(var r=t(e[0]),a=function(a){var o=e[a];r=r.catch(function(){return t(o)})},o=1;o<e.length;o+=1)a(o);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,a=e.length,o=0;o<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==a-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));var n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n},t.getCharIndexInTextFromPoint=function(e,t){var r=-1,a=null;if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,t))&&(r=o.offset,a=null!=o.offsetNode&&null!=o.offsetNode.parentElement&&"SPAN"===o.offsetNode.parentElement.nodeName?o.offsetNode.parentElement:o.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(o=document.caretRangeFromPoint(e,t))&&(r=o.startOffset,a=null!=o.startContainer&&null!=o.startContainer.parentElement&&"SPAN"===o.startContainer.parentElement.nodeName?o.startContainer.parentElement:o.startContainer)}else try{var o;a=document.elementFromPoint(e,t),(o=document.body.createTextRange()).moveToPoint(e,t);var n=document.body.createTextRange();n.moveToElementText(a),n.setEndPoint("EndToStart",o),r=n.text.length}catch(e){return r}for(;null!=a;)null!=(a=a.previousSibling)&&null!=a.textContent&&(r+=a.textContent.length);return r}},30:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,a){return t.traceTag(0,e,r,a)},traceTag:function(e,r,a,o){return t.traceTag(e,r,a,o)},debugTrace:function(e,r,a){return t.debugTraceTag(0,e,r,a)},debugTraceTag:function(e,r,a,o){return t.debugTraceTag(e,r,a,o)},assert:function(e,r,a){return t.assertTag(0,e,r,a)},assertTag:function(e,r,a,o){return t.assertTag(e,r,a,o)},shipAssert:function(e,r,a){return t.shipAssertTag(0,e,r,a)},shipAssertTag:function(e,r,a,o){return t.shipAssertTag(e,r,a,o)}}}}};var a=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,a){console.assert(r,"shipAssertTag:",e,t,a)},e.prototype.assertTag=function(e,t,r,a){console.assert(r,"assertTag",e,t,a)},e.prototype.traceTag=function(e,t,r,a){console.log("traceTag",e,a,t,r)},e.prototype.debugTraceTag=function(e,t,r,a){console.log("debugTraceTag",e,a,t,r)},e}();t.ConsoleLogger=a;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=o},40:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={},o="promises";t.promises=function(){return void 0===a[o]&&(a[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),a[o]}},41:function(e,t,r){"use strict";function a(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function o(e,t,r){e[t]=a()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=a(),r=e,n=t,i={},s=function(e,t,a){return function(e,t,r,a,n,i){o(e,"end",r);var s={sessionName:t,result:a?"success":"failure",message:i,marks:e},c=JSON.stringify(s);n(c)}(i,r,n,e,t,a)};return i.start=0,{mark:function(e){return function(e){return o(i,e,n)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)}},56:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=r(21);function n(e,t,r){return e?!(t&&!e.objectStoreNames.contains(t))||(r({name:"ValidationError",message:"The database doesn't contain store name: "+t}),!1):(r({name:"ValidationError",message:"The database should be initialized"}),!1)}var i=void 0;function s(e){void 0!==i&&i(e)}function c(e,t,r,a){return new Promise(function(o,i){if(n(e,t,i)){var s,c=e.transaction([t],r);c.oncomplete=function(){return o()},c.onerror=function(){return i(s||c.error)},c.onabort=function(){return i(s||c.error)};var l=c.objectStore(t),d=a(l);d.onerror=function(){s=d.error}}})}t.registerTraceSubscriber=function(e){i=e},t.clearTraceSubscriber=function(){i=void 0},t.setTestDbFactory=function(e){a=e},t.getDbFactory=function(){if(a)return a;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(r){var e=o.getStringifiedError(r);e&&e!==o.defaultToJSONResultWhenStringifyFails||!r||!r.message||(e=r.message);var t=o.getPerfWatchMarkName(e);s("indexedDB_access_error"+(t&&t.length>0?"_":"")+t)}},t.getStoreReadinessPromise=function(e){return new Promise(function(t,r){e.transaction.oncomplete=function(){return t()},e.transaction.onerror=function(){return r(e.transaction.error)}})},t.initDb=function(e,t,r,a){return new Promise(function(o,n){s("idb_open");var i,c,l,d,u=r||0===r?e.open(t,r):e.open(t),g=(i=!1,c=!1,l=function(e){s("idb_open_"+e)},d=function(){return c?(l("already_resolved"),!1):!i||(l("already_rejected"),!1)},{rejectOnce:function(e){l("should_reject"),d()&&(l("rejecting"),i=!0,n(e))},resolveOnce:function(e){l("should_resolve"),d()&&(l("resolving"),c=!0,o(e))}});u.onupgradeneeded=function(e){s("idb_open_onupgradeneeded_start");var r=e.target.result;if(e.oldVersion>0&&function(e){s("idb_open_onupgradeneeded_deleteAllObjectStores");for(var t=[],r=e.objectStoreNames.length-1;r>=0;r-=1){var a=e.objectStoreNames.item(r);(a||""===a)&&t.push(a)}t.forEach(function(t){s("idb_open_onupgradeneeded_delete_store_"+t),e.deleteObjectStore(t)})}(r),a){s("idb_open_onupgradeneeded_create_stores");var o=a(r);o&&o.length>0&&Promise.all(o).then(function(){s("idb_open_onupgradeneeded_stores_ready"),g.resolveOnce({db:r,dbName:t})},function(e){s("idb_open_onupgradeneeded_stores_ready_error"),g.rejectOnce(e)})}s("idb_open_onupgradeneeded_end")},u.onsuccess=function(e){s("idb_open_onsuccess"),g.resolveOnce({db:e.target.result,dbName:t})},u.onerror=function(){s("idb_open_onerror"),g.rejectOnce(u.error)},u.onblocked=function(e){s("idb_open_onblocked"),g.rejectOnce(e)}})},t.deleteDb=function(e,t){return new Promise(function(r,a){var o=e.deleteDatabase(t);o.onsuccess=function(){return r()},o.onblocked=function(){return r()},o.onerror=function(){return a(o.error)}})},t.doTransactionAction=c,t.put=function(e,t,r,a){return c(e,t,"readwrite",function(e){return r?e.put(a,r):e.put(a)})},t.get=function(e,t,r){return new Promise(function(a,o){if(n(e,void 0,o)){var i;e.objectStoreNames.contains(t)||a(void 0);var s=void 0,c=e.transaction([t],"readonly");c.oncomplete=function(){return a(s)},c.onerror=function(){return o(i||c.error)},c.onabort=function(){return o(i||c.error)};var l=c.objectStore(t).get(r);l.onsuccess=function(e){s=e.target.result},l.onerror=function(){i=l.error}}})},t.getAllItems=function(e,t){return new Promise(function(r,a){if(n(e,t,a)){var o,i=[],s=e.transaction([t],"readonly");s.oncomplete=function(){return r(i)},s.onerror=function(){return a(o||s.error)},s.onabort=function(){return a(o||s.error)};var c=s.objectStore(t).openCursor();c.onsuccess=function(e){var t=e.target.result;t&&(i.push(t.value),t.continue())},c.onerror=function(){o=c.error}}})},t.getAllKeys=function(e,t){return new Promise(function(r,a){if(n(e,t,a)){var o,i=[],s=e.transaction([t],"readonly");s.oncomplete=function(){return r(i)},s.onerror=function(){return a(o||s.error)},s.onabort=function(){return a(o||s.error)};var c=s.objectStore(t).openCursor();c.onsuccess=function(e){var t=e.target.result;t&&(i.push(t.key),t.continue())},c.onerror=function(){o=c.error}}})},t.remove=function(e,t,r){return c(e,t,"readwrite",function(e){return e.delete(r)})},t.removeAll=function(e,t){return c(e,t,"readwrite",function(e){return e.clear()})}},57:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return a},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");a=e}},58:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(a=function(){return self.performance.now()}),function(r){var o=a(),n=r;return{reset:function(e){null!=e&&(n=e),o=a()},stop:function(){var r=a()-o,i=JSON.stringify({Target:n,Duration:r.toFixed(t)});e(i)}}}}},59:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var a=!1,o=window.performance;try{o&&o.now&&o.now()!==1/0&&(a=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var n=0;n<e.length;n+=1){try{if(a){t.perfNow=!0;var i=Math.floor(100*o.now())%10;(i<0||i>9)&&(i=0);for(var s=0;s<i;s+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[n]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=15&e[r];return r+=1,("x"===t?a:3&a|8).toString(16)}),t]}},851:function(e,t,r){"use strict";r.r(t);var a,o=r(1),n=r(0);function i(e){Object(o.cc)().ULS.shipAssertTag(595944468,n.LogCategory.msoulscat_ES_EWAJS,!!e,"ClipboardPlatformSettings.setClipboardPlatformSettings: expect clipboardPlatformSettings to be defined."),a=e}var s,c=r(2),l="{}";var d,u={serializeMetadata:function(e){if(!e)return l;try{var t={},r=function(e){if(!e)return;try{if(!e.id)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.id is not defined");if(!e.sessionId)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.sessionId is not defined");if(void 0===e.copyStatus)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.copyStatus is not defined");return{id:e.id,sessionId:e.sessionId,sourceItem:s.serializeSourceItem(e.sourceItem),commandParameters:s.serializeCommandParameters(e.commandParameters),copyStatus:e.copyStatus,isTimestampStoredInSystemClipboard:e.isTimestampStoredInSystemClipboard,isAsyncSerializeFailed:e.isAsyncSerializeFailed}}catch(e){return void Object(o.cc)().ULS.traceTag(595945243,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.serializeCopyContext: failed to serialized copyContext: "+n.utils.getStringifiedError(e))}}(e.lastCopy);return r&&(t.copyContext=r),JSON.stringify(t)}catch(e){return Object(o.cc)().ULS.traceTag(595945242,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.serializeMetadata: failed to serialized metadata: "+n.utils.getStringifiedError(e)),l}},deserializeMetadata:function(e){if(!e)return Object(o.qb)();try{var t=JSON.parse(e),r={};return t.copyContext&&(r.lastCopy=function(e){if(!e)return;try{if(!e.id)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.id is not defined");if(!e.sessionId)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sessionId is not defined");if(!e.copyStatus)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.copyStatus is not defined");if(!e.sourceItem)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sourceItem is not defined");if(!e.commandParameters)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.commandParameters is not defined");var t=new o.l;return t.id=e.id,t.sessionId=e.sessionId,t.copyStatus=e.copyStatus,t.isTimestampStoredInSystemClipboard=e.isTimestampStoredInSystemClipboard,t.isAsyncSerializeFailed=e.isAsyncSerializeFailed,t.sourceItem=s.deserializeSourceItem(e.sourceItem),t.commandParameters=s.deserializeCommandParameters(e.commandParameters),t}catch(e){return void Object(o.cc)().ULS.traceTag(595945245,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized copyContext with error: "+n.utils.getStringifiedError(e)+".")}}(t.copyContext)),r}catch(e){Object(o.cc)().ULS.traceTag(595945244,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized metadata with error: "+n.utils.getStringifiedError(e))}return Object(o.qb)()}};function g(e,t,r){return Object(o.cc)().ULS.shipAssertTag(595945246,n.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected clipboardStrategy to be defined."),Object(o.cc)().ULS.shipAssertTag(595945247,n.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected metadataSerializationHelper to be defined."),d=e,p=function(e){return s=e,u}(t),(f=r)&&f.setOnMetadataChangedListener(C),S}var p,f,m,b=Object(o.qb)(),h={},S={getCachedMetadata:function(){return Object(o.cc)().ULS.traceTag(595730648,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getCachedMetadata: get cached metadata with value: "+w(b)),Object(o.P)(b)},updateMetadata:function(e){Object(o.cc)().ULS.traceTag(595730652,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateMetadata: start update metadata with metadata : "+w(e));var t=c.__assign({},b,e),r=Object(o.Q)();r.setItem("metadata",p.serializeMetadata(t)),Object(o.cc)().ULS.traceTag(595730653,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateMetadata: schedule metadata with value: "+w(t)),v(r,t)},clear:function(){Object(o.cc)().ULS.traceTag(595730654,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.clear: start clear metadata");var e=Object(o.qb)();v(Object(o.Q)(),e)},addMetadataChangeListener:function(e,t){e||Object(o.cc)().ULS.traceTag(595936158,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");t||Object(o.cc)().ULS.traceTag(595936159,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listener to be define");h[e]&&Object(o.cc)().ULS.traceTag(595936160,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: listener with same listenerId("+e+" already exist.");h[e]=t},removeMetadataChangeListener:function(e){e||Object(o.cc)().ULS.traceTag(595936161,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");h[e]?delete h[e]:Object(o.cc)().ULS.traceTag(595936162,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.removeMetadataChangeListener: can't find listener with listenerId = "+e+".")},getMetadataSyncPromise:function(){if(!m||!Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:2594435_ArtCCPWaitForCopyToComplete"))return Object(o.cc)().ULS.traceTag(595937173,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata is sync, return resolved promise."),Promise.resolve(Object(o.P)(b));return Object(o.cc)().ULS.traceTag(595937174,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata not sync, return deferred promise."),m.deferredPromise.promise.then(function(e){return Object(o.cc)().ULS.traceTag(595937175,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: sync promise resolved."),e})},isMetadataSync:function(){return!m}};function C(e){try{if(e&&0!==Object(o.mb)(e)){var t=e.getItem("metadata");b=p.deserializeMetadata(t),Object(o.cc)().ULS.traceTag(595730650,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.onMetadataChanged: set cached metadata with value "+w(b))}else Object(o.cc)().ULS.traceTag(595730649,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.onMetadataChanged: set empty cached metadata because clipboardItems were not found"),b=Object(o.qb)()}catch(e){Object(o.cc)().ULS.traceTag(595945248,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.onMetadataChanged: failed to parse metadata string with error: "+n.utils.getStringifiedError(e)),b=Object(o.qb)()}y(Object(o.P)(b))}function y(e){for(var t in Object(o.cc)().ULS.traceTag(595730651,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateListenerForMetadataChanged: update listeners with metadata : "+w(e)),h){var r=h[t];r&&r(e)}}function v(e,t){var r=Object(o.ab)();m?m.metadataSyncMessageId=r:(m={metadataSyncMessageId:r,deferredPromise:Object(o.U)()},Object(o.cc)().ULS.traceTag(595937176,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: _syncMetadata created. "+m.metadataSyncMessageId)),Object(o.cc)().ULS.traceTag(595937177,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata request was sent with message id "+r+"."),setTimeout(function(){d.set(e,{}).then(function(){b=t,Object(o.cc)().ULS.traceTag(595937178,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata successfully. messageId="+r+". _syncMetadata.metadataSyncMessageId = "+(m&&m.metadataSyncMessageId)+". newMetadata = "+w(t)),E(r)},function(e){Object(o.cc)().ULS.traceTag(595945250,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.updateMetadata: failed to update metadata store with error: "+n.utils.getStringifiedError(e)),E(r)})},0)}function E(e){if(Object(o.cc)().ULS.traceTag(595730655,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: start notifyMetadataSyncIfNeeded with messageId: "+e),m&&m.metadataSyncMessageId===e){var t=m;m=void 0;var r=Object(o.P)(b);Object(o.cc)().ULS.traceTag(595730656,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: resolve with metadata: "+w(r)),y(r),t.deferredPromise.resolve(r)}}function w(e){return e?e.lastCopy?"copyContext.id="+e.lastCopy.id:"copy context is null":"metadata is null"}var L=1565411791,T=function(){function e(e,t,r){this.ttlInMs=t,this.blockMismatchDataVersion=r,e?this.userHash=n.utils.calcHashCode(e):(this.userHash=L,Object(o.cc)().ULS.traceTag(595903939,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"userId not exist!. Use default ID"))}return e.prototype.wrapTextWithDataSignature=function(e,t,r,a){void 0===a&&(a="null");var n={ccp_infra_version:2,ccp_infra_timestamp:r,ccp_infra_user_hash:this.userHash,ccp_infra_copy_id:a};return n[o.Ab.ccpTimestampHtmlCustomAttributeName]=r,o.Ab.wrapContentWithTagAndAttributes(e,t,n)},e.prototype.ensureDataSignatureInHtmlItem=function(e){if(0!==Object(o.mb)(e)){var t=Object(o.sb)(e),r=Object(o.kb)(t,o.bc),a=Object(o.kb)(t,o.Nb);if(r){var i=new RegExp(Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3386312_CCPAddLogForClipboardDataManager_fix1")?"ccp_infra_version='(\\d+)'":"^<\\w+\\s+ccp_infra_version='(\\d+)'","g").exec(r);if(i&&i.length&&i.length>1)return;e.setItem(o.bc,this.wrapTextWithDataSignature(r,o.Ab.divTagName,Date.now(),a))}else{var s=Object(o.ob)(t),c=o.Ab.createTextHtmlFromTextPlain(s),l=this.wrapTextWithDataSignature(c,o.Ab.preTagName,Date.now(),a);e.setItem(o.bc,o.Ab.addClipboardWrapperForEdge(l))}}},e.prototype.extractSignatureData=function(e){if(Object(o.nb)(e)>0){var t=Object(o.lb)(e,o.bc),r=new RegExp(Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3386312_CCPAddLogForClipboardDataManager_fix1")?"ccp_infra_version='(\\d+)'":"^<\\w+\\s+ccp_infra_version='(\\d+)'","g").exec(t),a=r&&r.length&&r.length>1?Number(r[1]):NaN;if(isNaN(a)){if(Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3386312_CCPAddLogForClipboardDataManager_fix1")){var i=r&&r.length>0?r.join(","):"no result",s=-1!==t.indexOf("ccp_infra_version"),c=-1!==t.indexOf("ccp_infra_timestamp"),l=-1!==t.indexOf("ccp_infra_user_hash"),d=-1!==t.indexOf("ccp_infra_copy_id"),u="";s&&d&&(u=t.substring(Math.max(0,t.indexOf("ccp_infra_version")-10),t.indexOf("ccp_infra_copy_id"))),Object(o.cc)().ULS.traceTag(595722517,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.extractSignatureData: dataVer is Nan. "+JSON.stringify({verMatchForTelemetry:i,isContainVersion:s,isContainTimestamp:c,isContainUserHash:l,isContainCopyId:d,signatureDataValues:u}))}return this.parsePreSignatureData(t)}if(this.blockMismatchDataVersion&&2!==a)throw Object(o.cc)().ULS.traceTag(595902983,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.extractSignatureData: block mismatch version. dataVer = "+a+", CCPInfraVersion = 2"),new o.A("ClipboardDataManagerImpl.extractSignatureData",a,2,this.blockMismatchDataVersion);var g=t.substring(r[0].length);return a<2?(Object(o.cc)().ULS.traceTag(595902986,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with older version then app version: dataVer = "+a+", CCPInfraVersion = 2. Converting to the data"),this.parseOldSignatureData(g)):(a>2&&Object(o.cc)().ULS.traceTag(595900176,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with newer version then app version: dataVer = "+a+", CCPInfraVersion = 2. ( It's OK - Should be forward compatibility)"),this.parseCurrentVersionSignatureData(g))}},e.prototype.parseCurrentVersionSignatureData=function(e){var t=new RegExp("\\s+ccp_infra_timestamp='(\\d+)'\\s+ccp_infra_user_hash='(\\d+)'","g"),r=new RegExp("\\s+ccp_infra_copy_id='([\\w-]+)'","g"),a=t.exec(e),i=r.exec(e);if(a&&a.length&&a.length>2){var s=Number(a[1]),c=Number(a[2]),l="";if(i&&(l=i[1],Object(o.cc)().ULS.traceTag(595857698,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parseCurrentVersionSignatureData: copy ID of legacy paste cross session : "+l)),s&&!isNaN(s)&&c&&!isNaN(c))return{ccp_infra_version:2,ccp_infra_timestamp:s,ccp_infra_user_hash:c,ccp_infra_copy_id:l}}Object(o.cc)().ULS.traceTag(595902985,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"clipboardDataManager.extractSignatureData: Failed to extract SignatureData from signatureStr. signatureWithoutVersionStr = ("+e+")")},e.prototype.parseOldSignatureData=function(e){return this.parseCurrentVersionSignatureData(e)},e.prototype.parsePreSignatureData=function(e){var t=o.Ab.getCcpTimestampHtmlCustomAttributeFromWrappingTag(e);if(Object(o.cc)().ULS.traceTag(595723668,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData: dataTimeStamp="+t),t){if(this.blockMismatchDataVersion)throw Object(o.cc)().ULS.traceTag(595899270,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.parsePreSignatureData: block mismatch version. block pre signature data"),new o.A("ClipboardDataManagerImpl.extractSignatureData",NaN,2,this.blockMismatchDataVersion);var r={ccp_infra_version:2,ccp_infra_timestamp:t,ccp_infra_user_hash:0};return Object(o.cc)().ULS.traceTag(595723669,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData: signatureData = "+JSON.stringify(r)),r}},e.prototype.validateTTL=function(e){if(e&&this.ttlInMs){var t=Date.now()-e.ccp_infra_timestamp;if(t>this.ttlInMs)throw Object(o.cc)().ULS.traceTag(595899858,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Time elapsed ("+t+" ms) from setting Clipboard ("+e.ccp_infra_timestamp+") is greater then TTL ("+this.ttlInMs+" ms) - return error"),new o.J("clipboardDataManager.validateTTL validation failed",t,this.ttlInMs)}},e.prototype.validateUserHash=function(e){if(e&&e.ccp_infra_user_hash!==this.userHash)throw Object(o.cc)().ULS.traceTag(595723670,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateUserHash: user hash mismatch detected. throw error. signatureData.ccp_infra_user_hash = "+e.ccp_infra_user_hash+". this.userHash="+this.userHash),new o.M("clipboardDataManager.validateUserHash validation failed",e?e.ccp_infra_user_hash:0,this.userHash)},e.prototype.setMetaDataVersionItem=function(e){if(0!==Object(o.mb)(e)){var t={ccp_infra_version:2};e.setItem(o.Ob,JSON.stringify(t))}},e.prototype.validateMetaDataVersionItem=function(e){if(e&&Object(o.mb)(e)>0){var t=Object(o.lb)(e.getData(),o.Ob),r=void 0;try{r=JSON.parse(t)}catch(e){if(!this.blockMismatchDataVersion)return;throw Object(o.cc)().ULS.traceTag(595899272,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: failed parse SignatureMetaData. error = "+e),new o.K("ClipboardDataManagerImpl.validateMetaDataVersionItem: failed parse SignatureMetaData. SignatureMetaData text = "+t)}if(this.blockMismatchDataVersion&&2!==r.ccp_infra_version)throw Object(o.cc)().ULS.traceTag(595899203,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: block mismatch version. dataVer = "+r.ccp_infra_version+", CCPInfraVersion = 2"),new o.A("ClipboardDataManagerImpl.validateMetaDataVersionItem",r.ccp_infra_version,2,this.blockMismatchDataVersion)}},e.prototype.createClipboardDataProcessor=function(e){var t=this;Object(o.cc)().ULS.traceTag(595723671,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor: get called. validateUserHash="+e);return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(r){if(Object(o.cc)().ULS.traceTag(595723672,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: get called. validateUserHash="+e),r){var a=t.extractSignatureData(r.getData());Object(o.cc)().ULS.traceTag(595723673,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: clipboardItems not empty. validateUserHash="+e+" signatureData="+JSON.stringify(a)),Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3520156_CCPAddCopyIdToClipboardItem")&&a&&r.setItem(o.Nb,a.ccp_infra_copy_id),t.validateTTL(a),e&&(Object(o.cc)().ULS.traceTag(595723674,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: going to validate user hash. validateUserHash="+e+" signatureData="+JSON.stringify(a)),t.validateUserHash(a))}}.bind(this)}},e.prototype.createDualClipboardDataProcessor=function(e){var t=this;Object(o.cc)().ULS.traceTag(595723675,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor: get called.");return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(e){Object(o.cc)().ULS.traceTag(595723676,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor.postGet: get called."),e&&e.clipboardItemsData&&(e.signatureData=t.extractSignatureData(e.clipboardItemsData),Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3520156_CCPAddCopyIdToClipboardItem")&&e.signatureData&&(e.clipboardItemsData.items[o.Nb]=e.signatureData.ccp_infra_copy_id),t.validateTTL(e.signatureData))}.bind(this),validateUserHash:e?this.validateUserHash.bind(this):function(){}}},e.prototype.createClipboardMetaDataProcessor=function(){return{preSetProcess:this.setMetaDataVersionItem.bind(this),postGetProcess:this.validateMetaDataVersionItem.bind(this)}},e}();var _=function(e){function t(t,r,a){var o=e.call(this,t,r,a,"WindowRPCClientInternal")||this;return o.pushMessageListeners={},o}return c.__extends(t,e),t.prototype.init=function(e){return this.deferredResultMessagePromiseCache=Object(o.V)(),this.sender=Object(o.db)(this.serializer,this),this.receiver=Object(o.cb)(this.deserializer,this,this),this.postInitMessage(e).catch(function(e){return Object(o.cc)().ULS.traceTag(596129250,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"Init failure or timeout. Error: "+n.utils.getStringifiedError(e)),Object(o.Fb)(e,o.f.IndexedDBCacheInitializationTimeout)?Promise.reject(e):Promise.reject(new o.e(o.f.IndexedDBCacheInitialization,"failed to init the Shared Clipboard",e))})},t.prototype.registerPushMessageListener=function(e,t){this.pushMessageListeners[e]=t},t.prototype.postInitMessage=function(e){var t=Object(o.R)(o.Eb,"init",o.z.initIframe);if(!this.deferredResultMessagePromiseCache){var r="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return Object(o.cc)().ULS.shipAssertTag(596121487,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a=this.postMessage(t),i=this.deferredResultMessagePromiseCache.getDeferredPromise(t.id),s=Date.now();return setTimeout(function(){if(i&&!i.fulfilled()){var e=Date.now(),t="indexedDB initialization started on "+new Date(s)+" and timed out on "+new Date(e)+" after "+(e-s)+" ms";Object(o.cc)().ULS.traceTag(596129251,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,t),i.reject(new o.e(o.f.IndexedDBCacheInitializationTimeout,t))}},e),a},t.prototype.postMessage=function(t){try{if(!t)throw new o.B(o.ib,"outgoingMessage");if(Object(o.cc)().ULS.shipAssertTag(596452175,n.LogCategory.msoulscat_ES_EWAJS,!!t.id,"postMessage: outgoingMessage.id must be defined"),e.prototype.postMessage.call(this,t),!this.deferredResultMessagePromiseCache){var r="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw Object(o.cc)().ULS.shipAssertTag(596121488,n.LogCategory.msoulscat_ES_EWAJS,!1,r),new o.u(r)}return this.deferredResultMessagePromiseCache.addNewPromise(t.id).promise}catch(e){return Promise.reject(new o.u("Unable to post message for operation '"+(t?t.operationCode:void 0)+"'",e))}},t.prototype.handleMessage=function(e){Object(o.cc)().ULS.traceTag(596452376,n.LogCategory.msoulscat_ES_EWAJS,e&&e.failed?n.TraceLevel.Warning:n.TraceLevel.Info,"RPC Client - handleMessage: incomingMessage.id='"+(e&&e.id)+"'; incomingMessage.operationCode='"+(e&&e.operationCode)+"'; incomingMessage.failed='"+(e&&e.failed)+"'; incomingMessage.error='"+(e&&e.error)+"'; incomingMessage.clipboardItems.length="+Object(o.nb)(e&&e.clipboardItemsData));var t=this.pushMessageListeners[e.operationCode];if(t)return t(e.clipboardItemsData),Promise.resolve();if(!this.deferredResultMessagePromiseCache){var r="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return Object(o.cc)().ULS.shipAssertTag(596121489,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a="initresult"===e.operationCode?o.Eb:e.id,i=this.deferredResultMessagePromiseCache.getDeferredPromise(a);return i?(this.deferredResultMessagePromiseCache.delete(a),e.failed?i.reject(e.error):i.resolve(e),Promise.resolve()):(Object(o.cc)().ULS.traceTag(596452377,n.LogCategory.msoulscat_ES_EWAJS,"initresult"===e.operationCode?n.TraceLevel.Warning:n.TraceLevel.Error,a===e.id?"RPC Client - handleMessage: no deferred promise with id '"+e.id+"'; dropping this result.":"RPC Client - handleMessage: no deferred promise with id '"+a+"' for message id '"+e.id+"'; dropping this result."),Promise.resolve())},t.prototype.handleDeserializationError=function(e){return Object(o.cc)().ULS.traceTag(596452379,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"RPC Client - handleDeserializationError. There are "+(this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0)+" deferred promise(s) in the cache. Error: "+n.utils.getStringifiedError(e)),Promise.resolve()},t.prototype.dispose=function(){var t=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.Yb)([function(){t.deferredResultMessagePromiseCache&&t.deferredResultMessagePromiseCache.clear()}]),e.prototype.dispose.call(this))},t}(o.N),I=[],P="load",O="clipboard",A="clipboard/shared.aspx",x="corrid",j={initialized:!1,origin:o.ib,src:o.ib,deferredPromise:void 0},D=void 0;function M(){return j}function W(){var e=document.createElement("iframe");return e.style.display="none",e.id=O,Object(o.cc)().ULS.shipAssertTag(595952726,n.LogCategory.msoulscat_ES_EWAJS,!D,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),R(),D=Object(o.O)(e,P,function(e){return function(e){Object(o.cc)().ULS.traceTag(595952727,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CCP iframe onload event: Entering"),R();var t=M().deferredPromise;if(!t)return void Object(o.cc)().ULS.shipAssertTag(595952728,n.LogCategory.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded");var r=t.id;try{M().deferredPromise=void 0;var a=e.target;if(!a){var i="CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '"+r+"'";return Object(o.cc)().ULS.shipAssertTag(595952729,n.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new o.u(i))}if(!a.contentWindow){i="CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '"+r+"'";return Object(o.cc)().ULS.shipAssertTag(595952730,n.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new o.u(i))}Object(o.cc)().ULS.traceTag(595952732,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CCP iframe onload event: resolving deferred promise id '"+r+"' with the iframe"),t.resolve(a)}catch(e){i="iframeOnLoad: an error has occurred: ["+n.utils.getStringifiedError(e)+"]. Rejecting deferred promise id '"+r+"'";Object(o.cc)().ULS.traceTag(595952733,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i),t.reject(new o.u(i,e))}}(e)}),e.src=M().src,e}function U(e){var t=M().origin,r=t;"/"!==t.charAt(t.length-1)&&(r+="/"),r+=A,e&&(r+="?"+encodeURIComponent(o.Vb)+"="+encodeURIComponent(e));var i=[];I.forEach(function(e){Object(n.ewaUtils)().isChangeGateEnabled(e)||i.push({key:e,value:"1"})});var s=function(){if(!a)throw new o.u("ClipboardPlatformSettings is not ready. Call ClipboardPlatformEnvironment.init(...).");return a}();if(s){var c=s.wacCluster;c&&i.push({key:o.Xb,value:c}),s.sessionId&&i.push({key:o.Wb,value:s.sessionId})}var l=Object(n.getNewGuid)(),d=l[0],u=l[1];return Object(o.cc)().ULS.traceTag(595722560,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getValidatedIframeSrc.getValidatedIframeSrc: Generate correlation if for loading the shared clipboard frame. CorrelationId: "+d+" newGuidLogging: "+u),i.push({key:x,value:d}),Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3405066_CCPSharedClipboardNoAuthQueryString")&&i.push({key:"NoAuth",value:"true"}),i.length>0&&i.forEach(function(e){r+=function(e){if(e.indexOf("?")>=0)return"&";return"?"}(r),r+=encodeURIComponent(e.key)+"="+encodeURIComponent(e.value)}),r}function R(){if(D){try{D()}catch(e){}D=void 0}}var J=void 0;function F(){if(!J)return Promise.reject("state in undefined, please make sure to call initialize first");var e=function(){if(!M().initialized)throw new o.u("getIframe: the initialize function should be called beforehand");var e=document.getElementsByTagName("iframe");if(e&&0!==e.length){Object(o.cc)().ULS.traceTag(595952723,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: found "+e.length+" iframes");for(var t=0;t<e.length;t+=1){var r=e[t];if(r&&r.id&&r.id===O)return r}Object(o.cc)().ULS.traceTag(595952724,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: the CCP iframe does not exist")}else Object(o.cc)().ULS.traceTag(595952722,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: found no iframes")}();e&&(Object(o.cc)().ULS.traceTag(596448770,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src "+(void 0!==e.src&&void 0!==J.src&&e.src.toLowerCase()===J.src.toLowerCase()?"===":"!==")+" src; deferredPromise "+(void 0===J.deferredPromise?"does not exist":"exists")+"; The iframe's content window "+(void 0===e.contentWindow?"does not exist":"exists")+"."),function(e){if(!e)throw new o.B(o.ib,"iframe");Object(o.cc)().ULS.traceTag(595952725,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"removeIframe: removing the CCP iframe"),R(),e.parentNode&&e.parentNode.removeChild(e)}(e),e=void 0);var t=J.deferredPromise,r=t?t.id:o.ib;if(t){R(),J.deferredPromise=void 0;var a="ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '"+r+"' and creating a new one";Object(o.cc)().ULS.shipAssertTag(596453587,n.LogCategory.msoulscat_ES_EWAJS,!1,a),t.reject(new o.u(a)),t=void 0}J.deferredPromise=Object(o.U)(Object(o.ab)()),r=(t=J.deferredPromise).id;try{e=W(),document.getElementsByTagName("body")[0].appendChild(e)}catch(e){a="ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '"+r+"'";return Object(o.cc)().ULS.traceTag(596453588,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,a),J.deferredPromise=void 0,R(),Promise.reject(new o.u(a,e))}return t&&!t.fulfilled()?t.promise:(R(),e.contentWindow?(J.deferredPromise=void 0,Promise.resolve(e)):(Object(o.cc)().ULS.shipAssertTag(596453589,n.LogCategory.msoulscat_ES_EWAJS,!1,"ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '"+r+"'"),Promise.reject(new o.u("ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '"+r+"'"))))}var N,z,k=3,H=2e4,V=5e3;function B(){if(z)return z.promise;z=Object(o.U)(Object(o.ab)());try{var e=function(e){return J||(J=M()),J.initialized?J.origin:(J.origin=Object(o.wb)(e),J.src=U(e),J.initialized=!0,J.origin)}(Object(o.yb)().origin);N=function(e,t){return new _(Object(o.bb)(o.ec),Object(o.Z)(o.fc),{window:t,windowOrigin:e})}(e,void 0),n.utils.retry(function(e,t){var r=Object(o.Fb)(t,o.f.IndexedDBCacheInitializationTimeout);return function(e,t){if(!N){var r="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";return Object(o.cc)().ULS.shipAssertTag(595947544,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a=n.perfWatch.start("Iframe_initialize_"+e);n.perfWatch.mark(a,"start"),N.remoteWindow.window=void 0;var i=function(r){var i=Object(o.Fb)(r,o.f.IndexedDBCacheInitializationTimeout)?" due to a timeout of approx. "+t+" ms":o.ib;n.perfWatch.mark(a,"finish_error"),n.perfWatch.failure(a,function(e){return Object(o.cc)().ULS.traceTag(596452419,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,e)},"Attempt #"+e+" failed to initialize an iframe "+i+". "+(e<k?"Retrying...":"No more retries!")+". Error: "+n.utils.getStringifiedError(r))},s=Object(o.U)();return F().then(function(r){if(n.perfWatch.mark(a,"iframe_loaded"),n.perfWatch.mark(a,"iframe_waiting_for_idb_init"),!N){var s="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";Object(o.cc)().ULS.shipAssertTag(595947545,n.LogCategory.msoulscat_ES_EWAJS,!1,s);var c=new o.u(s);return i(c),Promise.reject(c)}if(!r.contentWindow){s="clipboardIframeLoader::initializeIframe - remoteWindow.contentWindow should be defined";Object(o.cc)().ULS.shipAssertTag(595903557,n.LogCategory.msoulscat_ES_EWAJS,!1,s);c=new o.u(s);return i(c),Promise.reject(c)}return N.remoteWindow.window=r.contentWindow,N.init(t).then(function(){return n.perfWatch.mark(a,"iframe_idb_init_complete"),n.perfWatch.mark(a,"finish"),n.perfWatch.success(a,function(e){return Object(o.cc)().ULS.traceTag(596452418,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)},"Attempt #"+e+" initialized iframe"),Promise.resolve()})}).then(function(){s.resolve()},function(e){i(e),s.reject(e)}),s.promise}(e,H+(r?V:0)*(e-1))},3).then(function(){z.resolve(N)},function(e){z.reject(e)})}catch(e){z.reject(e)}return z.promise}var K=function(){function e(){this.initialized=!1}return e.prototype.innerInitialize=function(){var e=this;return B().then(function(t){return e.initialized=!0,e.windowRPCClient=t,e})},e.prototype.registerPushMessageListener=function(e,t){this.windowRPCClient&&this.windowRPCClient.registerPushMessageListener(e,t)},e.prototype.postMessage=function(e,t){if(!this.initialized)return Promise.reject(new o.e(o.f.IndexedDBCacheInitialization));var r=n.perfWatch.start("BaseIframeProxy_"+t);n.perfWatch.mark(r,"start");var a=function(e){return n.perfWatch.mark(r,"finish_error"),n.perfWatch.failure(r,function(e){return Object(o.cc)().ULS.traceTag(596452188,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,e)},"Failed in BaseIframeProxy.postMessage. Error: "+n.utils.getStringifiedError(e)),Promise.reject(new o.e(o.f.IframeProxyGeneralError,"Failed in BaseIframeProxy.postMessage",e))};if(!this.windowRPCClient){var i="BaseIframeProxy.postMessage - this.windowRPCClient should be defined";return Object(o.cc)().ULS.shipAssertTag(595944461,n.LogCategory.msoulscat_ES_EWAJS,!1,i),a(new o.u(i))}return this.windowRPCClient.postMessage(e).then(function(e){return Object(o.cc)().ULS.shipAssertTag(595944462,n.LogCategory.msoulscat_ES_EWAJS,!!e,"BaseIframeProxy.postMessage: postMessage must have returned a result message"),e?e.failed?Promise.reject(new o.e(o.f.IframeProxyGeneralError,"BaseIframeProxy.postMessage: the operation failed. Error: "+e.error)):(n.perfWatch.mark(r,"finish"),n.perfWatch.success(r,function(e){return Object(o.cc)().ULS.traceTag(596452187,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)}),Promise.resolve(e)):Promise.reject(new o.e(o.f.IframeProxyEmptyResultMessage,"BaseIframeProxy.postMessage: postMessage succeeded but returned nothing"))}).catch(function(e){return a(e)})},e}(),G=function(){function e(e){this.localStorageKey=e}return e.prototype.initialize=function(e){var t=this;return new o.y(this.localStorageKey,e,function(e){t._onMetadataChangedListener&&t._onMetadataChangedListener(e)}),Promise.resolve()},e.prototype.setOnMetadataChangedListener=function(e){Object(o.cc)().ULS.traceTag(595716297,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(o.cc)().ULS.shipAssertTag(595716298,n.LogCategory.msoulscat_ES_EWAJS,!!e,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},e}(),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c.__extends(t,e),t.prototype.initialize=function(t){var r=this;return e.prototype.innerInitialize.call(this).then(function(){r.registerPushMessageListener("getMetadata_longPollingresult",function(e){r._onMetadataChangedListener&&r._onMetadataChangedListener(Object(o.Q)(e))})})},t.prototype.setOnMetadataChangedListener=function(e){Object(o.cc)().ULS.traceTag(595730647,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"LongPollingMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(o.cc)().ULS.shipAssertTag(595944466,n.LogCategory.msoulscat_ES_EWAJS,!!e,"LongPollingMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},t}(K),q=function(e){function t(t){return e.call(this,o.i.SystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},t)||this}return c.__extends(t,e),t}(o.h),X=!0;function Y(){return X}function Z(){X=!1}var $=!0;function ee(){return $}function te(){$=!1}function re(){var e=void 0;try{e=window.clipboardData}catch(e){Object(o.cc)().ULS.traceTag(595985225,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: "+n.utils.getStringifiedError(e))}return e}function ae(){if(Object(o.cc)().ULS.shipAssertTag(596455701,n.LogCategory.msoulscat_ES_EWAJS,Object(o.Kb)(),"The browser must be IE"),!Object(o.Kb)())throw new o.u("The browser must be IE")}var oe="command",ne="copy",ie="paste",se="object",ce=!1,le=!0,de=void 0;function ue(){if(void 0===de&&(de=!1,"chrome"in window)){var e=window.chrome;e&&("runtime"in e&&e.runtime?"sendMessage"in e.runtime&&e.runtime.sendMessage?de=!0:Object(o.cc)().ULS.traceTag(596455703,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"chrome.runtime.sendMessage is not available"):Object(o.cc)().ULS.traceTag(596455704,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chrome.runtime is not available"))}return de}var ge=new RegExp("</"+o.Ab.divTagName+"><"+o.Ab.divTagName+">","g"),pe="</"+o.Ab.divTagName+">\\n<"+o.Ab.divTagName+">";function fe(e){if(!ue())return Promise.reject(new o.e(o.f.MissingBrowserExtensionCapability));var t=at().getChromeExtensionIds();if(0===t.length)return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration));var r=o.ib;if(Object(o.nb)(e)>0){var a=Object(o.lb)(e,o.gb);if(a){a=o.Ab.encodeAngleBrackets(a);var i=Date.now(),s=Object(o.lb)(e,o.bc);if(Object(o.cc)().ULS.shipAssertTag(596444116,n.LogCategory.msoulscat_ES_EWAJS,!!s,"chromeSystemClipboard - '"+ne+"': cannot find a text/html clipboard item"),s){var c=o.Ab.getCcpTimestampHtmlCustomAttributeFromWrappingTag(s);Object(o.cc)().ULS.shipAssertTag(596444117,n.LogCategory.msoulscat_ES_EWAJS,!!c,"chromeSystemClipboard - '"+ne+"': cannot find the 'data-ccp-timestamp' HTML custom attribute in the text/html clipboard item"),c&&(i=c)}r=o.Ab.createHtmlItemFromTextPlain(o.Ab.preTagName,a,i)}}var l={};return l[oe]=ne,l[se]=r,t.reduce(function(e,t){return e.then(function(e){var r="chromeSystemClipboard: browser extension '"+t+"' will not be called since the previous extension was called successfully with command '"+ne+"'";return Object(o.cc)().ULS.assertTag(596455705,n.LogCategory.msoulscat_ES_EWAJS,!e,r),Object(o.cc)().ULS.traceTag(595985886,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,r),ce},function(e){return Object(o.cc)().ULS.traceTag(596455706,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard: browser extension '"+t+"' will be called with command '"+ne+"'"),Promise.resolve(le)}).then(function(e){return e?function(e,t){return new Promise(function(r,a){window.chrome.runtime.sendMessage(e,t,void 0,function(t){var n=window.chrome.runtime.lastError;if(n){var i=o.ib;"message"in n&&"string"==typeof n.message&&(i=n.message),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - '"+ne+"': browser extension '"+e+"' is not available. Error: "+i))}else r(ce)})})}(t,l):Promise.resolve(ce)})},Promise.reject(void 0)).then(function(e){return e?Promise.reject(new o.e(o.f.NoAvailableBrowserExtensions)):Promise.resolve()})}function me(){if(!ue())return Promise.reject(new o.e(o.f.MissingBrowserExtensionCapability));var e=at().getChromeExtensionIds();if(0===e.length)return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration));var t={};return t[oe]=ie,e.reduce(function(e,r){return e.then(function(e){var t="chromeSystemClipboard: browser extension '"+r+"' will not be called since the previous extension was called successfully with command '"+ie+"'";return Object(o.cc)().ULS.assertTag(595985887,n.LogCategory.msoulscat_ES_EWAJS,!!e&&!e.tryTheNextExtension,t),Object(o.cc)().ULS.traceTag(596455707,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,t),e},function(e){return Object(o.cc)().ULS.traceTag(596455708,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard: browser extension '"+r+"' will be called with command '"+ie+"'"),Promise.resolve({tryTheNextExtension:!0,text:o.ib,html:o.ib})}).then(function(e){return e.tryTheNextExtension?function(e,t){return new Promise(function(r,a){window.chrome.runtime.sendMessage(e,t,void 0,function(t){var n=window.chrome.runtime.lastError;if(!t&&t!==o.ib||"string"!=typeof t||n){var i=o.ib;"message"in n&&"string"==typeof n.message&&(i=n.message),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - '"+ie+"': browser extension '"+e+"' is not available. Error: "+i))}else{var s=t,c=document.createElement(o.Ab.divTagName),l=s.replace(ge,pe);c.innerHTML=l,r({tryTheNextExtension:!1,text:c.innerText,html:s})}})})}(r,t):Promise.resolve(e)})},Promise.reject(void 0)).then(function(e){if(!e||!("tryTheNextExtension"in e)||e.tryTheNextExtension)return Promise.reject(new o.e(o.f.NoAvailableBrowserExtensions));var t=Object(o.Q)();return t.setItem(o.gb,e.text),t.setItem(o.bc,e.html),t})}function be(e){return!!(e&&e.setData&&e.getData)}function he(e){if(e){var t=void 0;try{t=e.clipboardData}catch(e){throw Object(o.cc)().ULS.traceTag(595985224,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: "+n.utils.getStringifiedError(e)),e}return t}Object(o.cc)().ULS.traceTag(596456320,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"A clipboard event parameter is missing")}function Se(e,t,r,a){var i=!1;try{var s=he(r);if(!s||!be(s))return Object(o.cc)().ULS.traceTag(596456264,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData - programmatic "+o.j+" and "+o.p+" is broken. There is no valid data transfer object. clipboardDataFormat = '"+e+"'"),!1;!1===(i=s.setData(e,t))&&Object(o.cc)().ULS.traceTag(596456265,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData returned false for '"+e+"'.")}catch(t){Object(o.cc)().ULS.traceTag(596456266,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData with '"+e+"' threw an exception: "+n.utils.getStringifiedError(t))}return void 0===i&&(i=!0),i}function Ce(e,t,r,a){if(ae(),!a&&!Y()&&!ee())return Object(o.cc)().ULS.traceTag(596456269,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData - programmatic "+o.j+" and "+o.p+" clipboard access is not supported. rawEvent is empty = "+!!r),!1;var i=re();if(!i||!be(i))return Object(o.cc)().ULS.traceTag(596456270,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData - "+o.j+" and "+o.p+" is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '"+e+"'"),a||(Object(o.cc)().ULS.shipAssertTag(596456271,n.LogCategory.msoulscat_ES_EWAJS,Y()&&ee(),"setData - programmatic "+o.j+" and "+o.p+" is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '"+Y()+"'. isProgrammaticAccessSupported = '"+ee()+"'. clipboardDataFormat = '"+e+"'"),Z(),te()),!1;var s,c=e;c===o.gb&&(c=o.hb);try{!1===(s=i.setData(c,t))&&Object(o.cc)().ULS.traceTag(596456272,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData returned false for '"+c+"'.")}catch(e){Object(o.cc)().ULS.traceTag(596456273,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData with '"+c+"' threw an exception: "+e.message)}return!a&&Y()&&(Z(),!1===s&&te()),void 0===s&&(s=!0),s}function ye(){return Y()&&Ce(o.gb,o.ib,void 0,!1),!!ee()||(Object(o.cc)().ULS.traceTag(596456274,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand - programmatic clipboard access is not allowed for '"+o.j+"' and '"+o.p+"'."),!1)}var ve={execCommandCopy:function(){var e;try{e=document.execCommand(o.j,!1,null)}catch(e){Object(o.cc)().ULS.traceTag(596456262,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.j+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return void 0===e&&(e=!0),e},execCommandCut:function(){var e;try{e=document.execCommand(o.p,!1,null)}catch(e){Object(o.cc)().ULS.traceTag(596456263,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.p+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return void 0===e&&(e=!0),e},setData:Se,browserExtensionCopy:function(e){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))},defaultClipboardDataFormat:o.gb},Ee={execCommandCopy:function(){if(ae(),!ye())return!1;try{document.execCommand(o.j,!1,null)}catch(e){Object(o.cc)().ULS.traceTag(596456267,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.j+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!0},execCommandCut:function(){if(ae(),!ye())return!1;try{document.execCommand(o.p,!1,null)}catch(e){Object(o.cc)().ULS.traceTag(596456268,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.p+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!0},setData:Ce,browserExtensionCopy:function(e){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))},defaultClipboardDataFormat:o.hb},we={execCommandCopy:function(){var e=!1;try{void 0===(e=document.execCommand(o.j,!1,null))&&(e=!0)}catch(e){Object(o.cc)().ULS.traceTag(596455647,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: document.execCommand('"+o.j+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return e},execCommandCut:function(){var e=!1;try{void 0===(e=document.execCommand(o.p,!1,null))&&(e=!0)}catch(e){Object(o.cc)().ULS.traceTag(596455648,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: document.execCommand('"+o.p+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return e},setData:function(e,t,r,a){var i=!1;try{var s=he(r);if(!s||!be(s))return Object(o.cc)().ULS.traceTag(596455649,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Chrome: setData - programmatic "+o.j+" and "+o.p+" is broken. There is no valid data transfer object. clipboardDataFormat = '"+e+"'"),!1;void 0===(i=s.setData(e,t))?i=!0:i||Object(o.cc)().ULS.traceTag(596455650,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: setData returned false for '"+e+"'.")}catch(t){Object(o.cc)().ULS.traceTag(596455651,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Chrome: setData with '"+e+"' threw an exception: "+n.utils.getStringifiedError(t))}return i},browserExtensionCopy:function(e){return fe(e)},defaultClipboardDataFormat:o.gb},Le=void 0;function Te(e,t,r,a){return _e().setData(e,t,r,a)}function _e(){return void 0===Le&&(Le=ue()?we:ve),Le}function Ie(e){if(!e||!e.items)return Promise.reject(new o.G(o.H.ClipboardIsInaccessible,"getImageDataUrlFromClipboardData: clipboardData is undefined="+!e+" clipboardData.items is undefined="+!e.items));for(var t=function(t){if("file"===e.items[t].kind){var r=n.perfWatch.start("ImageFile_Read_From_Clipboard"),a=e.items[t].getAsFile(),i=a?a.size:-1,s=Object(o.U)(),c=new FileReader;return c.onload=function(){c.result?(n.perfWatch.success(r,function(e){return Object(o.cc)().ULS.traceTag(595911452,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,Pe(e,i))}),s.resolve(c.result.toString())):(n.perfWatch.failure(r,function(e){return Object(o.cc)().ULS.traceTag(595911453,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,Pe(e,i))}),s.reject(new o.G(o.H.FileReaderResultIsEmpty,"getImageDataUrlFromClipboardData: FileReader result is null or undefined")))},c.onerror=function(){n.perfWatch.failure(r,function(e){return Object(o.cc)().ULS.traceTag(595911454,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,Pe(e,i))}),s.reject(new o.G(o.H.FileReaderFailed,"getImageDataUrlFromClipboardData: FileReader failed"))},n.perfWatch.mark(r,"Starting_readAsDataURL"),c.readAsDataURL(a),{value:s.promise}}},r=0;r<e.items.length;r+=1){var a=t(r);if("object"==typeof a)return a.value}return Promise.resolve(o.ib)}function Pe(e,t){var r=JSON.parse(e);return r.filesize=t,JSON.stringify(r)}function Oe(e,t,r){if(ae(),!r&&!Y()&&!ee())return Object(o.cc)().ULS.traceTag(596456327,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData - programmatic "+o.D+" clipboard access is not supported. rawEvent is empty = "+!!t),Promise.resolve(o.ib);var a=re();if(!a||!be(a))return Object(o.cc)().ULS.traceTag(596456328,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"getData - "+o.D+" is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '"+e+"'"),r||(Object(o.cc)().ULS.shipAssertTag(596456329,n.LogCategory.msoulscat_ES_EWAJS,Y()&&ee(),"getData - programmatic "+o.D+" is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '"+Y()+"'. isProgrammaticAccessSupported = '"+ee()+"'. clipboardDataFormat = '"+e+"'"),Z(),te()),Promise.resolve(o.ib);var i=e;i===o.gb&&(i=o.hb);var s=o.ib;try{(s=a.getData(i))||(s=o.ib),Object(o.cc)().ULS.traceTag(596456330,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData('"+i+"') returned "+s.length+" characters")}catch(e){Object(o.cc)().ULS.traceTag(596456331,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData with '"+i+"' threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}if(!r&&Y()&&(Z(),s===o.ib)){if(Se(e,o.Ub,void 0))return Oe(e,void 0,!1).then(function(t){return t===o.ib?te():Se(e,o.ib,void 0),Promise.resolve(s)});te()}return Promise.resolve(s)}Object(o.Kb)()&&(Le=Ee);var Ae={execCommandPaste:function(){var e;try{e=document.execCommand(o.D,!1,null)}catch(e){Object(o.cc)().ULS.traceTag(596456322,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.D+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return void 0===e&&(e=!0),e},getData:function(e,t,r){var a=o.ib;try{var i=he(t);if(!i||!be(i))return Promise.resolve(a);if(e===o.Bb)return Ie(i);(a=i.getData(e))||(a=o.ib),Object(o.cc)().ULS.traceTag(596456323,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData('"+e+"') returned "+a.length+" characters")}catch(t){Object(o.cc)().ULS.traceTag(596456324,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"getData with '"+e+"' threw an exception. This is a browser bug. Ignoring. Exception:: "+n.utils.getStringifiedError(t))}return Promise.resolve(a)},browserExtensionPaste:function(){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))}},xe={execCommandPaste:function(){if(ae(),Y()&&Oe(o.gb,void 0,!1),!ee())return Object(o.cc)().ULS.traceTag(596456325,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand - programmatic clipboard '"+o.D+"' access is not allowed in this session."),!1;try{document.execCommand(o.D,!1,null)}catch(e){Object(o.cc)().ULS.traceTag(596456326,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('"+o.D+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!0},getData:Oe,browserExtensionPaste:function(){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))}},je={execCommandPaste:function(){var e=!1;try{void 0===(e=document.execCommand(o.D,!1,null))&&(e=!0)}catch(e){Object(o.cc)().ULS.traceTag(596455698,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: document.execCommand('"+o.D+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return e},getData:function(e,t,r){var a=o.ib;try{var i=he(t);if(!i||!be(i))return Promise.resolve(a);if(e===o.Bb)return Ie(i);(a=i.getData(e))||(a=o.ib),Object(o.cc)().ULS.traceTag(596455699,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: getData('"+e+"') returned "+a.length+" characters")}catch(t){Object(o.cc)().ULS.traceTag(596455700,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Chrome: getData with '"+e+"' threw an exception. This is a browser bug. Ignoring. Exception:: "+n.utils.getStringifiedError(t))}return Promise.resolve(a)},browserExtensionPaste:function(){return me()}},De=void 0;function Me(){return void 0===De&&(De=ue()?je:Ae),De}Object(o.Kb)()&&(De=xe);var We="ccpContentEditable",Ue="div";function Re(){var e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function Je(e,t,r){void 0===r&&(r=void 0),Object(o.cc)().ULS.shipAssertTag(596444114,n.LogCategory.msoulscat_ES_EWAJS,!1===t&&!r||!0===t&&(!!r||r===o.ib),"enableClipboardEvents: useTextHtmlContentCandidate = '"+t+"', textHtmlContentCandidate is "+(r||r===o.ib?o.ib:"not ")+"provided");var a=document.activeElement&&document.activeElement.id;a||Object(o.cc)().ULS.traceTag(595719625,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"hiddenContentEditableDiv.enableClipboardEvents: activeElementIdToRestore must to be define");var i=function(e,t){var r=ze();r&&r.tagName&&r.tagName.toLowerCase()!==Ue&&(r.parentElement&&r.parentElement.removeChild(r),r=void 0);r||(r=function(){var e=document.createElement(Ue);return function(e){e.id=We,e.contentEditable="true",ke()&&(e.contentEditable="false");e.spellcheck=!1,e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.display="inline-block",e.style.position="absolute",e.style.fontSize="10",e.style.height="0px",e.style.width="0px",e.style.top="0px",e.style.left="0px",e.style.zIndex="-100",e.style.overflow="hidden",e.onmousemove=function(){e.onmousemove=null,Object(o.cc)().ULS.assertTag(595957699,n.LogCategory.msoulscat_ES_EWAJS,!1,"contentEditableElement.onmousemove: Mouse move event is not expected on element '"+We+"'. it should be covered by other elements")}}(e),document.body.appendChild(e),e}());var a=t;e?a||(a=o.ib):a=(i=document.createElement("span"),i.innerText=o.Tb,i).outerHTML;var i;return r.innerHTML=a,r}(t,r);a&&a===i.id&&(a=void 0),i.focus();var s=document.getSelection();if(s){s.removeAllRanges();var c=document.createRange();c.selectNodeContents(i),s.addRange(c)}return e&&Fe(!0),a}function Fe(e){if(ke()){var t=ze();t&&(t.contentEditable=e?"true":"false")}}function Ne(){var e=ze();if(!e)return!1;try{var t=e.clientLeft+e.scrollWidth/2,r=e.clientTop+e.scrollTop/2,a=document.elementFromPoint(t,r);return!!a&&(a.id===e.id||!!a.parentElement&&a.parentElement.id===e.id)}catch(e){return Object(o.cc)().ULS.traceTag(595957534,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"isContentEditableElementVisibleToUser: hit test failed with error: "+n.utils.getStringifiedError(e)),!1}}function ze(){return document.getElementById(We)}function ke(){return Object(n.ewaUtils)().isChangeGateEnabled("OfficeVSO:3327534_CCP_ContentEditableDiv_ReadOnlyByDefault_WithoutIE")&&!Object(o.Kb)()}var He=function(){function e(){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.clipboardStorageType=o.g.SystemClipboard,this.disposableImplementationExtension=Object(o.W)("SystemClipboardStorage")}return e.prototype.get=function(e){var t=this;if(this.disposableImplementationExtension.throwIfDisposed("get"),Object(o.cc)().ULS.traceTag(596449096,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.get: isKeyboardEvent = '"+e.isKeyboardEvent+"'"),e.skipSystemClipboardAccess){Object(o.cc)().ULS.traceTag(596124883,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.get: Skipping system clipboard access");var r=Object(o.O)(document,o.E,function(e){return t.skipSystemClipboardPasteHandler(e,r)},!0);return this.removeLastPasteEventListenerCallback=r,Promise.resolve(Object(o.rb)())}if(Object(o.hc)(e.userHash),this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){var a=this.lastDeferredPastePromise,i="There exists a pending deferred promise with id '"+a.id+"', representing an active "+o.D+" event. Scheduling a rejection to execute after the current operation.";Object(o.cc)().ULS.traceTag(596455680,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i),window.setTimeout(function(){a.reject(new o.e(o.f.RejectingPendingPastePromiseDueToNewPasteOperation,i))},0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);var s=Object(o.U)();this.lastDeferredPastePromise=s;var c=s.id,l=Object(o.O)(document,o.E,function(r){return t.pasteHandler(r,s,e.isKeyboardEvent,l)},!0);this.removeLastPasteEventListenerCallback=l,this.selectedRangeToRestore=Re(),this.activeElementIdToRestore=Je(!0,!1);try{var d=!1;if(Object(o.Kb)()&&e.isKeyboardEvent||(d=Me().execCommandPaste()),e.isKeyboardEvent);else if(!d)return this.clearPasteCallbackConfiguration(s,!0,!0),Me().browserExtensionPaste().then(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r},function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Promise.reject(new o.e(o.f.ClipboardIsInaccessible,"document.execCommand("+o.D+") failed in SystemClipboard.get. Deferred promise id = '"+c+"'",r))})}catch(e){return this.clearPasteCallbackConfiguration(s,!0,!1),Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '"+c+"'",e))}return s.promise.then(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r},function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Object(o.Fb)(r,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(r):Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '"+c+"'",r))})},e.prototype.set=function(t,r){var a=this;if(this.disposableImplementationExtension.throwIfDisposed("set"),Object(o.cc)().ULS.traceTag(596449097,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.set: isKeyboardEvent = '"+r.isKeyboardEvent+"'; cutCopyPasteFlags = '"+r.commandType+"'"),Object(o.cc)().ULS.shipAssertTag(595932513,n.LogCategory.msoulscat_ES_EWAJS,!r.skipSystemClipboardAccess,"SystemClipboardStorage.set: skipSystemClipboardAccess shouldn't be used using set of SystemClipboardStorage as we have to set the timestamp metadata in the html in order to support last copy item scenario. "),Object(o.mb)(t)>0&&Object(o.hc)(r.userHash),Object(o.Kb)()&&!r.isKeyboardEvent){if(r.silentClipboardAccessFailures&&Y())return Object(o.cc)().ULS.traceTag(596455681,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Promise.resolve();if(!Y()&&!ee())return Object(o.cc)().ULS.traceTag(596455682,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){var i=this.lastDeferredCutCopyPromise,s="There exists a pending deferred promise with id '"+i.id+"', representing an active "+o.p+"/"+o.j+" event. Scheduling a rejection to execute after the current operation.";Object(o.cc)().ULS.traceTag(596455683,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,s),window.setTimeout(function(){i.reject(new o.e(r.isKeyboardEvent?o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:o.f.RejectingBlockedSyncCutCopyPromise,s))},0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);var c=Object(o.U)();this.lastDeferredCutCopyPromise=c;var l,d=c.id;try{var u=Object(o.sb)(t),g=e.getClipboardCutCopyEventType(r.commandType),p=Object(o.O)(document,g,function(e){r.isTimestampStoredInSystemClipboard=!0,a.cutCopyHandler(e,c,u,r.isKeyboardEvent,r.commandType,p)});this.removeLastCutCopyEventListenerCallback=p;var f=o.ib;Object(o.Kb)()&&(f=Object(o.kb)(u,o.bc)),this.selectedRangeToRestore=Re(),this.activeElementIdToRestore=Je(!1,!!f,f);var m=!1;if(Object(o.Kb)()&&r.isKeyboardEvent||(m=r.commandType===o.r.Cut?_e().execCommandCut():_e().execCommandCopy()),r.isKeyboardEvent);else if(!m)return this.clearCutCopyCallbackConfiguration(c,!0,!0),!Object(o.Kb)()||Y()||ee()?(l=t.getData(),_e().browserExtensionCopy(l)).then(function(){r.isTimestampStoredInSystemClipboard=!0,c.resolve()},function(e){return c.resolve(),r.silentClipboardAccessFailures?(Object(o.cc)().ULS.traceTag(596455685,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Failed to programmatically clear/set the clipboard via a browser extension. silentClipboardAccessFailures is on. Deferred promise id = '"+d+"'. Error: "+n.utils.getStringifiedError(e)),Promise.resolve()):Promise.reject(new o.e(o.f.ClipboardIsInaccessible,"browserExtensionCopy for '"+(r.commandType===o.r.Cut?o.p:o.j)+"' failed in SystemClipboard.set. Deferred promise id = '"+d+"'",e))}):(Object(o.cc)().ULS.traceTag(596455684,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '"+d+"'"),c.resolve(),Promise.resolve())}catch(e){return this.clearCutCopyCallbackConfiguration(c,!0,!1),Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '"+d+"'",e))}return c.promise.catch(function(e){return e&&Object(o.Gb)(e,[o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,o.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '"+d+"'",e))})},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.gb,o.bc,o.Bb]},e.prototype.cutCopyHandler=function(e,t,r,a,i,s){var c=this;try{if(Object(o.cc)().ULS.traceTag(596449098,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '"+a+"'; cutCopyPasteFlags = '"+i+"'; bubbles = '"+e.bubbles+"'; eventPhase = '"+e.eventPhase+"'"),s(),this.removeLastCutCopyEventListenerCallback===s&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(Object(o.cc)().ULS.shipAssertTag(596455686,n.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '"+a+"'; cutCopyPasteFlags = '"+i+"'"),!t)return;if(Object(o.cc)().ULS.traceTag(596455687,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '"+a+"'; cutCopyPasteFlags = '"+i+"'; deferred promise id = '"+t.id+"'"),Object(o.cc)().ULS.shipAssertTag(596455688,n.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.cutCopyHandler: deferred promise '"+t.id+"' is already fulfilled. isKeyboardEvent = '"+a+"'; cutCopyPasteFlags = '"+i+"'"),t.fulfilled())return;var l=function(){t.resolve(),c.clearCutCopyCallbackConfiguration(t,!1,!1)},d=Object(o.kb)(r,o.bc);if(d&&Object(o.Kb)())window.setTimeout(l,0);else{d&&Te(o.bc,d,e,a);var u=Object(o.ob)(r);Te(_e().defaultClipboardDataFormat,u,e,a),e.preventDefault(),l()}}catch(e){this.clearCutCopyCallbackConfiguration(t,!1,!1),Object(o.cc)().ULS.traceTag(596455689,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.cutCopyHandler callback with deferred promise id '"+(t?t.id:o.ib)+"' (fulfilled = '"+(t?t.fulfilled():o.ib)+"') failed with this exception: "+(e&&e.message?e.message:"NA")+". Call stack: "+(e.stack?e.stack:"NA")),t&&t.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '"+t.id+"'. Error: "+(e&&e.message?e.message:"NA"),e))}},e.prototype.pasteHandler=function(e,t,r,a){var i=this,s=!0;try{if(Object(o.cc)().ULS.traceTag(596449099,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '"+r+"'; eventPhase='"+e.eventPhase+"'"),a(),this.removeLastPasteEventListenerCallback===a&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(Object(o.cc)().ULS.shipAssertTag(596455690,n.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '"+r+"'"),!t)return;if(Object(o.cc)().ULS.traceTag(596455691,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '"+r+"'; deferred promise id = '"+t.id+"'"),Object(o.cc)().ULS.shipAssertTag(596455692,n.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.pasteHandler: deferred promise '"+t.id+"' is already fulfilled. isKeyboardEvent = '"+r+"'"),t.fulfilled())return;var c=Object(o.Q)(),l=this.getSupportedDataFormats(),d=[];l.forEach(function(t){d.push(function(e,t,r){return Me().getData(e,t,r)}(t,e,r).then(function(e){c.setItem(t,e)}).catch(function(e){Object(o.cc)().ULS.traceTag(595911884,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"SystemClipboardStorage.pasteHandler: Failed to get data of type ["+t+"]. Error ["+n.utils.getStringifiedError(e)+"]")}))}),Promise.all(d).then(function(){e.stopPropagation(),s=!1,Object(o.Kb)()?window.setTimeout(function(){var e,r=document.getElementById(We);if(r&&r.firstChild&&"IMG"===r.firstChild.nodeName){var a=r.firstChild;a&&a.src&&a.src.indexOf("base64")>-1?c.setItem(o.Bb,a.src):Object(o.cc)().ULS.traceTag(595907107,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: IE has provided the IMG HTML rather than the image blob, which is unsupported.")}else c.setItem(o.bc,(e=ze(),Object(o.cc)().ULS.shipAssertTag(596444113,n.LogCategory.msoulscat_ES_EWAJS,!!e,"getTextHtmlContent: the content editable element does not exist"),e?e.innerHTML:o.ib)),o.Ab.isContainsTimestampWrapper(r)&&c.setItem(o.gb,o.Ab.createPlainTextFromHtml(r));t.resolve(c),i.clearPasteCallbackConfiguration(t,!1,!1)},0):(e.preventDefault(),t.resolve(c),i.clearPasteCallbackConfiguration(t,!1,!1))})}catch(r){try{s&&e.stopPropagation(),e.preventDefault()}catch(e){Object(o.cc)().ULS.traceTag(595985030,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: "+n.utils.getStringifiedError(e))}this.clearPasteCallbackConfiguration(t,!1,!1),Object(o.cc)().ULS.traceTag(596455693,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.pasteHandler callback with deferred promise id '"+(t?t.id:o.ib)+"' (fulfilled = '"+(t?t.fulfilled():o.ib)+"') failed with an exception: "+(r&&r.message?r.message:"NA")+". Call stack: "+(r.stack?r.stack:"NA")),t&&t.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '"+t.id+"'. Error: "+(r&&r.message?r.message:"NA"),r))}},e.prototype.skipSystemClipboardPasteHandler=function(e,t){try{t(),e.stopPropagation(),e.preventDefault()}catch(e){Object(o.cc)().ULS.traceTag(595993058,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: "+(e&&e.message?e.message:"NA")+". Call stack: "+(e.stack?e.stack:"NA"))}this.removeLastPasteEventListenerCallback===t&&(this.removeLastPasteEventListenerCallback=void 0)},e.prototype.hasPlainText=function(e){return!!e&&Object.keys(e.getData().items).indexOf(o.gb)>-1},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.Yb)([function(){e.lastDeferredCutCopyPromise&&!e.lastDeferredCutCopyPromise.fulfilled()&&(e.lastDeferredCutCopyPromise.reject(),e.lastDeferredCutCopyPromise=void 0,e.removeLastCutCopyEventListenerCallback&&(e.removeLastCutCopyEventListenerCallback(),e.removeLastCutCopyEventListenerCallback=void 0))},function(){e.lastDeferredPastePromise&&!e.lastDeferredPastePromise.fulfilled()&&(e.lastDeferredPastePromise.reject(),e.lastDeferredPastePromise=void 0,e.removeLastPasteEventListenerCallback&&(e.removeLastPasteEventListenerCallback(),e.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())},e.getClipboardCutCopyEventType=function(e){if(!e)return o.k;if(e===o.r.Copy)return o.k;if(e===o.r.Cut)return o.q;throw new o.t(o.ib,"cutCopyPasteFlags",e.toString())},e.prototype.restoreFocusToPreviouslyActiveElement=function(){if(this.activeElementIdToRestore){var e=document.getElementById(this.activeElementIdToRestore);e&&e.focus()}},e.prototype.restoreSelection=function(){this.selectedRangeToRestore&&(!function(e){if(void 0===e&&(e=void 0),e){var t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)},e.prototype.clearCutCopyCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Object(o.cc)().ULS.shipAssertTag(595957697,n.LogCategory.msoulscat_ES_EWAJS,!Ne(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),e===this.lastDeferredCutCopyPromise?this.lastDeferredCutCopyPromise=void 0:e&&this.lastDeferredCutCopyPromise&&e.id===this.lastDeferredCutCopyPromise.id&&(this.lastDeferredCutCopyPromise=void 0),t&&this.removeLastCutCopyEventListenerCallback&&(r||Object(o.cc)().ULS.traceTag(596449290,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.set: the "+o.p+"/"+o.j+" event listener was not called. Calling removeLastCutCopyEventListenerCallback()"),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)},e.prototype.clearPasteCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Fe(!1),Object(o.cc)().ULS.shipAssertTag(595957698,n.LogCategory.msoulscat_ES_EWAJS,!Ne(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),e===this.lastDeferredPastePromise?this.lastDeferredPastePromise=void 0:e&&this.lastDeferredPastePromise&&e.id===this.lastDeferredPastePromise.id&&(this.lastDeferredPastePromise=void 0),t&&this.removeLastPasteEventListenerCallback&&(r||Object(o.cc)().ULS.traceTag(596449291,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.get: the "+o.D+" event listener was not called. Calling removeLastPasteEventListenerCallback()"),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)},e.prototype.clearSystemClipboard=function(){var e=Object(o.rb)(),t={isKeyboardEvent:!1,commandType:o.r.Copy};this.set(e,t).then(function(){Object(o.cc)().ULS.traceTag(595935906,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard succeed")},function(){Object(o.cc)().ULS.traceTag(595935907,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard failed")})},e}(),Ve=function(e){function t(t){return e.call(this,o.i.InMemory,{browserStorage:!1,systemClipboard:!1,inMemory:!0},t)||this}return c.__extends(t,e),t}(o.h),Be=function(){function e(){this.clipboardStorageType=o.g.InMemory,this.disposableImplementationExtension=Object(o.W)("InMemoryClipboardStorage")}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.disposableImplementationExtension.dispose())},e.prototype.get=function(e){return this.disposableImplementationExtension.throwIfDisposed("get"),this.inMemoryClipboardItems?Promise.resolve(this.inMemoryClipboardItems):Promise.resolve(Object(o.rb)())},e.prototype.set=function(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),this.inMemoryClipboardItems=e,Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.gb,o.bc,"data/shadow-workbook"]},e}(),Ke=function(e){function t(t){return e.call(this,o.i.IndexedDB,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return c.__extends(t,e),t}(o.h),Ge=function(e){function t(t){return e.call(this,o.i.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return c.__extends(t,e),t}(o.h),Qe=function(){function e(e,t,r,a){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this._fullAccessClipboardStrategyType=r,this.dualClipboardDataProcessor=a,this.initialized=!1,this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.disposableImplementationExtension=Object(o.W)(""+e)}return e.prototype.initialize=function(e,t){var r=this;return this.initialized=!1,this.systemClipboardStrategy=void 0,this.fullAccessClipboardStrategy=void 0,e.then(function(e){return r.systemClipboardStrategy=e,t.then(function(e){return r.fullAccessClipboardStrategy=e,r.initialized=!0,Promise.resolve(r)})})},e.prototype.set=function(e,t){var r=this;try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized));var a={systemClipboardOperationResult:Object(o.S)(o.Tb,"setresult",!1),fullAccessClipboardOperationResult:Object(o.S)(o.Tb,"setresult",!1)};return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.preSetProcess(e),this.systemClipboardStrategy.set(e,t).then(function(){return Promise.resolve(a)},function(e){return a.systemClipboardOperationResult.failed=!0,a.systemClipboardOperationResult.clipboardOperationResultError=e,Object(o.Gb)(e,[o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,o.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(a)}).then(function(a){return r.fullAccessClipboardStrategy?r.fullAccessClipboardStrategy.set(e,t).then(function(){return Promise.resolve(a)},function(e){return Object(o.cc)().ULS.traceTag(595933078,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Failed to save to fullAccessClipboardStrategy. clipboardStrategyType: '"+(r.fullAccessClipboardStrategy&&r.fullAccessClipboardStrategy.clipboardStrategyType)+"', Command Id: '"+(t.id?t.id:o.ib)+"', Error: "+n.utils.getStringifiedError(e)),a.fullAccessClipboardOperationResult.failed=!0,a.fullAccessClipboardOperationResult.clipboardOperationResultError=e,Promise.resolve(a)}):(a.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(a))}).then(function(e){if(e.systemClipboardOperationResult.failed&&e.fullAccessClipboardOperationResult.failed){var t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new o.e(o.f.SetClipboardItems,o.ib))}return Promise.resolve()})}catch(e){return Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in system clipboard.set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized));var r={systemClipboardOperationResult:Object(o.S)(o.Tb,"getresult",!1,void 0,Object(o.pb)()),fullAccessClipboardOperationResult:Object(o.S)(o.Tb,"getresult",!1,void 0,Object(o.pb)())};return this.systemClipboardStrategy.get(e).then(function(e){return r.systemClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.systemClipboardOperationResult),Promise.resolve(r)}).catch(function(e){return r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResult.clipboardOperationResultError=e,Object(o.Fb)(e,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(e):Promise.resolve(r)}).then(function(r){return t.fullAccessClipboardStrategy?t.fullAccessClipboardStrategy.get(e).then(function(e){return r.fullAccessClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.fullAccessClipboardOperationResult),Promise.resolve(r)}).catch(function(a){return Object(o.cc)().ULS.traceTag(595933079,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Failed to get from fullAccessClipboardStrategy. clipboardStrategyType: '"+(t.fullAccessClipboardStrategy&&t.fullAccessClipboardStrategy.clipboardStrategyType)+"', Command Id: '"+(e.id?e.id:o.ib)+"', Error: "+n.utils.getStringifiedError(a)),r.fullAccessClipboardOperationResult.failed=!0,r.fullAccessClipboardOperationResult.clipboardOperationResultError=a,Promise.resolve(r)}):(r.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(r))}).then(function(r){if(r.systemClipboardOperationResult.failed||e.skipSystemClipboardAccess){if(r.fullAccessClipboardOperationResult.failed){var a=r.systemClipboardOperationResult.clipboardOperationResultError;return a||(a=r.fullAccessClipboardOperationResult.clipboardOperationResultError),a?Promise.reject(a):Promise.reject(new o.e(o.f.GetClipboardItems,o.ib))}return 0===Object(o.nb)(r.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.reject(r.systemClipboardOperationResult.clipboardOperationResultError):t.validateAndReturnFullAccessData(r)}return r.fullAccessClipboardOperationResult.failed?Promise.resolve(Object(o.Q)(r.systemClipboardOperationResult.clipboardItemsData)):function(){if(Object(o.Hb)()&&!Object(o.Jb)())return!0;return!1}()?t.pasteSourceReconciliationBasedOnlyOnTextPlain(r):t.pasteSourceReconciliation(r,e)})}catch(e){return Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in system clipboard.get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.initialized?this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.onSystemClipboardChangedExternally(e):(Object(o.cc)().ULS.shipAssertTag(595882509,n.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.fullAccessClipboardStrategy should be defined"),Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized))):Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized))}catch(e){return Promise.reject(new o.e(o.f.ClearClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").onSystemClipboardChangedExternally",e))}},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.Yb)([function(){e.systemClipboardStrategy&&e.systemClipboardStrategy.dispose()},function(){e.fullAccessClipboardStrategy&&e.fullAccessClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.pasteSourceReconciliation=function(e,t){var r=void 0;e.systemClipboardOperationResult.signatureData&&(r=e.systemClipboardOperationResult.signatureData.ccp_infra_timestamp);var a=void 0;return e.fullAccessClipboardOperationResult.signatureData&&(a=e.fullAccessClipboardOperationResult.signatureData.ccp_infra_timestamp),Object(o.cc)().ULS.traceTag(595719624,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"systemClipboardAndFullAccessClipboardStrategy.pasteSourceReconciliation: ccpTimestampInSystemClipboard="+r+" ccpTimestampInFullAccessClipboard="+a),r?r>(a||0)?(qe(e.systemClipboardOperationResult.clipboardItemsData,!0),Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(Object(o.Q)(e.fullAccessClipboardOperationResult.clipboardItemsData)):t.isTimestampStoredInSystemClipboard?(qe(e.systemClipboardOperationResult.clipboardItemsData,!1),Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData))):this.validateAndReturnFullAccessData(e)},e.prototype.validateAndReturnFullAccessData=function(e){return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.validateUserHash(e.fullAccessClipboardOperationResult.signatureData),Promise.resolve(Object(o.Q)(e.fullAccessClipboardOperationResult.clipboardItemsData))},e.prototype.pasteSourceReconciliationBasedOnlyOnTextPlain=function(e){if(0===Object(o.nb)(e.systemClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData));if(0===Object(o.nb)(e.fullAccessClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData));var t=e.systemClipboardOperationResult.clipboardItemsData.items[o.gb],r=o.Ab.ensureOneLFPerNewLine(o.Ab.trimToLength(t)),a=e.fullAccessClipboardOperationResult.clipboardItemsData.items[o.gb];return r===o.Ab.ensureOneLFPerNewLine(o.Ab.trimToLength(a))?Promise.resolve(Object(o.Q)(e.fullAccessClipboardOperationResult.clipboardItemsData)):r===at().getCopyToClipboardLatencyMessage()?this.validateAndReturnFullAccessData(e):(e.systemClipboardOperationResult.clipboardItemsData.items[o.Pb]=o.Rb,Promise.resolve(Object(o.Q)(e.systemClipboardOperationResult.clipboardItemsData)))},e}();function qe(e,t){e.items[o.Pb]=o.Rb,t&&(e.items[o.Qb]=o.Sb)}var Xe=function(e){function t(t){return e.call(this,o.i.SystemClipboardAndIndexedDB,{browserStorage:!0,systemClipboard:!0,inMemory:!1},o.i.IndexedDB,t)||this}return c.__extends(t,e),t}(Qe),Ye=function(e){function t(t){return e.call(this,o.i.SystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},o.i.LocalStorage,t)||this}return c.__extends(t,e),t}(Qe),Ze=function(e){function t(t){return e.call(this,o.i.SystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},o.i.InMemory,t)||this}return c.__extends(t,e),t}(Qe),$e=function(e){function t(t,r){var a=e.call(this)||this;if(a.messageDestination=r,!r)throw new o.B(o.ib,"messageDestination");return a.clipboardStorageType=t,a.disposableImplementationExtension=Object(o.W)(r),a}return c.__extends(t,e),t.prototype.initialize=function(){var e=this;return this.innerInitialize().then(function(){return e})},t.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),Object(o.cc)().ULS.traceTag(595947538,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardStorageIframeProxy.get: isKeyboardEvent = "+e.isKeyboardEvent+"; silentClipboardAccessFailures = "+(e.silentClipboardAccessFailures||!1)),Object(o.hc)(e.userHash);var t=Object(o.R)(Object(o.ab)(),"get",this.messageDestination,e.userHash);return this.postMessage(t,"get").then(function(e){return e.clipboardItemsData?Promise.resolve(Object(o.Q)(e.clipboardItemsData)):Promise.resolve(Object(o.rb)())})},t.prototype.set=function(e,t){var r;return this.disposableImplementationExtension.throwIfDisposed("set"),Object(o.cc)().ULS.traceTag(595947541,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardStorageIframeProxy.set: isKeyboardEvent = "+t.isKeyboardEvent+"; silentClipboardAccessFailures = "+(t.silentClipboardAccessFailures||!1)),Object(o.mb)(e)>0?(Object(o.hc)(t.userHash),r=Object(o.R)(Object(o.ab)(),"set",this.messageDestination,t.userHash,e.getData())):r=Object(o.R)(Object(o.ab)(),"set",this.messageDestination),this.postMessage(r,"set").then(function(){})},t.prototype.clearClipboardNecessary=function(e,t){return Object(o.ac)(e,t)},t.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.gb,o.bc,"data/shadow-workbook"]},t.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},t}(K);var et=function(e){function t(t){return e.call(this,o.g.IndexedDB,t)||this}return c.__extends(t,e),t.prototype.initialize=function(){return n.idbPromised.getDbFactory()?e.prototype.initialize.call(this):Promise.reject(new o.e(o.f.IndexedDBProviderNotSupported))},t}($e),tt=function(e){function t(t){return e.call(this,o.g.LocalStorage,t)||this}return c.__extends(t,e),t}($e);function rt(e,t,r,a,s){var c=function(e,t,r){return new T(e,t,r)}(r,a,s);return function(e,t,r){var a=o.s.NoError;return n.utils.chainFallbackPromises(e,function(e){return function(e,t,r){Object(o.cc)().ULS.traceTag(595716231,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Attempting to create clipboard strategy type '"+e.clipboardStrategyType+"'");var a=function(e){return r.createClipboardDataProcessor(e)},s=function(){return r.createClipboardMetaDataProcessor()},c=function(e){return r.createDualClipboardDataProcessor(e)},l=function(){return new Q},d=function(e){return function(e){return new G(e)}(e)},u=function(){var t=e;return t.useSharedClipboardIframe?l():d(Object(o.vb)(t.sharedClipboardSchemaVersion))},p=function(){return(new q).initialize(Promise.resolve(new He))},f=function(e){return function(e){return new Ve(e)}(e).initialize(Promise.resolve(new Be))},m=function(e){return function(e){return new Ke(e)}(e).initialize((t=o.z.indexedDBData,new et(t)).initialize());var t},b=function(t,r){var a,n,s=e;return s.useSharedClipboardIframe?(function(e){var t={};e.wacCluster&&(t.wacCluster=e.wacCluster.trim()),e.sessionId&&(t.sessionId=e.sessionId);var r=e.sharedClipboardOverrideOrigin?1:0;o.Zb.initializeSharedClipboardSettings({sharedClipboardHostingApp:e.sharedClipboardHostingApp,sharedClipboardHostingApps:e.sharedClipboardHostingApps,sharedClipboardHostingEnvironments:e.sharedClipboardHostingEnvironments,sharedClipboardSchemaVersion:e.sharedClipboardSchemaVersion,sharedClipboardExpirationInMinutes:e.sharedClipboardExpirationInMinutes,clipboardPromiseTimeoutInMinutes:e.sharedClipboardExpirationInMinutes,whitelistOriginComponents:r}),i(t)}(s),function(e){return new Ge(e)}(r).initialize((a=t?o.z.localStorageMetadata:o.z.localStorageData,new tt(a)).initialize())):function(e){return new o.x(e)}(r).initialize(Promise.resolve((n=t?Object(o.ub)(s.sharedClipboardSchemaVersion):Object(o.tb)(s.sharedClipboardSchemaVersion),new o.w(n))))},h=function(e,r,a){return Promise.all([e,r]).then(function(e){var r=e[0];return function(e,r){return(r?r.initialize(e):Promise.resolve(void 0)).then(function(){return g(e,t,r)})}(e[1],a).then(function(e){return{dataClipboardStrategy:r,metadataManager:e}})})};try{switch(e.clipboardStrategyType){case o.i.SystemClipboard:return h(p(),f(s()));case o.i.IndexedDB:return h(m(a(!0)),m(s()),u());case o.i.InMemory:return h(f(a(!1)),f(s()));case o.i.LocalStorage:return h(b(!1,a(!0)),b(!0,s()),u());case o.i.SystemClipboardAndIndexedDB:return h((S=c(!0),new Xe(S)).initialize(p(),m()),m(s()),u());case o.i.SystemClipboardAndLocalStorage:return h(function(){return(e=c(!0),new Ye(e)).initialize(p(),b(!1));var e}(),b(!0,s()),u());case o.i.SystemClipboardAndInMemory:return h(function(){return(e=c(!1),new Ze(e)).initialize(p(),f());var e}(),f(s()))}return Promise.reject(new o.e(o.f.UnsupportedClipboardStrategyType,"Clipboard strategy type '"+e.clipboardStrategyType+"' is not supported"))}catch(t){return Promise.reject(new o.e(o.f.UnsupportedClipboardStrategyType,"failed to create clipboardStrategyType: '"+e.clipboardStrategyType+"' with error: "+n.utils.getStringifiedError(t)))}var S}(e,t,r).then(function(t){return Object(o.cc)().ULS.traceTag(595716294,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Clipboard strategy type '"+e.clipboardStrategyType+"' was created."),t.infraInitializationError=a,t}).catch(function(t){if(t&&t.innerError&&"string"==typeof t.innerError)try{JSON.parse(t.innerError).reason===o.f.LocalStorageInitilizationInaccessible&&(a=o.s.LocalStorageInaccessible)}catch(e){}var r="clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: selectClipboardStrategy: failed to create clipboard strategy type '"+e.clipboardStrategyType+"'. Error: "+n.utils.getStringifiedError(t);return Object(o.cc)().ULS.traceTag(595716230,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,r),Promise.reject(new o.e(o.f.SelectClipboardStrategy,r,t))})})}(e,t,c).then(function(e){return{dataClipboardStrategy:e.dataClipboardStrategy,clipboardDataManager:c,metadataManager:e.metadataManager,infraInitializationError:e.infraInitializationError}})}function at(){return it}var ot;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.StateReady=1]="StateReady",e[e.InitializationSucceed=2]="InitializationSucceed"}(ot||(ot={}));var nt={initializationStatus:ot.NotInitialized,stateInitialized:!1,clipboardStrategy:void 0,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:o.Zb.defaultPromiseTimeoutInMinutes,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",metadataManager:void 0,clipboardDataManager:void 0,initializationError:o.s.NoError},it={init:function(e,t,r,a,i,s,c,l,d,u,g,p,f,m,b,h,S,C){if(nt.lastClipboardPlatformEnvironmentInitializationInfo)return Promise.resolve(nt.lastClipboardPlatformEnvironmentInitializationInfo);e&&Object(n.initEwaUtils)(e);if(Object(o.Db)(t),!r||!Array.isArray(r))return Promise.reject(new o.B(o.ib,"chromeExtensionIds"));Object(o.cc)().ULS.traceTag(596455702,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardPlatformEnvironment.init: chromeExtensionIds = '"+JSON.stringify(r)+"'"),nt.chromeExtensionIds=lt(r),g&&(nt.copyToClipboardLatencyMessage=g);"number"!=typeof u||isNaN(u)||(nt.clipboardPromiseTimeoutInMinutes=u);return nt.initializationStatus=ot.StateReady,rt(m,f,b,h,S).then(function(e){return nt.clipboardDataManager=e.clipboardDataManager,nt.metadataManager=e.metadataManager,nt.clipboardStrategy=e.dataClipboardStrategy,nt.initializationError=e.infraInitializationError,nt.initializationStatus=ot.InitializationSucceed,nt.lastClipboardPlatformEnvironmentInitializationInfo={clipboardStrategiesToInitialize:m,dataClipboardCapabilities:nt.clipboardStrategy&&nt.clipboardStrategy.clipboardCapabilities,dataClipboardStrategyType:nt.clipboardStrategy&&nt.clipboardStrategy.clipboardStrategyType,infraInitializationError:nt.initializationError},nt.lastClipboardPlatformEnvironmentInitializationInfo})},getClipboardStrategy:function(){if(st(),!nt.clipboardStrategy)throw new o.u("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return nt.clipboardStrategy},getChromeExtensionIds:function(){return ct(),nt.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return ct(),nt.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return ct(),nt.copyToClipboardLatencyMessage},getMetadataManager:function(){return st(),nt.metadataManager},getClipboardDataManager:function(){return st(),nt.clipboardDataManager},getInitializationError:function(){return st(),nt.initializationError}};function st(){if(nt.initializationStatus!==ot.InitializationSucceed)throw new o.u("ClipboardPlatformEnvironment is not initialized. Call init(...).")}function ct(){if(nt.initializationStatus<ot.StateReady)throw new o.u("ClipboardPlatformEnvironment state is not ready. Call init(...).")}function lt(e){var t=[];if(!e)return t;for(var r=0,a=e;r<a.length;r++){var o=a[r];o&&"string"==typeof o&&o.trim().length>0&&t.push(o)}return t}r.d(t,"createClipboardItems",function(){return o.Q}),r.d(t,"getClipboardPlatformEnvironment",function(){return at})}});
//# sourceMappingURL=clipboardPlatform.min.js.map
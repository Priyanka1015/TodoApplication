!function(){function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var u=!1;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return r(n?n:t)},c,c.exports,t,e,n,i)}return n[a].exports}for(var o=!1,a=0;a<i.length;a++)r(i[a]);return r}return t}()({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./src/Api/Api");n.Api=i;var r=t("./src/FloodgateEngine");n.FloodgateEngine=r.FloodgateEngine},{"./src/Api/Api":5,"./src/FloodgateEngine":17}],2:[function(t,e,n){"use strict";var i=function(){function t(t){if(!t)throw new Error("trackingSet must not be null");if(t.getList().length>32)throw new Error("trackingSet list size must be less than 32");this.isOrdered=t.getIsOrdered(),this.trackedActivities=t.getList(),this.currentIndex=0,this.activationMask=0,this.currentActivationFlags=0,this.isActivationByInitPending=!1,this.currentCounts=new Array(this.trackedActivities.length),this.currentStartTimes=new Array(this.trackedActivities.length),this.currentSessionCounts=new Array(this.trackedActivities.length);for(var e=0;e<this.trackedActivities.length;e++)this.currentCounts[e]=0,this.currentSessionCounts[e]=0;for(var e=0;e<this.trackedActivities.length;e++)this.activationMask|=1<<e,this.trackedActivities[e].getCount()<1&&this.trackedActivities[e].setCount(1)}return t.prototype.getCount=function(t){return this.isValidIndex(t)?this.currentCounts[t]:0},t.prototype.getSessionCount=function(t){return this.isValidIndex(t)?this.currentSessionCounts[t]:0},t.prototype.getStartTime=function(t){return this.isValidIndex(t)?this.currentStartTimes[t]:null},t.prototype.moveSessionCountIntoBaseCount=function(t){if(!this.isValidIndex(t))return 0;var e=this.currentSessionCounts[t];return this.currentSessionCounts[t]=0,e},t.prototype.initCounts=function(t,e,n){void 0===n&&(n=!1);for(var i=0;i<this.trackedActivities.length&&!(this.isOrdered&&i>this.currentIndex);i++)i<e.length&&e[i]&&(this.currentSessionCounts[i]=this.currentCounts[i]=e[i].tracker.getSessionCount(e[i].index),this.currentStartTimes[i]=e[i].tracker.getStartTime(e[i].index)),this.trackedActivities[i].getIsAggregate()&&i<t.length&&(this.currentCounts[i]+=t[i]),this.hasCountCrossedThreshold(i)&&this.finishActivityAtIndex(i);this.isActivated()&&!n&&(this.isActivationByInitPending=!0)},t.prototype.generateActivityIndexList=function(){for(var e=new Array,n=0;n<this.trackedActivities.length;n++){var i=new t.ActivityIndex;i.activity=this.trackedActivities[n].getActivity(),i.index=n,e.push(i)}return e},t.prototype.incrementActivity=function(e,n){if(!this.isValidIndex(e))return t.IncrementResult.Pending;if(n<0)throw new Error("increment must be non-negative");if(this.isOrdered&&e>this.currentIndex)return t.IncrementResult.Pending;var i=!this.hasCountCrossedThreshold(e);return this.currentCounts[e]+=n,this.currentSessionCounts[e]+=n,this.isActivationByInitPending?this.isPermittedIndexForActivationByInit(e)?this.commitActivation():t.IncrementResult.Pending:i&&this.hasCountCrossedThreshold(e)?(this.finishActivityAtIndex(e),this.isActivated()?this.commitActivation():t.IncrementResult.SingleActivityActivated):t.IncrementResult.Pending},t.prototype.startTime=function(t,e){this.isValidIndex(t)&&(this.currentStartTimes[t]=e?e:new Date)},t.prototype.stopTime=function(t,e){if(!this.isValidIndex(t))return 0;var n=this.currentStartTimes[t];if(this.currentStartTimes[t]=null,!n)return 0;if(e=e?e:new Date,n>e)return 0;var i=e.getTime()-n.getTime();return i/1e3},t.prototype.isValidIndex=function(t){return t<this.trackedActivities.length},t.prototype.isActivated=function(){return(this.currentActivationFlags&this.activationMask)===this.activationMask},t.prototype.finishActivityAtIndex=function(t){if(!this.isValidIndex(t))throw new Error("Index is not valid");this.currentActivationFlags|=1<<t,t+1<this.trackedActivities.length&&(this.currentIndex=t+1)},t.prototype.hasCountCrossedThreshold=function(t){if(!this.isValidIndex(t))throw new Error("Index is not valid");return this.currentCounts[t]>=this.trackedActivities[t].getCount()},t.prototype.isPermittedIndexForActivationByInit=function(t){return!this.isOrdered||t+1===this.currentCounts.length},t.prototype.commitActivation=function(){return this.isActivationByInitPending=!1,t.IncrementResult.AllActivitiesActivated},t}();!function(t){var e=function(){function t(){}return t}();t.ActivityIndex=e;var n;!function(t){t[t.Pending=0]="Pending",t[t.SingleActivityActivated=1]="SingleActivityActivated",t[t.AllActivitiesActivated=2]="AllActivitiesActivated"}(n=t.IncrementResult||(t.IncrementResult={}))}(i||(i={})),e.exports=i},{}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e,n){this.activity=t,this.count=e,this.isAggregate=n}return t.prototype.getActivity=function(){return this.activity},t.prototype.getCount=function(){return this.count},t.prototype.setCount=function(t){this.count=t},t.prototype.getIsAggregate=function(){return this.isAggregate},t}();n.ActivityTrackingData=i},{}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){this.isOrdered=t,this.list=e}return t.prototype.getIsOrdered=function(){return this.isOrdered},t.prototype.getList=function(){return this.list},t}();n.ActivityTrackingSet=i},{}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./../ISurveyInfo");n.ISurveyInfo=i;var r=t("./IActivityListener");n.IActivityListener=r;var o=t("./IFloodgateStorageProvider");n.IFloodgateStorageProvider=o;var a=t("./IFloodgateStringProvider");n.IFloodgateStringProvider=a;var s=t("./IPromptComponent");n.IPromptComponent=s;var u=t("./ISurvey");n.ISurvey=u;var l=t("./ISurveyComponent");n.ISurveyComponent=l},{"./../ISurveyInfo":23,"./IActivityListener":6,"./IFloodgateStorageProvider":7,"./IFloodgateStringProvider":8,"./IPromptComponent":9,"./ISurvey":10,"./ISurveyComponent":11}],6:[function(t,e,n){"use strict";var i;!function(t){var e=function(){function t(){}return t.AppLaunch="AppLaunch",t.AppUsageTime="AppUsageTime",t.AppResume="AppResume",t}();t.ActivityName=e}(i||(i={})),e.exports=i},{}],7:[function(t,e,n){"use strict";var i;!function(t){var e;!function(t){t[t.FloodgateSettings=0]="FloodgateSettings",t[t.SurveyActivationStats=1]="SurveyActivationStats",t[t.SurveyEventActivityStats=2]="SurveyEventActivityStats",t[t.CampaignDefinitions=3]="CampaignDefinitions",t[t.CampaignStates=4]="CampaignStates",t[t.GovernedChannelStates=5]="GovernedChannelStates"}(e=t.FileType||(t.FileType={}))}(i||(i={})),e.exports=i},{}],8:[function(t,e,n){"use strict";var i;!function(t){var e;!function(t){t[t.NpsPromptTitle=0]="NpsPromptTitle",t[t.NpsPromptQuestion=1]="NpsPromptQuestion",t[t.NpsPromptYesLabel=2]="NpsPromptYesLabel",t[t.NpsPromptNotNowLabel=3]="NpsPromptNotNowLabel",t[t.NpsRatingQuestion=4]="NpsRatingQuestion",t[t.Nps11RatingValue0=5]="Nps11RatingValue0",t[t.Nps11RatingValue1=6]="Nps11RatingValue1",t[t.Nps11RatingValue2=7]="Nps11RatingValue2",t[t.Nps11RatingValue3=8]="Nps11RatingValue3",t[t.Nps11RatingValue4=9]="Nps11RatingValue4",t[t.Nps11RatingValue5=10]="Nps11RatingValue5",t[t.Nps11RatingValue6=11]="Nps11RatingValue6",t[t.Nps11RatingValue7=12]="Nps11RatingValue7",t[t.Nps11RatingValue8=13]="Nps11RatingValue8",t[t.Nps11RatingValue9=14]="Nps11RatingValue9",t[t.Nps11RatingValue10=15]="Nps11RatingValue10",t[t.Nps5RatingValue1=16]="Nps5RatingValue1",t[t.Nps5RatingValue2=17]="Nps5RatingValue2",t[t.Nps5RatingValue3=18]="Nps5RatingValue3",t[t.Nps5RatingValue4=19]="Nps5RatingValue4",t[t.Nps5RatingValue5=20]="Nps5RatingValue5",t[t.NpsCommentQuestion=21]="NpsCommentQuestion",t[t.PsatPromptTitle=22]="PsatPromptTitle",t[t.PsatPromptQuestion=23]="PsatPromptQuestion",t[t.PsatPromptYesLabel=24]="PsatPromptYesLabel",t[t.PsatPromptNotNowLabel=25]="PsatPromptNotNowLabel",t[t.PsatRatingQuestion=26]="PsatRatingQuestion",t[t.PsatRatingValue1=27]="PsatRatingValue1",t[t.PsatRatingValue2=28]="PsatRatingValue2",t[t.PsatRatingValue3=29]="PsatRatingValue3",t[t.PsatRatingValue4=30]="PsatRatingValue4",t[t.PsatRatingValue5=31]="PsatRatingValue5",t[t.PsatCommentQuestion=32]="PsatCommentQuestion",t[t.BpsPromptTitle=33]="BpsPromptTitle",t[t.BpsPromptQuestion=34]="BpsPromptQuestion",t[t.BpsPromptYesLabel=35]="BpsPromptYesLabel",t[t.BpsPromptNotNowLabel=36]="BpsPromptNotNowLabel",t[t.BpsRatingQuestion=37]="BpsRatingQuestion",t[t.BpsRatingValue1=38]="BpsRatingValue1",t[t.BpsRatingValue2=39]="BpsRatingValue2",t[t.BpsCommentQuestion=40]="BpsCommentQuestion"}(e=t.StringType||(t.StringType={}))}(i||(i={})),e.exports=i},{}],9:[function(t,e,n){"use strict";var i;!function(t){var e;!function(t){t[t.Unselected=0]="Unselected",t[t.Yes=1]="Yes",t[t.No=2]="No"}(e=t.PromptButton||(t.PromptButton={}))}(i||(i={})),e.exports=i},{}],10:[function(t,e,n){"use strict";var i;!function(t){var e;!function(t){t[t.Feedback=0]="Feedback",t[t.Nps=1]="Nps",t[t.Psat=2]="Psat",t[t.Bps=3]="Bps",t[t.Fps=4]="Fps",t[t.Nlqs=5]="Nlqs"}(e=t.Type||(t.Type={})),t.DOM_FEEDBACKSURVEY_TAGNAME="FeedbackSurvey",t.DOM_NPS_TAGNAME="Nps",t.DOM_PSAT_TAGNAME="Psat",t.DOM_BPS_TAGNAME="Bps",t.DOM_FPS_TAGNAME="Fps",t.DOM_NLQS_TAGNAME="Nlqs"}(i||(i={})),e.exports=i},{}],11:[function(t,e,n){"use strict";var i;!function(t){var e;!function(t){t[t.Prompt="Prompt"]="Prompt",t[t.Comment="Comment"]="Comment",t[t.Rating="Rating"]="Rating"}(e=t.Type||(t.Type={})),t.DOM_PROMPT_TAGNAME="Prompt",t.DOM_COMMENT_TAGNAME="Comment",t.DOM_RATING_TAGNAME="Rating",t.JSON_PROMPT_KEYNAME="prompt",t.JSON_COMMENT_KEYNAME="comment",t.JSON_RATING_KEYNAME="rating"}(i||(i={})),e.exports=i},{}],12:[function(t,e,n){"use strict";function i(t){var e=[];if(l.isNullOrUndefined(t))return{result:e,error:"Empty"};if(!Array.isArray(t))return{result:e,error:"Not an array"};for(var n=[],i=0;i<t.length;i++){var r=t[i];if(r){var o=L.deserialize(r);o?e.push(o):n.push(i)}else n.push(i)}var a=n.length>0?"Invalid campaign definitions at indexes: "+n.toString():void 0;return{result:e,error:a}}var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=t("../Api/IFloodgateStorageProvider"),a=t("../FloodgateEngine"),s=t("../GovernedChannel"),u=t("../ISurveyInfo"),l=t("../Utils"),c=function(){function t(){}return t.deserialize=function(t){var e;return t&&0===t.Type&&(e=d.deserialize(t)),void 0===e?null:e},t.prototype.validate=function(){return!0},t}();n.CampaignLanguageRange=c;var d=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return t&&(n.languageSubTag=t.Value),n.validate()?n:null},e.prototype.isInRange=function(t){if(l.isNullOrUndefined(t))return!1;var e=l.extractLanguageSubtag(t);return!l.isNullOrUndefined(e)&&e.toLocaleUpperCase()===this.languageSubTag.toLocaleUpperCase()},e.prototype.validate=function(){return!!t.prototype.validate.call(this)&&(!(l.isNullOrUndefined(this.languageSubTag)||!l.isString(this.languageSubTag))&&!!l.isValidLanguageSubTag(this.languageSubTag))},e}(c);n.CampaignLanguageRangeLanguageSubtag=d;var p=function(){function t(){}return t.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=g.deserialize(t);break;case 1:e=f.deserialize(t)}return void 0===e?null:e},t.prototype.validate=function(){return!0},t}();n.CampaignScope=p;var g=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){return new e},e.prototype.isInScope=function(t){return!0},e.prototype.validate=function(){return!!t.prototype.validate.call(this)},e}(p);n.CampaignScopeAny=g;var f=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e,i=[];if(l.isNullOrUndefined(t))return null;for(var r in t.Languages)if(t.Languages.hasOwnProperty(r)){var o=t.Languages[r];o&&i.push(c.deserialize(o))}return 0===i.length&&(i=null),n.languageRanges=i,n.validate()?n:null},e.prototype.isInScope=function(t){if(l.isNullOrUndefined(this.languageRanges))return!0;if(l.isNullOrUndefined(t)||!t.getLanguage())return!1;for(var e in this.languageRanges)if(this.languageRanges.hasOwnProperty(e)){var n=this.languageRanges[e];if(n.isInRange(t.getLanguage()))return!0}return!1},e.prototype.validate=function(){if(!t.prototype.validate.call(this))return!1;if(this.languageRanges)for(var e in this.languageRanges)if(this.languageRanges.hasOwnProperty(e)&&!this.languageRanges[e])return!1;return!0},e}(p);n.CampaignScopeEnvironmentCrossProduct=f;var h=function(){function t(){}return t.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=m.deserialize(t);break;case 1:e=v.deserialize(t)}return void 0===e?null:e},t.prototype.validate=function(){return!0},t}();n.CampaignDuration=h;var m=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return t&&(n.intervalSeconds=t.IntervalSeconds),n.validate()?n:null},e.prototype.asTimeIntervalSeconds=function(){return this.intervalSeconds},e.prototype.validate=function(){return!!t.prototype.validate.call(this)&&!!l.isNumber(this.intervalSeconds)},e}(h);n.CampaignDurationTimeInterval=m;var v=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){return new e},e.prototype.asTimeIntervalSeconds=function(){return null},e}(h);n.CampaignDurationSingleBuildChange=v;var y=function(){function t(){}return t.deserialize=function(e){var n=new t;if(!l.isNullOrUndefined(e)){n.additionalData=[];for(var i=0,r=e;i<r.length;i++){var o=r[i];"EmailAddress"===o&&n.additionalData.push(u.AdditionalDataType.EmailAddress)}}return n.validate()?n:null},t.prototype.validate=function(){return!l.isNullOrUndefined(this.additionalData)},t}();n.CampaignAdditionalDataRequested=y;var S=function(){function t(){}return t.deserialize=function(t){var e;return t&&0===t.Type&&(e=b.deserialize(t)),void 0===e?null:e},t.prototype.validate=function(){return!0},t}();n.CampaignDistribution=S;var b=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return t&&(n.maxDelaySeconds=t.MaxDelaySeconds,n.chunks=t.Chunks),n.validate()?n:null},e.prototype.validate=function(){return!!t.prototype.validate.call(this)&&(!(!l.isNumber(this.maxDelaySeconds)||this.maxDelaySeconds<0)&&!(!l.isNumber(this.chunks)||this.chunks<0))},e}(S);n.CampaignDistributionRamp=b;var C=function(){function t(){}return t.deserialize=function(t){var e;return t&&0===t.Type&&(e=T.deserialize(t)),void 0===e?null:e},t.prototype.getActiveSurveyTimeIntervalSeconds=function(){var t=this.nominationPeriod.asTimeIntervalSeconds();return l.isNumber(t)?t:this.fallbackSurveyDurationSeconds},t.prototype.calculateSurveyStartTimeFromDate=function(t){return t?t:new Date},t.prototype.calculateSurveyExpirationTimeFromSurveyStartTime=function(t){return t=t?t:new Date,l.addSecondsWithoutOverflow(t,this.getActiveSurveyTimeIntervalSeconds())},t.prototype.getCampaignCooldown=function(t){return t?this.cooldownPeriod:this.nominationPeriod},t.prototype.validate=function(){return!l.isNullOrUndefined(this.nominationPeriod)&&(l.isNullOrUndefined(this.cooldownPeriod)&&(this.cooldownPeriod=this.nominationPeriod),!(!l.isNumber(this.nominationPeriod.asTimeIntervalSeconds())&&(!l.isNumber(this.fallbackSurveyDurationSeconds)||this.fallbackSurveyDurationSeconds<=0)))},t}();n.CampaignNominationScheme=C;var T=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return l.isNullOrUndefined(t)?null:(t.DistributionModel&&(n.distributionModel=S.deserialize(t.DistributionModel)),t.CooldownPeriod&&(n.cooldownPeriod=h.deserialize(t.CooldownPeriod)),t.NominationPeriod&&(n.nominationPeriod=h.deserialize(t.NominationPeriod)),n.fallbackSurveyDurationSeconds=t.FallbackSurveyDurationSeconds,n.percentageDenominator=t.PercentageDenominator,n.percentageNumerator=t.PercentageNumerator,n.validate()?n:null)},e.prototype.evaluateNominationRules=function(){var t=Math.random();return Math.floor(t*this.percentageDenominator)<this.percentageNumerator},e.prototype.validate=function(){return!!t.prototype.validate.call(this)&&(!(!l.isNumber(this.percentageDenominator)||!l.isNumber(this.percentageNumerator))&&(!(this.percentageDenominator<=0||this.percentageNumerator<0)&&!(this.percentageNumerator>this.percentageDenominator)))},e}(C);n.CampaignNominationSchemeRatioPercentage=T;var w=function(){function t(){}return t.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=I.deserialize(t);break;case 1:e=A.deserialize(t)}return void 0===e?null:e},t.prototype.validate=function(){return!0},t}();n.CampaignSurveyEvent=w;var I=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return l.isNullOrUndefined(t)?null:(n.activity=t.Activity,n.count=t.Count,n.isAggregate=t.IsAggregate,n.validate()?n:null)},e.prototype.validate=function(){return!!t.prototype.validate.call(this)&&(!(l.isNullOrUndefined(this.activity)||!l.isString(this.activity))&&(!(!l.isNumber(this.count)||this.count<=0)&&!!l.isBoolean(this.isAggregate)))},e}(w);n.CampaignSurveyEventCountedActivity=I;var A=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e,i=[];if(l.isNullOrUndefined(t))return null;for(var r in t.Sequence)if(t.Sequence.hasOwnProperty(r)){var o=t.Sequence[r];o&&i.push(I.deserialize(o))}return 0===i.length&&(i=null),n.sequence=i,n.validate()?n:null},e.prototype.validate=function(){if(!t.prototype.validate.call(this))return!1;if(l.isNullOrUndefined(this.sequence))return!1;for(var e in this.sequence)if(this.sequence.hasOwnProperty(e)&&!this.sequence[e])return!1;return!0},e}(w);n.CampaignSurveyEventCountedActivitySequence=A;var E=function(){function t(){}return t.deserialize=function(e){var n=new t;return l.isNullOrUndefined(e)?null:(n.prompt=F.deserialize(e.Prompt),n.rating=D.deserialize(e.Rating),n.comment=x.deserialize(e.Question),n.validate()?n:null)},t.prototype.validate=function(){return!(l.isNullOrUndefined(this.prompt)||l.isNullOrUndefined(this.rating)||l.isNullOrUndefined(this.comment))},t}();n.CampaignSurveyContent=E;var F=function(){function t(){}return t.deserialize=function(e){var n=new t;return l.isNullOrUndefined(e)?null:(n.title=e.Title,n.question=e.Question,n.yesLabel=e.YesLabel,n.noLabel=e.NoLabel,n.validate()?n:null)},t.prototype.validate=function(){return!(l.isNullOrUndefined(this.title)||!l.isString(this.title)||l.isNullOrUndefined(this.question)||!l.isString(this.question)||l.isNullOrUndefined(this.yesLabel)||!l.isString(this.yesLabel)||l.isNullOrUndefined(this.noLabel)||!l.isString(this.noLabel))},t}();n.CampaignSurveyContentPrompt=F;var D=function(){function t(){}return t.deserialize=function(e){var n=new t;return l.isNullOrUndefined(e)?null:(n.isZeroBased=e.IsZeroBased,n.question=e.Question,n.ratingValuesAscending=e.RatingValuesAscending,n.validate()?n:null)},t.prototype.validate=function(){if(l.isNullOrUndefined(this.question)||!l.isString(this.question)||l.isNullOrUndefined(this.ratingValuesAscending)||!Array.isArray(this.ratingValuesAscending)||this.ratingValuesAscending.length<2||this.ratingValuesAscending.length>11)return!1;if(l.isNullOrUndefined(this.isZeroBased))this.isZeroBased=!1;else if(!l.isBoolean(this.isZeroBased))return!1;for(var t in this.ratingValuesAscending)if(this.ratingValuesAscending.hasOwnProperty(t)&&!l.isString(this.ratingValuesAscending[t]))return!1;return!0},t}();n.CampaignSurveyContentRating=D;var x=function(){function t(){}return t.deserialize=function(e){var n=new t;return l.isNullOrUndefined(e)?null:(n.question=e.Question,n.validate()?n:null)},t.prototype.validate=function(){return!(l.isNullOrUndefined(this.question)||!l.isString(this.question))},t}();n.CampaignSurveyContentComment=x;var N=function(){function t(){}return t.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=k.deserialize(t);break;case 1:e=P.deserialize(t);break;case 2:e=O.deserialize(t);break;case 3:e=_.deserialize(t);break;case 4:e=B.deserialize(t)}return void 0===e?null:e},t.prototype.validate=function(){return!l.isNullOrUndefined(this.activationEvent)},t}();n.CampaignSurveyTemplate=N;var O=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return l.isNullOrUndefined(t)?null:(n.activationEvent=w.deserialize(t.ActivationEvent),n.content=E.deserialize(t.Content),n.validate()?n:null)},e.prototype.validate=function(){return!(!t.prototype.validate.call(this)||l.isNullOrUndefined(this.content))},e}(N);n.CampaignSurveyTemplateFps=O;var _=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return l.isNullOrUndefined(t)?null:(n.activationEvent=w.deserialize(t.ActivationEvent),n.content=E.deserialize(t.Content),n.validate()?n:null)},e.prototype.validate=function(){return!(!t.prototype.validate.call(this)||l.isNullOrUndefined(this.content))},e}(N);n.CampaignSurveyTemplateNlqs=_;var B=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return l.isNullOrUndefined(t)?null:(n.activationEvent=w.deserialize(t.ActivationEvent),n.content=E.deserialize(t.Content),n.validate()?n:null)},e.prototype.validate=function(){return!(!t.prototype.validate.call(this)||l.isNullOrUndefined(this.content))},e}(N);n.CampaignSurveyTemplateNps=B;var k=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return l.isNullOrUndefined(t)?null:(n.activationEvent=w.deserialize(t.ActivationEvent),n.validate()?n:null)},e.prototype.validate=function(){return!!t.prototype.validate.call(this)},e}(N);n.CampaignSurveyTemplateNps5PointStatic=k;var P=function(t){function e(){return t.call(this)||this}return r(e,t),e.deserialize=function(t){var n=new e;return l.isNullOrUndefined(t)?null:(n.activationEvent=w.deserialize(t.ActivationEvent),n.validate()?n:null)},e.prototype.validate=function(){return!!t.prototype.validate.call(this)},e}(N);n.CampaignSurveyTemplateNps11PointStatic=P;var L=function(){function t(){}return t.deserialize=function(e){var n=new t;if(l.isNullOrUndefined(e))return null;n.campaignId=e.CampaignId,n.governedChannelType=e.GovernedChannelType,n.startTime=e.StartTimeUtc,n.endTime=e.EndTimeUtc;var i=y.deserialize(e.AdditionalDataRequested);return n.additionalDataRequested=i?i.additionalData:[],e.SurveyTemplate&&(n.surveyTemplate=N.deserialize(e.SurveyTemplate)),e.NominationScheme&&(n.nominationScheme=C.deserialize(e.NominationScheme)),e.Scope&&(n.scope=p.deserialize(e.Scope)),n.validate()?n:null},t.prototype.validate=function(){if(l.isNullOrUndefined(this.scope)&&(this.scope=new g),l.isNullOrUndefined(this.campaignId)||!l.isString(this.campaignId))return!1;if(!l.isNumber(this.governedChannelType)||!l.isEnumValue(this.governedChannelType,s.GovernedChannelType))return!1;if(l.isNullOrUndefined(this.nominationScheme))return!1;if(l.isNullOrUndefined(this.surveyTemplate))return!1;if(l.isNullOrUndefined(this.startTime))this.startTime=l.getDistantFuture();else{if(!l.isUtcDatetimeString(this.startTime))return!1;this.startTime=l.stringToDate(this.startTime)}if(l.isNullOrUndefined(this.endTime))this.endTime=l.getDistantFuture();else{if(!l.isUtcDatetimeString(this.endTime))return!1;this.endTime=l.stringToDate(this.endTime)}return!0},t}();n.CampaignDefinition=L,n.FilterValidCampaignDefinitions=i;var U=function(){function t(t){if(l.isNullOrUndefined(t))throw new Error("storage must not be null");this.storage=t}return t.prototype.load=function(){var t=this.storage.read(o.FileType.CampaignDefinitions);if(l.isNullOrUndefined(t))return[];var e;try{e=JSON.parse(t)}catch(t){return a.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed(t.toString()),[]}return i(e).result},t}();n.FileSystemCampaignDefinitionProvider=U},{"../Api/IFloodgateStorageProvider":7,"../FloodgateEngine":17,"../GovernedChannel":19,"../ISurveyInfo":23,"../Utils":38}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("../Utils"),r=t("./CampaignDefinitionProvider"),o=t("./CampaignStateProvider"),a=t("./CampaignSurveyFactory"),s=function(){function t(t,e,n,r,o,a){if(!t)throw new Error("stateProvider must not be null");if(!e)throw new Error("definitionProvider must not be null");if(!n)throw new Error("stringProvider must not be null");if(i.isNullOrUndefined(o))throw new Error("currentBuildNumber must not be null");this.campaignStates={},this.campaignDefinitions={},this.stateProvider=t,this.definitionProvider=e,this.stringProvider=n,this.environmentProvider=r,this.currentBuildNumber=o,a=a?a:new Date,this.refreshSurveyDefinitionsPrivate(null,a)}return t.isStateUpForNomination=function(e,n,i,r){if(!e||!n)return!1;if(i=i?i:new Date,e.ForceCandidacy)return!0;var o=n.nominationScheme.getCampaignCooldown(e.IsCandidate&&e.DidCandidateTriggerSurvey);return!!o&&(!!t.hasBuildChangeDurationElapsed(o,e.LastNominationBuildNumber,r)||t.hasTimeIntervalDurationElapsed(o,e.getCooldownStartDate(),i))},t.isDateInRange=function(t,e,n){return t=t?t:new Date,e=e?e:i.getDistantPast(),n=n?n:i.getDistantFuture(),e.getTime()<=t.getTime()&&n.getTime()>=t.getTime()},t.hasTimeIntervalDurationElapsed=function(t,e,n){if(i.isNullOrUndefined(t)||!(t instanceof r.CampaignDurationTimeInterval))return!1;if(!e||!n)return!1;var o=i.addSecondsWithoutOverflow(e,t.intervalSeconds);return n.getTime()>=o.getTime()},t.hasBuildChangeDurationElapsed=function(t,e,n){return!i.isNullOrUndefined(t)&&t instanceof r.CampaignDurationSingleBuildChange&&(i.isNullOrUndefined(e)||i.isNullOrUndefined(n)?null===e!=(null===n):!(e===n))},t.isCampaignInScope=function(e,n,i){return!!e&&(n=n?n:new Date,!!t.isDateInRangeWithDefinition(n,e)&&!(e.scope&&!e.scope.isInScope(i)))},t.isDateInRangeWithDefinition=function(e,n){return!!n&&(e=e?e:new Date,t.isDateInRange(e,n.startTime?n.startTime:i.getDistantFuture(),n.endTime))},t.prototype.getActiveSurveys=function(){var t={};for(var e in this.campaignStates)if(this.campaignStates.hasOwnProperty(e)){var n=this.campaignStates[e];if(!n.IsCandidate)continue;var i=this.campaignDefinitions[n.CampaignId];if(!i)continue;var r=a.CampaignSurveyFactory.makeSurvey(n,i.governedChannelType,i.surveyTemplate,this.stringProvider,i.additionalDataRequested);if(!r)continue;t[r.getSurveyInfo().getId()]=r}return t},t.prototype.onCampaignSurveyActivated=function(t,e){var n=this.campaignStates[t];n&&(e=e?e:new Date,n.markCurrentSurveyTakenOnDate(e),this.saveCurrentState())},t.prototype.getCampaignStates=function(){return this.campaignStates},t.prototype.getCampaignDefinitions=function(){return this.campaignDefinitions},t.prototype.onSurveyActivated=function(t){t&&this.onCampaignSurveyActivated(t.getBackEndId(),new Date)},t.prototype.refreshSurveyDefinitions=function(t){this.refreshSurveyDefinitionsPrivate(t,new Date)},t.prototype.getAppSurveys=function(){return this.getActiveSurveys()},t.prototype.saveCurrentState=function(){var t=i.makeArrayFromObjectValuesSortedByKeyString(this.campaignStates);this.stateProvider.save(t)},t.prototype.refreshSurveyDefinitionsPrivate=function(t,e){this.campaignStates={},this.campaignDefinitions={},this.loadAndFilterCampaignData(e,t),this.evaluateCampaigns(e)},t.prototype.loadAndFilterCampaignData=function(e,n){e=e?e:new Date;var r={},o=this.definitionProvider.load();for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];if(r[s.campaignId]=s,n&&n.indexOf(s.governedChannelType)<0)continue;if(!t.isCampaignInScope(s,e,this.environmentProvider))continue;this.campaignDefinitions[s.campaignId]=s}var u=this.stateProvider.load(),l=[];for(var a in u)if(u.hasOwnProperty(a)){var c=u[a];this.campaignDefinitions.hasOwnProperty(c.CampaignId)||l.push(c),this.campaignStates[c.CampaignId]=c}for(var a in l)if(l.hasOwnProperty(a)){var c=l[a];if(!c)continue;var s=r[c.CampaignId],d=!1;s?t.isStateUpForNomination(c,s,e,this.currentBuildNumber)&&(d=!0):c.LastNominationTimeUtc.getTime()<=i.subtractSecondsWithoutOverflow(e,c.DeleteAfterSecondsWhenStale).getTime()&&(d=!0),d&&delete this.campaignStates[c.CampaignId]}},t.prototype.evaluateCampaigns=function(e){e=e?e:new Date;for(var n in this.campaignDefinitions)if(this.campaignDefinitions.hasOwnProperty(n)){var r=this.campaignDefinitions[n],a=this.campaignStates[r.campaignId];if(!a||t.isStateUpForNomination(a,r,e,this.currentBuildNumber)){var s=a?a.LastSurveyId:"",u=a?a.LastSurveyStartTimeUtc:i.getDistantPast(),l=a?a.LastSurveyExpirationTimeUtc:i.getDistantPast(),c=a?a.LastSurveyActivatedTimeUtc:i.getDistantPast(),d=a&&a.ForceCandidacy||r.nominationScheme.evaluateNominationRules();d&&(s=i.guid(),u=r.nominationScheme.calculateSurveyStartTimeFromDate(e),l=r.nominationScheme.calculateSurveyExpirationTimeFromSurveyStartTime(u));var p=new o.CampaignState(r.campaignId,e,this.currentBuildNumber,r.nominationScheme.getActiveSurveyTimeIntervalSeconds(),(!1),d,(!1),c,s,u,l);this.campaignStates[p.CampaignId]=p}}},t}();n.CampaignManager=s},{"../Utils":38,"./CampaignDefinitionProvider":12,"./CampaignStateProvider":14,"./CampaignSurveyFactory":15}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("../Api/IFloodgateStorageProvider"),r=t("../Constants"),o=t("../FloodgateEngine"),a=t("../StateProviderHelpers"),s=t("../Utils"),u=i.FileType,l=a.StateListType,c=function(){function t(t,e,n,i,r,o,a,s,u,l,c){if(this.CampaignId=t,this.LastNominationTimeUtc=e,this.LastNominationBuildNumber=n,this.DeleteAfterSecondsWhenStale=i,this.ForceCandidacy=r,this.IsCandidate=o,this.DidCandidateTriggerSurvey=a,this.LastSurveyActivatedTimeUtc=s,this.LastSurveyId=u,this.LastSurveyStartTimeUtc=l,this.LastSurveyExpirationTimeUtc=c,!this.validate())throw new Error("Constructor arguments are not valid")}return t.deserialize=function(e){var n;if(!e)return null;try{n=new t(e.CampaignId,e.LastNominationTimeUtc,e.LastNominationBuildNumber,e.DeleteAfterSecondsWhenStale,(!1),e.IsCandidate,e.DidCandidateTriggerSurvey,e.LastSurveyActivatedTimeUtc,e.LastSurveyId,e.LastSurveyStartTimeUtc,e.LastSurveyExpirationTimeUtc)}catch(t){return o.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.CampaignState.Deserialize.Failed,{ErrorMessage:t.toString()}),null}return n},t.prototype.validate=function(){if(!this.CampaignId||!s.isString(this.CampaignId))return!1;if(s.isNullOrUndefined(this.LastNominationBuildNumber)||!s.isString(this.LastNominationBuildNumber))return!1;if(!s.isNumber(this.DeleteAfterSecondsWhenStale)||this.DeleteAfterSecondsWhenStale<0)return!1;if(!s.isBoolean(this.IsCandidate)||!s.isBoolean(this.DidCandidateTriggerSurvey))return!1;if(this.IsCandidate){if(s.isNullOrUndefined(this.LastSurveyStartTimeUtc)||s.isNullOrUndefined(this.LastSurveyExpirationTimeUtc))return!1;if(!s.isString(this.LastSurveyId))return!1}if(this.DidCandidateTriggerSurvey&&s.isNullOrUndefined(this.LastSurveyActivatedTimeUtc))return!1;if(s.isNullOrUndefined(this.LastSurveyId))this.LastSurveyId="";else if(!s.isString(this.LastSurveyId))return!1;if(s.isUtcDatetimeString(this.LastNominationTimeUtc))this.LastNominationTimeUtc=s.stringToDate(this.LastNominationTimeUtc);else if(!s.isDate(this.LastNominationTimeUtc))return!1;if(s.isNullOrUndefined(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=s.getDistantPast();else if(s.isUtcDatetimeString(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=s.stringToDate(this.LastSurveyActivatedTimeUtc);else if(!s.isDate(this.LastSurveyActivatedTimeUtc))return!1;if(s.isNullOrUndefined(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=s.getDistantPast();else if(s.isUtcDatetimeString(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=s.stringToDate(this.LastSurveyStartTimeUtc);else if(!s.isDate(this.LastSurveyStartTimeUtc))return!1;
if(s.isNullOrUndefined(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=s.getDistantPast();else if(s.isUtcDatetimeString(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=s.stringToDate(this.LastSurveyExpirationTimeUtc);else if(!s.isDate(this.LastSurveyExpirationTimeUtc))return!1;return!0},t.prototype.markCurrentSurveyTakenOnDate=function(t){this.DidCandidateTriggerSurvey=!0,this.LastSurveyActivatedTimeUtc=null!=t?t:new Date},t.prototype.getCooldownStartDate=function(){return this.IsCandidate?this.DidCandidateTriggerSurvey?this.LastSurveyActivatedTimeUtc:this.LastSurveyStartTimeUtc:this.LastNominationTimeUtc},t}();n.CampaignState=c;var d=function(){function t(){}return t.make=function(t,e){return e?new g(t,e):new f(t)},t}();n.CampaignStateProviderFactory=d;var p=function(){function t(){}return t}(),g=function(){function t(t,e){if(!e)throw new Error("host-based storage must not be null");this.hostBasedStorage=e,t&&(this.fileBasedStateProvider=new f(t))}return t.prototype.load=function(){var t,e=this.getStatesFromHost();this.fileBasedStateProvider&&(t=this.fileBasedStateProvider.load());var n=a.MergeAndUpdateCampaignStates(t,e);return n.find(l.Merged)},t.prototype.save=function(t){var e=this;if(t){var n=this.getStatesFromHost(),i=a.MergeAndUpdateCampaignStates(t,n),r=i.find(l.ToBeUpdated),o=i.find(l.Merged);r&&r.forEach(function(t){var n=a.makeSettingItemValue(JSON.stringify(t));e.hostBasedStorage.upsertSettingItem(u[u.CampaignStates],t.CampaignId,n)}),this.fileBasedStateProvider&&this.fileBasedStateProvider.save(o)}},t.prototype.getStatesFromHost=function(){var t=[],e=this.hostBasedStorage.readSettingList(u[u.CampaignStates]);for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],s=a.extractSettingItemValueSubString(i),l={};try{l=JSON.parse(s)}catch(t){o.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.HostBasedCampaignStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing failed. "+t.toString()})}var d=c.deserialize(l);d&&t.push(d)}return t},t}();n.HostBasedCampaignStateProvider=g;var f=function(){function t(t){if(!t)throw new Error("storage must not be null");this.storage=t}return t.prototype.load=function(){var t=this.storage.read(i.FileType.CampaignStates);if(!t)return[];var e;try{e=JSON.parse(t)}catch(t){return o.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.FileBasedCampaignStateProvider.Load.Failed,{ErrorMessage:"Json parsing failed. "+t.toString()}),[]}var n=[];return e&&e.CampaignStates&&e.CampaignStates.forEach(function(t){var e=c.deserialize(t);e&&n.push(e)}),n},t.prototype.save=function(t){if(t){var e=new p;e.CampaignStates=t;var n=JSON.stringify(e);this.storage.write(i.FileType.CampaignStates,n)}},t}();n.FileBasedCampaignStateProvider=f},{"../Api/IFloodgateStorageProvider":7,"../Constants":16,"../FloodgateEngine":17,"../StateProviderHelpers":25,"../Utils":38}],15:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("../SurveyEvents"),r=t("../Surveys/FpsSurvey"),o=t("../Surveys/NlqsSurvey"),a=t("../Surveys/NpsSurvey"),s=t("../Surveys/SurveyDataSource"),u=t("../Utils"),l=t("./CampaignDefinitionProvider"),c=function(){function t(){}return t.makeSurvey=function(e,n,i,s,u){return e&&i&&s?i instanceof l.CampaignSurveyTemplateNps5PointStatic?a.make5Point(t.makeSurveyDataSourceData(e,n,i,u),s):i instanceof l.CampaignSurveyTemplateNps11PointStatic?a.make11Point(t.makeSurveyDataSourceData(e,n,i,u),s):i instanceof l.CampaignSurveyTemplateFps?r.makeFps(t.makeSurveyDataSourceData(e,n,i,u),s,i):i instanceof l.CampaignSurveyTemplateNlqs?o.makeNlqs(t.makeSurveyDataSourceData(e,n,i,u),s,i):i instanceof l.CampaignSurveyTemplateNps?a.makeCustom(t.makeSurveyDataSourceData(e,n,i,u),s,i):null:null},t.makeSurveyDataSourceData=function(e,n,i,r){if(!e||!i)return null;var o=new s.SurveyDataSourceData;return o.activationEvent=t.makeEvent(e,i.activationEvent),o.id=e.LastSurveyId,o.backEndIdentifier=e.CampaignId,o.expirationTimeUtc=u.dateToShortUtcString(e.LastSurveyExpirationTimeUtc),o.governedChannelType=n,o.startTimeUtc=u.dateToShortUtcString(e.LastSurveyStartTimeUtc),o.additionalDataRequested=r||[],o},t.makeCountedActivityEventData=function(t){if(!t)return null;var e=new i.CountedActivityEventData;return e.activity=t.activity,e.count=t.count,e.isAggregate=t.isAggregate,e},t.makeCountedActivityEvent=function(e,n){if(!e||!n)return null;var r=t.makeCountedActivityEventData(n);return r?new i.CountedActivityEvent(r):null},t.makeCountedActivitySequenceEvent=function(e,n){if(!e||!n)return null;var r=new i.CountedActivitySequenceEventData;r.sequence=[];for(var o=0,a=n.sequence;o<a.length;o++){var s=a[o],u=t.makeCountedActivityEventData(s);if(!u)return null;r.sequence.push(u)}return new i.CountedActivitySequenceEvent(r)},t.makeEvent=function(e,n){return n instanceof l.CampaignSurveyEventCountedActivity?t.makeCountedActivityEvent(e,n):n instanceof l.CampaignSurveyEventCountedActivitySequence?t.makeCountedActivitySequenceEvent(e,n):null},t}();n.CampaignSurveyFactory=c},{"../SurveyEvents":30,"../Surveys/FpsSurvey":34,"../Surveys/NlqsSurvey":35,"../Surveys/NpsSurvey":36,"../Surveys/SurveyDataSource":37,"../Utils":38,"./CampaignDefinitionProvider":12}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t.CampaignState=(e=function(){function t(){}return t}(),e.Deserialize=(n=function(){function t(){}return t}(),n.Failed="FloodgateCore_CampaignState_Deserialize_Failed",n),e),t.FileBasedCampaignStateProvider=(i=function(){function t(){}return t}(),i.Load=(r=function(){function t(){}return t}(),r.Failed="FloodgateCore_FileBasedCampaignStateProvider_Load_Failed",r),i),t.HostBasedCampaignStateProvider=(o=function(){function t(){}return t}(),o.GetStatesFromHost=(a=function(){function t(){}return t}(),a.Failed="FloodgateCore_HostBasedCampaignStateProvider_GetStatesFromHost_Failed",a),o),t.FloodgateEngine=(s=function(){function t(){}return t}(),s.Make=(u=function(){function t(){}return t}(),u.Failed="FloodgateCore_FloodgateEngine_Make_Failed",u),s.Start=(l=function(){function t(){}return t}(),l.Failed="FloodgateCore_FloodgateEngine_Start_Failed",l),s.OnSurveyActivated=(c=function(){function t(){}return t}(),c.ActivationStatsSuppressedSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationStatsSuppressedSurvey",c.ClosedChannelType="FloodgateCore_FloodgateEngine_OnSurveyActivated_ClosedChannelType",c),s),t.GovernedChannelState=(d=function(){function t(){}return t}(),d.Deserialize=(p=function(){function t(){}return t}(),p.Failed="FloodgateCore_GovernedChannelState_Deserialize_Failed",p),d),t.FileBasedGovernedChannelStateProvider=(g=function(){function t(){}return t}(),g.Load=(f=function(){function t(){}return t}(),f.Failed="FloodgateCore_FileBasedGovernedChannelStateProvider_Load_Failed",f),g),t.HostBasedGovernedChannelStateProvider=(h=function(){function t(){}return t}(),h.GetStatesFromHost=(m=function(){function t(){}return t}(),m.Failed="FloodgateCore_HostBasedGovernedChannelStateProvider_GetStatesFromHost_Failed",m),h),t.SurveyStatCollectionActivation=(v=function(){function t(){}return t}(),v.FromJson=(y=function(){function t(){}return t}(),y.Failed="FloodgateCore_SurveyStatCollectionActivation_FromJson_Failed",y),v.ToJson=(S=function(){function t(){}return t}(),S.Failed="FloodgateCore_SurveyStatCollectionActivation_ToJson_Failed",S),v),t.HostBasedSurveyActivationStatsProvider=(b=function(){function t(){}return t}(),b.GetSurveyStatsFromHost=(C=function(){function t(){}return t}(),C.Failed="FloodgateCore_HostBasedSurveyActivationStatsProvider_GetSurveyStatsFromHost_Failed",C),b),t.SurveyStatCollectionEventActivity=(T=function(){function t(){}return t}(),T.FromJson=(w=function(){function t(){}return t}(),w.Failed="FloodgateCore_SurveyStatCollectionEventActivity_FromJson_Failed",w),T.ToJson=(I=function(){function t(){}return t}(),I.Failed="FloodgateCore_SurveyStatCollectionEventActivity_ToJson_Failed",I),T),t;var e,n,i,r,o,a,s,u,l,c,d,p,g,f,h,m,v,y,S,b,C,T,w,I}();n.TelemetryEvent=i},{}],17:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./Api/IFloodgateStorageProvider"),r=t("./Campaign/CampaignDefinitionProvider"),o=t("./Campaign/CampaignManager"),a=t("./Campaign/CampaignStateProvider"),s=t("./Constants"),u=t("./FloodgateSettings"),l=t("./GovernedChannel"),c=t("./GovernedChannelStateProvider"),d=t("./Governor"),p=t("./SurveyActivityListener"),g=t("./SurveyStatCollectionActivation"),f=t("./SurveyStatCollectionEventActivity"),h=function(){function t(){}return t.prototype.log_TriggerMet=function(t,e,n){},t.prototype.log_UserSelected=function(t,e,n){},t.prototype.log_CampaignLoad_Failed=function(t){},t.prototype.log_Event=function(t,e){},t}(),m=function(){function t(t,e,n,i,r,o,a){if(this.candidateSurveys={},this.launchedSurveys={},this.launchedLaunchers=[],!t)throw new Error("surveyClient must not be null");if(!e)throw new Error("activityListener must not be null");if(!n)throw new Error("launcherFactory must not be null");if(!i)throw new Error("onSurveyActivatedCallback must not be null");if(!r)throw new Error("storage must not be null");if(!o)throw new Error("governor must not be null");this.surveyClient=t,this.activityListener=e,this.launcherFactory=n,this.onSurveyActivatedCallback=i,this.storage=r,this.governor=o,this.surveyActivationStatsProvider=a,this.started=!1,this.loggedFirstStart=!1,this.setPendingSurveys(null),this.activityListener.clearSurveys();var s=this;this.activityListener.setCallback({run:function(t){s.onSurveyActivated(t)}})}return t.setTelemetryLogger=function(e){if(!e)throw new Error("telemetryLogger must not be null");t.telemetryLogger=e},t.getTelemetryLogger=function(){return t.telemetryLogger},t.make=function(e,n,i,u,l,f,h){try{var m=c.GovernedChannelStateProviderFactory.make(u,l),v=g.SurveyActivationStatsProviderFactory.make(u,l),y=a.CampaignStateProviderFactory.make(u,l);return new t(new o.CampaignManager(y,new r.FileSystemCampaignDefinitionProvider(u),f,h,e,new Date),new p({run:function(t){}}),n,i,u,new d.Governor(m),v)}catch(t){this.telemetryLogger.log_Event(s.TelemetryEvent.FloodgateEngine.Make.Failed,{ErrorMessage:t.toString()})}},t.prototype.mergeAndSave=function(){this.saveSettings(),this.saveSurveyActivationHistory(),this.saveSurveyEventActivityHistory(),this.surveyClient.saveCurrentState(),this.governor.saveChannelStates()},t.prototype.start=function(){if(!this.started)try{this.floodgateSettings=u.FloodgateSettings.fromJson(this.readString(i.FileType.FloodgateSettings)),this.previousSurveyActivationStats=this.surveyActivationStatsProvider.load(),this.previousSurveyEventActivityStats=f.SurveyStatCollectionEventActivity.fromJson(this.readString(i.FileType.SurveyEventActivityStats));var e=this.governor.getAvailableChannelData(),n=[];e.forEach(function(t){t&&n.push(t.getType())}),this.surveyClient.refreshSurveyDefinitions(n),this.setPendingSurveys(this.surveyClient.getAppSurveys()),this.updateActivityListenerWithCurrentSurveyDefinitions(),this.started=!0,this.loggedFirstStart||(this.loggedFirstStart=!0,this.getActivityListener().logActivity("FloodgateFirstStart"))}catch(e){t.getTelemetryLogger().log_Event(s.TelemetryEvent.FloodgateEngine.Start.Failed,{ErrorMessage:e.toString()})}},t.prototype.stop=function(){this.started&&(this.mergeAndSave(),this.setPendingSurveys(null),this.updateActivityListenerWithCurrentSurveyDefinitions(),this.started=!1)},t.prototype.getActivityListener=function(){return this.activityListener},t.prototype.saveSettings=function(){this.storage.fileLock(i.FileType.FloodgateSettings);try{this.writeString(i.FileType.FloodgateSettings,u.FloodgateSettings.toJson(this.floodgateSettings))}finally{this.storage.fileUnlock(i.FileType.FloodgateSettings)}},t.prototype.saveSurveyActivationHistory=function(){this.storage.fileLock(i.FileType.SurveyActivationStats);try{var t=this.surveyActivationStatsProvider.load(),e=new g.SurveyStatCollectionActivation;for(var n in this.launchedSurveys)if(this.launchedSurveys.hasOwnProperty(n)){var r=new g.SurveyActivationStats,o=this.launchedSurveys[n];r.Type=o.getType(),r.ExpirationTimeUtc=o.getSurveyInfo().getExpirationTimeUtc(),r.ActivationTimeUtc=new Date,e.addStats(o.getSurveyInfo().getId(),r)}t.accumulate(e),this.surveyActivationStatsProvider.save(t),this.previousSurveyActivationStats=t}finally{this.storage.fileUnlock(i.FileType.SurveyActivationStats)}},t.prototype.saveSurveyEventActivityHistory=function(){this.storage.fileLock(i.FileType.SurveyEventActivityStats);try{var t=f.SurveyStatCollectionEventActivity.fromJson(this.readString(i.FileType.SurveyEventActivityStats)),e=new Date,n=new f.SurveyStatCollectionEventActivity,r=function(t){if(o.candidateSurveys.hasOwnProperty(t)){var i=new f.SurveyEventActivityStats,r=o.candidateSurveys[t];if(!r.getSurveyInfo().isActiveForDate(e))return"continue";i.ExpirationTimeUtc=r.getSurveyInfo().getExpirationTimeUtc();var a=r.getSurveyInfo().getActivationEvent().getTrackingSet(),s=[];if(a.getList().forEach(function(t){t&&t.getIsAggregate()&&s.push(t.getActivity())}),0===s.length)return"continue";i.Counts=new Array(s.length);for(var u=0;u<s.length;u++)i.Counts[u]=o.activityListener.moveSessionCountIntoBaseCount(s[u]);n.addStats(r.getSurveyInfo().getId(),i)}},o=this;for(var a in this.candidateSurveys)r(a);t.accumulate(n),this.writeString(i.FileType.SurveyEventActivityStats,f.SurveyStatCollectionEventActivity.toJson(t)),this.previousSurveyEventActivityStats=t}finally{this.storage.fileUnlock(i.FileType.SurveyEventActivityStats)}},t.prototype.setPendingSurveys=function(t){t?this.candidateSurveys=t:this.candidateSurveys={}},t.prototype.updateActivityListenerWithCurrentSurveyDefinitions=function(){var e=new Array;for(var n in this.candidateSurveys)if(this.candidateSurveys.hasOwnProperty(n)){var i=this.candidateSurveys[n];if(this.previousSurveyActivationStats.getBySurveyId(i.getSurveyInfo().getId()))continue;if(!i.getSurveyInfo().isActiveForDate(new Date))continue;t.telemetryLogger.log_UserSelected(i.getSurveyInfo().getBackEndId(),i.getSurveyInfo().getId(),i.getType()),e.push(i)}this.activityListener.setSurveys(e,this.previousSurveyEventActivityStats)},t.prototype.onSurveyActivated=function(e){t.telemetryLogger.log_TriggerMet(e.getSurveyInfo().getBackEndId(),e.getSurveyInfo().getId(),e.getType());var n=!1,i=e.getSurveyInfo().getGovernedChannelType();if(this.candidateSurveys[e.getSurveyInfo().getId()])if(e.getSurveyInfo().isActiveForDate(new Date))if(this.governor.refreshChannelData(),this.governor.isChannelOpen(i)){var r=this.surveyActivationStatsProvider.load();r.getBySurveyId(e.getSurveyInfo().getId())?t.getTelemetryLogger().log_Event(s.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationStatsSuppressedSurvey,{CampaignId:e.getSurveyInfo().getBackEndId(),SurveyId:e.getSurveyInfo().getId()}):0===Object.keys(this.launchedSurveys).length&&(this.launchedSurveys[e.getSurveyInfo().getId()]=e,n=!0)}else t.getTelemetryLogger().log_Event(s.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ClosedChannelType,{ClosedChannelType:l.GovernedChannelType[i]});else;else;this.mergeAndSave(),this.activityListener.clearSurveys(),n&&(this.governor.startChannelCooldown(i),this.surveyClient.onSurveyActivated(e.getSurveyInfo()),this.launchLauncher(e))},t.prototype.readString=function(t){return this.storage.read(t)},t.prototype.writeString=function(t,e){this.storage.write(t,e)},t.prototype.launchLauncher=function(t){var e=this.launcherFactory.makeSurveyLauncher(t);e&&(this.launchedLaunchers.push(e),this.onSurveyActivatedCallback.onSurveyActivated(e))},t.telemetryLogger=new h,t}();n.FloodgateEngine=m},{"./Api/IFloodgateStorageProvider":7,"./Campaign/CampaignDefinitionProvider":12,"./Campaign/CampaignManager":13,"./Campaign/CampaignStateProvider":14,"./Constants":16,"./FloodgateSettings":18,"./GovernedChannel":19,"./GovernedChannelStateProvider":20,"./Governor":21,"./SurveyActivityListener":26,"./SurveyStatCollectionActivation":32,"./SurveyStatCollectionEventActivity":33}],18:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t.toJson=function(t){return JSON.stringify(t)},t.fromJson=function(t){return JSON.parse(t)},t}();n.FloodgateSettings=i},{}],19:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,r=t("./Utils");!function(t){t[t.Standard=0]="Standard",t[t.Urgent=1]="Urgent"}(i=n.GovernedChannelType||(n.GovernedChannelType={})),function(t){function e(){return t.Standard}t.getDefault=e}(i=n.GovernedChannelType||(n.GovernedChannelType={}));var o=function(){function t(t,e,n,o){if(!r.isEnumValue(t,i))throw new Error("type is not a valid GovernedChannelType");if(!e)throw new Error("name must not be null or empty");if(n<0)throw new Error("cooldownSeconds must not be negative");this.type=t,this.name=e,this.cooldownSeconds=n,this.setCooldownStartTime(o)}return t.prototype.setCooldownStartTime=function(t){this.cooldownStartTime=t,r.isNullOrUndefined(this.cooldownStartTime)?this.cooldownEndTime=r.getDistantPast():this.cooldownEndTime=r.addSecondsWithoutOverflow(this.cooldownStartTime,this.cooldownSeconds)},t.prototype.isOpen=function(){return this.isOpenAtDate(new Date)},t.prototype.isOpenAtDate=function(t){return!!t&&t>this.cooldownEndTime},t.prototype.getType=function(){return this.type},t.prototype.getName=function(){return this.name},t.prototype.getCooldownSeconds=function(){return this.cooldownSeconds},t.prototype.getCooldownStartTime=function(){return this.cooldownStartTime},t.prototype.getCooldownEndTime=function(){return this.cooldownEndTime},t}();n.GovernedChannel=o},{"./Utils":38}],20:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./Api/IFloodgateStorageProvider"),r=t("./Constants"),o=t("./FloodgateEngine"),a=t("./GovernedChannel"),s=t("./StateProviderHelpers"),u=t("./Utils"),l=i.FileType,c=s.StateListType,d=function(){function t(t,e){if(this.ChannelType=t,this.CooldownStartTimeUtc=e,!this.validate())throw new Error("Constructor arguments are not valid")}return t.deserialize=function(e){var n;if(!e)return null;try{n=new t(e.ChannelType,e.CooldownStartTimeUtc)}catch(t){return o.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.GovernedChannelState.Deserialize.Failed,{ErrorMessage:t.toString()}),null}return n},t.prototype.validate=function(){return!!u.isEnumValue(this.ChannelType,a.GovernedChannelType)&&(u.isUtcDatetimeString(this.CooldownStartTimeUtc)?this.CooldownStartTimeUtc=u.stringToDate(this.CooldownStartTimeUtc):!u.isNullOrUndefined(this.CooldownStartTimeUtc)&&u.isDate(this.CooldownStartTimeUtc)||(this.CooldownStartTimeUtc=u.getDistantPast()),!0)},t.prototype.getType=function(){return this.ChannelType},t.prototype.getCooldownStartTime=function(){return this.CooldownStartTimeUtc},t}();n.GovernedChannelState=d;var p=function(){function t(){}return t.make=function(t,e){return e?new f(t,e):new h(t)},t}();n.GovernedChannelStateProviderFactory=p;var g=function(){function t(){}return t}(),f=function(){function t(t,e){if(!e)throw new Error("host-based storage must not be null");this.hostBasedStorage=e,t&&(this.fileBasedStateProvider=new h(t))}return t.prototype.load=function(){var t,e=this.getStatesFromHost();this.fileBasedStateProvider&&(t=this.fileBasedStateProvider.load());var n=s.MergeAndUpdateGovernedChannelStates(t,e);return n.find(c.Merged)},t.prototype.save=function(t){var e=this;if(t){var n=this.getStatesFromHost(),i=s.MergeAndUpdateGovernedChannelStates(t,n),r=i.find(c.ToBeUpdated),o=i.find(c.Merged);r&&r.forEach(function(t){var n=s.makeSettingItemValue(JSON.stringify(t));e.hostBasedStorage.upsertSettingItem(l[l.GovernedChannelStates],String(t.getType()),n)}),this.fileBasedStateProvider&&this.fileBasedStateProvider.save(o)}},t.prototype.getStatesFromHost=function(){var t=[],e=this.hostBasedStorage.readSettingList(l[l.GovernedChannelStates]);for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],a=s.extractSettingItemValueSubString(i),u={};try{u=JSON.parse(a)}catch(t){o.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.HostBasedGovernedChannelStateProvider.GetStatesFromHost.Failed,{ErrorMessage:t.toString()})}var c=d.deserialize(u);c&&t.push(c)}return t},t}();n.HostBasedGovernedChannelStateProvider=f;var h=function(){function t(t){if(!t)throw new Error("storage must not be null");this.storage=t}return t.prototype.load=function(){var t=this.storage.read(l.GovernedChannelStates);if(!t)return[];var e;try{e=JSON.parse(t)}catch(t){return o.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.FileBasedGovernedChannelStateProvider.Load.Failed,{ErrorMessage:t.toString()}),[]}var n=[];return e&&e.ChannelStates&&e.ChannelStates.forEach(function(t){var e=d.deserialize(t);e&&n.push(e)}),n},t.prototype.save=function(t){if(t){var e=new g;e.ChannelStates=t;var n=JSON.stringify(e);this.storage.write(l.GovernedChannelStates,n)}},t}();n.FileBasedGovernedChannelStateProvider=h},{"./Api/IFloodgateStorageProvider":7,"./Constants":16,"./FloodgateEngine":17,"./GovernedChannel":19,"./StateProviderHelpers":25,"./Utils":38}],21:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./GovernedChannel"),r=t("./GovernedChannelStateProvider"),o=t("./Utils"),a=function(){function t(t,e){this.name=t,this.cooldownSeconds=e}return t}(),s=function(){function t(t){if(!t)throw new Error("channelStateProvider must not be null");this.channelStateProvider=t,this.loadChannels()}return t.prototype.refreshChannelData=function(){this.loadChannels()},t.prototype.getAvailableChannelData=function(){var t=[];for(var e in this.channels)if(this.channels.hasOwnProperty(e)){var n=this.channels[e];n.isOpen()&&t.push(n)}return t},t.prototype.isChannelOpen=function(t){if(o.isNullOrUndefined(t))throw new Error("type must not be null");return this.channels[t].isOpen()},t.prototype.startChannelCooldown=function(t,e){if(o.isNullOrUndefined(t))throw new Error("type must not be null");e=e?e:new Date,this.channels[t].setCooldownStartTime(e),this.saveChannelStates()},t.prototype.saveChannelStates=function(){var t=[];for(var e in this.channels)if(this.channels.hasOwnProperty(e)){var n=this.channels[e],i=new r.GovernedChannelState(n.getType(),n.getCooldownStartTime());t.push(i)}this.channelStateProvider.save(t)},t.prototype.loadChannels=function(){this.loadChannelStatesFromProvider();for(var e in i.GovernedChannelType)if(i.GovernedChannelType.hasOwnProperty(e)){var n=Number(e);if(isNaN(n)||this.channels[n])continue;var r=t.defaultChannelData[n],o=new i.GovernedChannel(n,r.name,r.cooldownSeconds,null);this.channels[n]=o}},t.prototype.loadChannelStatesFromProvider=function(){this.channels=[];var e=this.channelStateProvider.load();for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],o=r.getType(),a=t.defaultChannelData[o],s=new i.GovernedChannel(o,a.name,a.cooldownSeconds,r.getCooldownStartTime());this.channels[s.getType()]=s}},t.minute=60,t.hour=60*t.minute,t.day=24*t.hour,t.defaultChannelData=[new a(i.GovernedChannelType[i.GovernedChannelType.Standard],14*t.day),new a(i.GovernedChannelType[i.GovernedChannelType.Urgent],0)],t}();n.Governor=s},{"./GovernedChannel":19,"./GovernedChannelStateProvider":20,"./Utils":38}],22:[function(t,e,n){"use strict";var i;!function(t){var e;!function(t){t[t.CountedActivity="CountedActivity"]="CountedActivity",t[t.CountedActivitySequence="CountedActivitySequence"]="CountedActivitySequence"}(e=t.Type||(t.Type={}))}(i||(i={})),e.exports=i},{}],23:[function(t,e,n){"use strict";var i;!function(t){var e;!function(t){t[t.Default="Default"]="Default",t[t.Notification="Notification"]="Notification",t[t.Modal="Modal"]="Modal"}(e=t.LaunchType||(t.LaunchType={}));var n;!function(t){t[t.EmailAddress=0]="EmailAddress"}(n=t.AdditionalDataType||(t.AdditionalDataType={})),t.DOM_TYPE_TAGNAME="Type",t.DOM_TYPE_VALUE="Survey",t.DOM_ID_TAGNAME="SurveyID",t.JSON_SURVEY_KEYNAME="survey",t.JSON_ID_KEYNAME="surveyId"}(i||(i={})),e.exports=i},{}],24:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t}();n.IndexedTracker=i},{}],25:[function(t,e,n){"use strict";function i(t){if(!t)return t;var e=t.indexOf(d)+d.length,n=t.indexOf(p);return e<0||n<0?t:t.substring(e,n)}function r(t){return t?d+t+p:d+p}function o(t,e){var n=new c;if(!t&&!e)return n;if(!t)return n.add(u.Merged,e),n;if(!e)return n.add(u.Merged,t),n.add(u.ToBeUpdated,t),n;var i=[],r=[];return t&&t.forEach(function(t){for(var n,o=-1,a=0;a<e.length;a++)if(n=e[a],n.getType()===t.getType()){o=a;break}return o===-1?(i.push(t),void r.push(t)):(t.getCooldownStartTime()>n.getCooldownStartTime()?(i.push(t),r.push(t)):i.push(n),void e.splice(o,1))}),e&&e.forEach(function(t){i.push(t)}),n.add(u.Merged,i),r.length>0&&n.add(u.ToBeUpdated,r),n}function a(t,e){var n=new c;if(!t&&!e)return n;if(!t)return n.add(u.Merged,e),n;if(!e)return n.add(u.Merged,t),n.add(u.ToBeUpdated,t),n;var i=[],r=[];return t&&t.forEach(function(t){for(var n,o=-1,a=0;a<e.length;a++)if(n=e[a],n.CampaignId===t.CampaignId){o=a;break}return o===-1?(i.push(t),void r.push(t)):(t.getCooldownStartDate()>n.getCooldownStartDate()||t.getCooldownStartDate()===n.getCooldownStartDate()&&t.LastNominationTimeUtc>n.LastNominationTimeUtc?(i.push(t),r.push(t)):i.push(n),void e.splice(o,1))}),e&&e.forEach(function(t){i.push(t)}),n.add(u.Merged,i),r.length>0&&n.add(u.ToBeUpdated,r),n}function s(t,e){var n=new c;if(!t&&!e)return n;if(!t)return n.add(u.Merged,e),n;if(!e)return n.add(u.Merged,t),n.add(u.ToBeUpdated,t),n;var i=new l.SurveyStatCollectionActivation,r=new l.SurveyStatCollectionActivation,o=t.getStats(),a=e.getStats();for(var s in o)if(o.hasOwnProperty(s)){var d=a[s];if(!d){i.addStats(s,o[s]),r.addStats(s,o[s]);continue}var p=o[s];p.ActivationTimeUtc>d.ActivationTimeUtc?(i.addStats(s,o[s]),r.addStats(s,o[s])):i.addStats(s,a[s]),delete a[s]}for(var s in a)a.hasOwnProperty(s)&&i.addStats(s,a[s]);n.add(u.Merged,i);var g=r.getStats();for(var f in g)if(g.hasOwnProperty(f)){n.add(u.ToBeUpdated,r);break}return n}Object.defineProperty(n,"__esModule",{value:!0});var u,l=t("../src/SurveyStatCollectionActivation");!function(t){t[t.Merged=0]="Merged",t[t.ToBeUpdated=1]="ToBeUpdated"}(u=n.StateListType||(n.StateListType={}));var c=function(){function t(){this.items={},this.itemCount=0}return t.prototype.add=function(t,e){this.items[t]||this.itemCount++,this.items[t]=e},t.prototype.find=function(t){return this.items[t]},t.prototype.remove=function(t){var e=this.items[t];return e&&(delete this.items[t],this.itemCount--),e},t.prototype.count=function(){return this.itemCount},t}();n.ItemCollection=c,n.extractSettingItemValueSubString=i,n.makeSettingItemValue=r,n.MergeAndUpdateGovernedChannelStates=o,n.MergeAndUpdateCampaignStates=a,n.MergeAndUpdateSurveyActivationStats=s;var d="<data>",p="</data>"},{"../src/SurveyStatCollectionActivation":32}],26:[function(t,e,n){"use strict";var i=t("./ActivityTracker"),r=t("./IndexedTracker"),o=t("./SurveyStatCollectionEventActivity"),a=function(){function t(t){if(!t)throw new Error("callback must not be null");this.trackedActivityMap={},this.callback=t}return t.prototype.logActivity=function(e,n){void 0===n&&(n=1),this.logActivity_private(e,t.LogActionType.Increment,n,null)},t.prototype.logActivityStartTime=function(e,n){this.logActivity_private(e,t.LogActionType.StartTime,0,n)},t.prototype.logActivityStopTime=function(e,n){this.logActivity_private(e,t.LogActionType.StopTime,0,n)},t.prototype.setSurveys=function(t,e){if(void 0===e&&(e=new o.SurveyStatCollectionEventActivity),t&&0!==t.length&&e){for(var n=new Object,a=0,s=t;a<s.length;a++){for(var u=s[a],l=u.getSurveyInfo().getActivationEvent().getTrackingSet(),c=!1,d=0,p=l.getList();d<p.length;d++){var g=p[d];if(n.hasOwnProperty(g.getActivity())){c=!0;break}}if(!c){for(var f=e.getBySurveyId(u.getSurveyInfo().getId()),h=[l.getList().length],m=new Array(l.getList().length),v=0,y=0,S=0,b=l.getList();S<b.length;S++){var g=b[S];h[y]=0,g.getIsAggregate()&&f&&v<f.Counts.length&&(h[y]=f.Counts[v++]),m[y]=this.trackedActivityMap[g.getActivity()],y++}var C=new i(l);C.initCounts(h,m,!1);for(var T=0,w=C.generateActivityIndexList();T<w.length;T++){var I=w[T],A=new r.IndexedTracker;A.index=I.index,A.survey=u,A.tracker=C,n[I.activity]=A}}}this.copyObject(this.trackedActivityMap,n)}},t.prototype.clearSurveys=function(){var t=this;Object.getOwnPropertyNames(this.trackedActivityMap).forEach(function(e){delete t.trackedActivityMap[e]})},t.prototype.getCount=function(t){var e;return e=this.trackedActivityMap[t],e?e.tracker.getCount(e.index):0},t.prototype.getSessionCount=function(t){var e;return e=this.trackedActivityMap[t],e?e.tracker.getSessionCount(e.index):0},t.prototype.moveSessionCountIntoBaseCount=function(t){var e;return e=this.trackedActivityMap[t],e?e.tracker.moveSessionCountIntoBaseCount(e.index):0},t.prototype.getSurvey=function(t){var e;return e=this.trackedActivityMap[t],e?e.survey:null},t.prototype.setCallback=function(t){this.callback=t},t.prototype.logActivity_private=function(e,n,r,o){var a,s;if(a=this.trackedActivityMap[e]){switch(n){case t.LogActionType.StartTime:return void a.tracker.startTime(a.index,o);case t.LogActionType.StopTime:r=a.tracker.stopTime(a.index,o);case t.LogActionType.Increment:break;default:return}s=a.tracker.incrementActivity(a.index,r),s===i.IncrementResult.AllActivitiesActivated&&this.executeCallback(a.survey)}},t.prototype.executeCallback=function(t){this.callback.run(t)},t.prototype.copyObject=function(t,e){Object.keys(e).forEach(function(n){t[n]=e[n]})},t}();!function(t){var e;!function(t){t[t.Increment=0]="Increment",t[t.StartTime=1]="StartTime",t[t.StopTime=2]="StopTime"}(e=t.LogActionType||(t.LogActionType={}))}(a||(a={})),e.exports=a},{"./ActivityTracker":2,"./IndexedTracker":24,"./SurveyStatCollectionEventActivity":33}],27:[function(t,e,n){"use strict";var i=t("./../Api/ISurveyComponent"),r=function(){function t(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");this.data=t,this.userComment=""}return t.make=function(e){try{return new t(e)}catch(t){return null}},t.prototype.getType=function(){return i.Type.Comment},t.prototype.getQuestion=function(){return this.data.question},t.prototype.setSubmittedText=function(t){this.userComment=t},t.prototype.getSubmittedText=function(){return this.userComment},t.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(i.DOM_COMMENT_TAGNAME);return e.appendChild(t.createTextNode(this.getSubmittedText())),[e]},t.prototype.getJsonElements=function(){var t={};return t[i.JSON_COMMENT_KEYNAME]=this.getSubmittedText(),t},t}();!function(t){var e=function(){function t(){}return t}();t.CommentComponentData=e}(r||(r={})),e.exports=r},{"./../Api/ISurveyComponent":11}],28:[function(t,e,n){"use strict";var i=t("./../Api/IPromptComponent"),r=t("./../Api/ISurveyComponent"),o=function(){function t(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");if(!t.title)throw new Error("data.title must not be null or empty");if(!t.yesButtonLabel)throw new Error("data.yesButtonLabel must not be null or empty");if(!t.noButtonLabel)throw new Error("data.noButtonLabel must not be null or empty");this.data=t,this.selectedButton=i.PromptButton.Unselected}return t.make=function(e){try{return new t(e)}catch(t){return null}},t.prototype.getType=function(){return r.Type.Prompt},t.prototype.getTitle=function(){return this.data.title},t.prototype.getQuestion=function(){return this.data.question},t.prototype.getYesButtonText=function(){return this.data.yesButtonLabel},t.prototype.getNoButtonText=function(){return this.data.noButtonLabel},t.prototype.setButtonSelected=function(t){t&&(this.selectedButton=t)},t.prototype.getButtonSelected=function(){return this.selectedButton},t.prototype.getDomElements=function(t){
if(!t)throw new Error("Document must not be null");var e=t.createElement(r.DOM_PROMPT_TAGNAME);return e.appendChild(t.createTextNode(this.promptButtonToString(this.getButtonSelected()))),[e]},t.prototype.getJsonElements=function(){var t={};return t[r.JSON_PROMPT_KEYNAME]=this.promptButtonToString(this.getButtonSelected()),t},t.prototype.promptButtonToString=function(t){switch(t){case i.PromptButton.Unselected:return"Unselected";case i.PromptButton.Yes:return"Yes";case i.PromptButton.No:return"No";default:return"Unknown"}},t}();!function(t){var e=function(){function t(){}return t}();t.PromptComponentData=e}(o||(o={})),e.exports=o},{"./../Api/IPromptComponent":9,"./../Api/ISurveyComponent":11}],29:[function(t,e,n){"use strict";var i=t("./../Api/ISurveyComponent"),r=function(){function t(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");if(!t.ratingValuesAscending||t.ratingValuesAscending.length<2)throw new Error("data.ratingValuesAscending must not be null or have less than two choices");t.ratingValuesAscending.forEach(function(t){if(!t)throw new Error("rating values must not contain null or empty")}),this.data=t,this.selectedIndex=-1}return t.make=function(e){try{return new t(e)}catch(t){return null}},t.prototype.getType=function(){return i.Type.Rating},t.prototype.getQuestion=function(){return this.data.question},t.prototype.getRatingValuesAscending=function(){return this.data.ratingValuesAscending},t.prototype.getSelectedRating=function(){return this.isRatingIndexValid(this.selectedIndex)?this.data.ratingValuesAscending[this.selectedIndex]:""},t.prototype.setSelectedRatingIndex=function(t){this.isRatingIndexValid(t)?this.selectedIndex=t:this.selectedIndex=-1},t.prototype.getSelectedRatingIndex=function(){return this.selectedIndex},t.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(i.DOM_RATING_TAGNAME);return this.isRatingIndexValid(this.getSelectedRatingIndex())?e.appendChild(t.createTextNode(this.getNormalizedRatingScore().toFixed(6))):e.appendChild(t.createTextNode("Not rated")),[e]},t.prototype.getJsonElements=function(){var t={};return this.isRatingIndexValid(this.getSelectedRatingIndex())?t[i.JSON_RATING_KEYNAME]=this.getNormalizedRatingScore():t[i.JSON_RATING_KEYNAME]="Not rated",t},t.prototype.isRatingIndexValid=function(t){return t>=0&&t<this.data.ratingValuesAscending.length},t.prototype.getNormalizedRatingScore=function(){return this.isRatingIndexValid(this.getSelectedRatingIndex())?this.data.isZeroBased?this.selectedIndex/(this.data.ratingValuesAscending.length-1):(this.selectedIndex+1)/this.data.ratingValuesAscending.length:0},t}();!function(t){var e=function(){function t(){}return t}();t.RatingComponentData=e}(r||(r={})),e.exports=r},{"./../Api/ISurveyComponent":11}],30:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./ActivityTrackingData"),r=t("./ActivityTrackingSet"),o=t("./ISurveyEvent"),a=function(){function t(t){if(!t)throw new Error("data must not be null");if(t.count<=0)throw new Error("count must be greater than 0");if(!t.activity||0===t.activity.length)throw new Error("activity must not be null or an empty string");this.data=t}return t.make=function(e){try{return new t(e)}catch(t){return null}},t.prototype.getActivity=function(){return this.data.activity},t.prototype.getCount=function(){return this.data.count},t.prototype.isAggregate=function(){return this.data.isAggregate},t.prototype.getType=function(){return o.Type.CountedActivity},t.prototype.getTrackingSet=function(){var t=new Array;return t.push(new i.ActivityTrackingData(this.data.activity,this.data.count,this.data.isAggregate)),new r.ActivityTrackingSet((!1),t)},t}();n.CountedActivityEvent=a;var s=function(){function t(){}return t}();n.CountedActivityEventData=s;var u=function(){function t(t){if(!t)throw new Error("data must not be null");if(!t.sequence)throw new Error("data.sequence must not be null");if(0===t.sequence.length)throw new Error("data.sequence size must be greater than 0");this.data=[];for(var e=0,n=t.sequence;e<n.length;e++){var i=n[e];this.data.push(new a(i))}}return t.make=function(e){try{return new t(e)}catch(t){return null}},t.prototype.getSequence=function(){return this.data},t.prototype.getType=function(){return o.Type.CountedActivitySequence},t.prototype.getTrackingSet=function(){for(var t=new Array,e=0,n=this.data;e<n.length;e++){var o=n[e];t.push(new i.ActivityTrackingData(o.getActivity(),o.getCount(),o.isAggregate()))}return new r.ActivityTrackingSet((!0),t)},t}();n.CountedActivitySequenceEvent=u;var l=function(){function t(){}return t.prototype.CountedActivitySequenceEventData=function(){},t}();n.CountedActivitySequenceEventData=l},{"./ActivityTrackingData":3,"./ActivityTrackingSet":4,"./ISurveyEvent":22}],31:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){this.Surveys={},this.Surveys={}}return t.prototype.addStats=function(t,e){this.Surveys[t]=e},t.prototype.getBySurveyId=function(t){return this.Surveys[t]},t.prototype.getStats=function(){return this.Surveys},t}();n.SurveyStatCollection=i},{}],32:[function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=t("./Api/IFloodgateStorageProvider"),o=r.FileType,a=t("./Api/ISurvey"),s=t("./Constants"),u=t("./FloodgateEngine"),l=t("./StateProviderHelpers"),c=t("./SurveyStatCollection"),d=t("./Utils"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.fromJson=function(t){var n=new e;if(!t)return u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Input json is null or empty."}),n;var i;try{i=JSON.parse(t)}catch(t){return u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+t.toString()}),n}return n.deserialize(i)?n:new e},e.toJson=function(t){return t||(u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.SurveyStatCollectionActivation.ToJson.Failed,{ErrorMessage:"Input json is null or empty."}),t=new e),JSON.stringify(t)},e.prototype.accumulate=function(t){if(t){var e=t.getStats();for(var n in e)e.hasOwnProperty(n)&&this.addStats(n,e[n])}},e.prototype.deserialize=function(t){var e=t.Surveys,n=new Date;for(var i in e)if(e.hasOwnProperty(i)){var r=new m;r.deserialize(e[i])&&r.ExpirationTimeUtc>n&&this.addStats(i,r)}return this.validate()},e.prototype.validate=function(){return d.isObject(this.getStats())},e}(c.SurveyStatCollection);n.SurveyStatCollectionActivation=p;var g=function(){function t(){}return t.make=function(t,e){return e?new f(t,e):new h(t)},t}();n.SurveyActivationStatsProviderFactory=g;var f=function(){function t(t,e){if(!e)throw new Error("host-based storage must not be null");this.hostBasedStorage=e,t&&(this.fileBasedStorageProvider=new h(t))}return t.prototype.load=function(){var t=this.getSurveyStatsFromHost(),e=new p;this.fileBasedStorageProvider&&(e=this.fileBasedStorageProvider.load());var n=l.MergeAndUpdateSurveyActivationStats(e,t);return n.find(l.StateListType.Merged)},t.prototype.save=function(t){if(t){var e=this.getSurveyStatsFromHost(),n=l.MergeAndUpdateSurveyActivationStats(t,e),i=n.find(l.StateListType.ToBeUpdated),r=n.find(l.StateListType.Merged);if(i){var a=i.getStats();for(var s in a)if(a.hasOwnProperty(s)){var u=l.makeSettingItemValue(JSON.stringify(a[s]));this.hostBasedStorage.upsertSettingItem(o[o.SurveyActivationStats],s,u)}}this.fileBasedStorageProvider&&this.fileBasedStorageProvider.save(r)}},t.prototype.getSurveyStatsFromHost=function(){var t=new p,e=this.hostBasedStorage.readSettingList(o[o.SurveyActivationStats]);for(var n in e)if(e.hasOwnProperty(n)){var i=l.extractSettingItemValueSubString(e[n]),r=new m,a=void 0;try{a=JSON.parse(i)}catch(t){u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.HostBasedSurveyActivationStatsProvider.GetSurveyStatsFromHost.Failed,{ErrorMessage:"Json parsing failed. "+t.toString()})}r.deserialize(a);var c=new Date;r.ExpirationTimeUtc<=c?this.hostBasedStorage.deleteSettingItem(o[o.SurveyActivationStats],n):t.addStats(n,r)}return t},t}();n.HostBasedSurveyActivationStatsProvider=f;var h=function(){function t(t){if(!t)throw new Error("storage must not be null");this.storage=t}return t.prototype.load=function(){var t=this.storage.read(r.FileType.SurveyActivationStats);return t?p.fromJson(t):new p},t.prototype.save=function(t){if(t){var e=p.toJson(t);this.storage.write(r.FileType.SurveyActivationStats,e)}},t}();n.FileBasedSurveyActivationStatsProvider=h;var m=function(){function t(){}return t.prototype.deserialize=function(t){return this.ActivationTimeUtc=t.ActivationTimeUtc,this.ExpirationTimeUtc=t.ExpirationTimeUtc,this.Type=t.Type,this.validate()},t.prototype.validate=function(){return!!d.isUtcDatetimeString(this.ActivationTimeUtc)&&(this.ActivationTimeUtc=d.stringToDate(this.ActivationTimeUtc),!!d.isUtcDatetimeString(this.ExpirationTimeUtc)&&(this.ExpirationTimeUtc=d.stringToDate(this.ExpirationTimeUtc),d.isEnumValue(this.Type,a.Type)))},t}();n.SurveyActivationStats=m},{"./Api/IFloodgateStorageProvider":7,"./Api/ISurvey":10,"./Constants":16,"./FloodgateEngine":17,"./StateProviderHelpers":25,"./SurveyStatCollection":31,"./Utils":38}],33:[function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=t("./Constants"),o=t("./FloodgateEngine"),a=t("./SurveyStatCollection"),s=t("./Utils"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.fromJson=function(t){var n=new e;if(!t)return o.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Input json is null or empty."}),n;var i;try{i=JSON.parse(t)}catch(t){return o.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+t.toString()}),n}return n.deserialize(i)?n:new e},e.toJson=function(t){return t||(o.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.SurveyStatCollectionEventActivity.ToJson.Failed,{ErrorMessage:"Input json is null or empty."}),t=new e),JSON.stringify(t)},e.prototype.accumulate=function(t){if(t){var e=t.getStats();for(var n in e)if(e.hasOwnProperty(n)){var i=this.getBySurveyId(n);if(i||(i=new l,i.Counts=[],this.addStats(n,i)),i.ExpirationTimeUtc=e[n].ExpirationTimeUtc,i.Counts.length<e[n].Counts.length){var r=i.Counts.slice();i.Counts=r}for(var o=0;o<e[n].Counts.length;o++)i.Counts[o]||(i.Counts[o]=0),i.Counts[o]+=e[n].Counts[o]}}},e.prototype.deserialize=function(t){var e=t.Surveys,n=new Date;for(var i in e)if(e.hasOwnProperty(i)){var r=new l;r.deserialize(e[i])&&r.ExpirationTimeUtc>n&&this.addStats(i,r)}return this.validate()},e.prototype.validate=function(){return s.isObject(this.getStats())},e}(a.SurveyStatCollection);n.SurveyStatCollectionEventActivity=u;var l=function(){function t(){}return t.prototype.deserialize=function(t){return this.ExpirationTimeUtc=t.ExpirationTimeUtc,this.Counts=t.Counts,this.validate()},t.prototype.validate=function(){if(!this.Counts)return!1;for(var t=0;t<this.Counts.length;t++){var e=this.Counts[t];if(!s.isNumber(e))return!1;e<0&&(this.Counts[t]=0)}return!!s.isUtcDatetimeString(this.ExpirationTimeUtc)&&(this.ExpirationTimeUtc=s.stringToDate(this.ExpirationTimeUtc),!0)},t}();n.SurveyEventActivityStats=l},{"./Constants":16,"./FloodgateEngine":17,"./SurveyStatCollection":31,"./Utils":38}],34:[function(t,e,n){"use strict";var i=t("../Api/ISurvey"),r=t("../Api/ISurveyComponent"),o=t("../SurveyComponents/CommentComponent"),a=t("../SurveyComponents/PromptComponent"),s=t("../SurveyComponents/RatingComponent"),u=t("../Utils"),l=t("./SurveyDataSource"),c=function(){function t(t){if(u.isNullOrUndefined(t))throw new Error("data must not be null");this.surveyInfo=new l(t.baseData),this.prompt=new a(t.promptData),this.question=new o(t.commentData),this.rating=new s(t.ratingData)}return t.make=function(e){try{return new t(e)}catch(t){return null}},t.makeFps=function(e,n,i){if(u.isNullOrUndefined(e)||u.isNullOrUndefined(n)||u.isNullOrUndefined(i))return null;var r=[],l=i.content;if(u.isNullOrUndefined(l)||u.isNullOrUndefined(l.comment)||u.isNullOrUndefined(l.prompt)||u.isNullOrUndefined(l.rating))return null;var c=new t.FpsSurveyData;c.baseData=e,c.promptData=new a.PromptComponentData,c.ratingData=new s.RatingComponentData,c.commentData=new o.CommentComponentData,c.promptData.title=n.getCustomString(l.prompt.title),c.promptData.question=n.getCustomString(l.prompt.question),c.promptData.yesButtonLabel=n.getCustomString(l.prompt.yesLabel),c.promptData.noButtonLabel=n.getCustomString(l.prompt.noLabel),c.ratingData.question=n.getCustomString(l.rating.question),c.ratingData.isZeroBased=l.rating.isZeroBased,c.commentData.question=n.getCustomString(l.comment.question);for(var d=0,p=l.rating.ratingValuesAscending;d<p.length;d++){var g=p[d],f=n.getCustomString(g);if(u.isNullOrUndefined(f))return null;r.push(f)}return c.ratingData.ratingValuesAscending=r,u.isNullOrUndefined(c.ratingData.question)||u.isNullOrUndefined(c.commentData.question)||u.isNullOrUndefined(c.promptData.title)||u.isNullOrUndefined(c.promptData.question)||u.isNullOrUndefined(c.promptData.yesButtonLabel)||u.isNullOrUndefined(c.promptData.noButtonLabel)||u.isNullOrUndefined(c.ratingData.ratingValuesAscending)?null:this.make(c)},t.prototype.getType=function(){return i.Type.Fps},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getCommentComponent=function(){return this.question},t.prototype.getPromptComponent=function(){return this.prompt},t.prototype.getRatingComponent=function(){return this.rating},t.prototype.getComponent=function(t){switch(t){case r.Type.Comment:return this.getCommentComponent();case r.Type.Prompt:return this.getPromptComponent();case r.Type.Rating:return this.getRatingComponent();default:return null}},t.prototype.getDomElements=function(t){if(u.isNullOrUndefined(t))throw new Error("Document must not be null");var e=t.createElement(i.DOM_FPS_TAGNAME);return this.getSurveyInfo().getDomElements(t).forEach(function(t){u.isNullOrUndefined(t)||e.appendChild(t)}),this.getCommentComponent().getDomElements(t).forEach(function(t){u.isNullOrUndefined(t)||e.appendChild(t)}),this.getRatingComponent().getDomElements(t).forEach(function(t){u.isNullOrUndefined(t)||e.appendChild(t)}),[e]},t.prototype.getJsonElements=function(){var t={};return t=u.overrideValues(this.getSurveyInfo().getJsonElements(),t),t=u.overrideValues(this.getCommentComponent().getJsonElements(),t),t=u.overrideValues(this.getRatingComponent().getJsonElements(),t)},t}();!function(t){var e=function(){function t(){}return t}();t.FpsSurveyData=e}(c||(c={})),e.exports=c},{"../Api/ISurvey":10,"../Api/ISurveyComponent":11,"../SurveyComponents/CommentComponent":27,"../SurveyComponents/PromptComponent":28,"../SurveyComponents/RatingComponent":29,"../Utils":38,"./SurveyDataSource":37}],35:[function(t,e,n){"use strict";var i=t("../Api/ISurvey"),r=t("../Api/ISurveyComponent"),o=t("../SurveyComponents/CommentComponent"),a=t("../SurveyComponents/PromptComponent"),s=t("../SurveyComponents/RatingComponent"),u=t("../Utils"),l=t("./SurveyDataSource"),c=function(){function t(t){if(u.isNullOrUndefined(t))throw new Error("data must not be null");this.surveyInfo=new l(t.baseData),this.prompt=new a(t.promptData),this.question=new o(t.commentData),this.rating=new s(t.ratingData)}return t.make=function(e){try{return new t(e)}catch(t){return null}},t.makeNlqs=function(e,n,i){if(u.isNullOrUndefined(e)||u.isNullOrUndefined(n)||u.isNullOrUndefined(i))return null;var r=[],l=i.content;if(u.isNullOrUndefined(l)||u.isNullOrUndefined(l.comment)||u.isNullOrUndefined(l.prompt)||u.isNullOrUndefined(l.rating))return null;var c=new t.NlqsSurveyData;c.baseData=e,c.promptData=new a.PromptComponentData,c.ratingData=new s.RatingComponentData,c.commentData=new o.CommentComponentData,c.promptData.title=n.getCustomString(l.prompt.title),c.promptData.question=n.getCustomString(l.prompt.question),c.promptData.yesButtonLabel=n.getCustomString(l.prompt.yesLabel),c.promptData.noButtonLabel=n.getCustomString(l.prompt.noLabel),c.ratingData.question=n.getCustomString(l.rating.question),c.ratingData.isZeroBased=l.rating.isZeroBased,c.commentData.question=n.getCustomString(l.comment.question);for(var d=0,p=l.rating.ratingValuesAscending;d<p.length;d++){var g=p[d],f=n.getCustomString(g);if(u.isNullOrUndefined(f))return null;r.push(f)}return c.ratingData.ratingValuesAscending=r,u.isNullOrUndefined(c.ratingData.question)||u.isNullOrUndefined(c.commentData.question)||u.isNullOrUndefined(c.promptData.title)||u.isNullOrUndefined(c.promptData.question)||u.isNullOrUndefined(c.promptData.yesButtonLabel)||u.isNullOrUndefined(c.promptData.noButtonLabel)||u.isNullOrUndefined(c.ratingData.ratingValuesAscending)?null:this.make(c)},t.prototype.getType=function(){return i.Type.Nlqs},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getCommentComponent=function(){return this.question},t.prototype.getPromptComponent=function(){return this.prompt},t.prototype.getRatingComponent=function(){return this.rating},t.prototype.getComponent=function(t){switch(t){case r.Type.Comment:return this.getCommentComponent();case r.Type.Prompt:return this.getPromptComponent();case r.Type.Rating:return this.getRatingComponent();default:return null}},t.prototype.getDomElements=function(t){if(u.isNullOrUndefined(t))throw new Error("Document must not be null");var e=t.createElement(i.DOM_NLQS_TAGNAME);return this.getSurveyInfo().getDomElements(t).forEach(function(t){u.isNullOrUndefined(t)||e.appendChild(t)}),this.getCommentComponent().getDomElements(t).forEach(function(t){u.isNullOrUndefined(t)||e.appendChild(t)}),this.getRatingComponent().getDomElements(t).forEach(function(t){u.isNullOrUndefined(t)||e.appendChild(t)}),[e]},t.prototype.getJsonElements=function(){var t={};return t=u.overrideValues(this.getSurveyInfo().getJsonElements(),t),t=u.overrideValues(this.getCommentComponent().getJsonElements(),t),t=u.overrideValues(this.getRatingComponent().getJsonElements(),t)},t}();!function(t){var e=function(){function t(){}return t}();t.NlqsSurveyData=e}(c||(c={})),e.exports=c},{"../Api/ISurvey":10,"../Api/ISurveyComponent":11,"../SurveyComponents/CommentComponent":27,"../SurveyComponents/PromptComponent":28,"../SurveyComponents/RatingComponent":29,"../Utils":38,"./SurveyDataSource":37}],36:[function(t,e,n){"use strict";var i=t("../Api/IFloodgateStringProvider"),r=t("../Api/ISurvey"),o=t("../Api/ISurveyComponent"),a=t("../SurveyComponents/CommentComponent"),s=t("../SurveyComponents/PromptComponent"),u=t("../SurveyComponents/RatingComponent"),l=t("../Utils"),c=t("./SurveyDataSource"),d=function(){function t(t){if(!t)throw new Error("data must not be null");this.surveyInfo=new c(t.baseData),this.prompt=new s(t.promptData),this.question=new a(t.commentData),this.rating=new u(t.ratingData)}return t.make=function(e){try{return new t(e)}catch(t){return null}},t.makeCustom=function(e,n,i){if(l.isNullOrUndefined(e)||l.isNullOrUndefined(n)||l.isNullOrUndefined(i))return null;var r=[],o=i.content;if(l.isNullOrUndefined(o)||l.isNullOrUndefined(o.comment)||l.isNullOrUndefined(o.prompt)||l.isNullOrUndefined(o.rating))return null;var c=new t.NpsSurveyData;c.baseData=e,c.promptData=new s.PromptComponentData,c.ratingData=new u.RatingComponentData,c.commentData=new a.CommentComponentData,c.promptData.title=n.getCustomString(o.prompt.title),c.promptData.question=n.getCustomString(o.prompt.question),c.promptData.yesButtonLabel=n.getCustomString(o.prompt.yesLabel),c.promptData.noButtonLabel=n.getCustomString(o.prompt.noLabel),c.ratingData.question=n.getCustomString(o.rating.question),c.ratingData.isZeroBased=o.rating.isZeroBased,c.commentData.question=n.getCustomString(o.comment.question);for(var d=0,p=o.rating.ratingValuesAscending;d<p.length;d++){var g=p[d],f=n.getCustomString(g);if(l.isNullOrUndefined(f))return null;r.push(f)}return c.ratingData.ratingValuesAscending=r,l.isNullOrUndefined(c.ratingData.question)||l.isNullOrUndefined(c.commentData.question)||l.isNullOrUndefined(c.promptData.title)||l.isNullOrUndefined(c.promptData.question)||l.isNullOrUndefined(c.promptData.yesButtonLabel)||l.isNullOrUndefined(c.promptData.noButtonLabel)||l.isNullOrUndefined(c.ratingData.ratingValuesAscending)?null:this.make(c)},t.make5Point=function(e,n){if(!e||!n)return null;var r=new t.NpsSurveyData;r.baseData=e,r.ratingData=new u.RatingComponentData,r.ratingData.isZeroBased=!1,r.commentData=new a.CommentComponentData,r.promptData=new s.PromptComponentData,r.ratingData.question=n.loadStringResource(i.StringType.NpsRatingQuestion),r.commentData.question=n.loadStringResource(i.StringType.NpsCommentQuestion),r.promptData.title=n.loadStringResource(i.StringType.NpsPromptTitle),r.promptData.question=n.loadStringResource(i.StringType.NpsPromptQuestion),r.promptData.yesButtonLabel=n.loadStringResource(i.StringType.NpsPromptYesLabel),r.promptData.noButtonLabel=n.loadStringResource(i.StringType.NpsPromptNotNowLabel);var o=new Array(5);return o[0]=n.loadStringResource(i.StringType.Nps5RatingValue1),o[1]=n.loadStringResource(i.StringType.Nps5RatingValue2),o[2]=n.loadStringResource(i.StringType.Nps5RatingValue3),o[3]=n.loadStringResource(i.StringType.Nps5RatingValue4),o[4]=n.loadStringResource(i.StringType.Nps5RatingValue5),r.ratingData.question&&r.commentData.question&&r.promptData.title&&r.promptData.question&&r.promptData.yesButtonLabel&&r.promptData.noButtonLabel&&o[0]&&o[1]&&o[2]&&o[3]&&o[4]?(r.ratingData.ratingValuesAscending=o,this.make(r)):null},t.make11Point=function(e,n){if(!e||!n)return null;var r=new t.NpsSurveyData;r.baseData=e,r.ratingData=new u.RatingComponentData,r.ratingData.isZeroBased=!0,r.commentData=new a.CommentComponentData,r.promptData=new s.PromptComponentData,r.ratingData.question=n.loadStringResource(i.StringType.NpsRatingQuestion),r.commentData.question=n.loadStringResource(i.StringType.NpsCommentQuestion),r.promptData.title=n.loadStringResource(i.StringType.NpsPromptTitle),r.promptData.question=n.loadStringResource(i.StringType.NpsPromptQuestion),r.promptData.yesButtonLabel=n.loadStringResource(i.StringType.NpsPromptYesLabel),r.promptData.noButtonLabel=n.loadStringResource(i.StringType.NpsPromptNotNowLabel);var o=new Array(11);return o[0]=n.loadStringResource(i.StringType.Nps11RatingValue0),o[1]=n.loadStringResource(i.StringType.Nps11RatingValue1),o[2]=n.loadStringResource(i.StringType.Nps11RatingValue2),o[3]=n.loadStringResource(i.StringType.Nps11RatingValue3),o[4]=n.loadStringResource(i.StringType.Nps11RatingValue4),o[5]=n.loadStringResource(i.StringType.Nps11RatingValue5),o[6]=n.loadStringResource(i.StringType.Nps11RatingValue6),o[7]=n.loadStringResource(i.StringType.Nps11RatingValue7),o[8]=n.loadStringResource(i.StringType.Nps11RatingValue8),o[9]=n.loadStringResource(i.StringType.Nps11RatingValue9),o[10]=n.loadStringResource(i.StringType.Nps11RatingValue10),r.ratingData.question&&r.commentData.question&&r.promptData.title&&r.promptData.question&&r.promptData.yesButtonLabel&&r.promptData.noButtonLabel&&o[0]&&o[1]&&o[2]&&o[3]&&o[4]&&o[5]&&o[6]&&o[7]&&o[8]&&o[9]&&o[10]?(r.ratingData.ratingValuesAscending=o,this.make(r)):null},t.prototype.getType=function(){return r.Type.Nps},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getCommentComponent=function(){return this.question},t.prototype.getPromptComponent=function(){return this.prompt},t.prototype.getRatingComponent=function(){return this.rating},t.prototype.getComponent=function(t){switch(t){case o.Type.Comment:return this.getCommentComponent();case o.Type.Prompt:return this.getPromptComponent();case o.Type.Rating:return this.getRatingComponent();default:return null}},t.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(r.DOM_NPS_TAGNAME);return this.getSurveyInfo().getDomElements(t).forEach(function(t){t&&e.appendChild(t)}),this.getCommentComponent().getDomElements(t).forEach(function(t){t&&e.appendChild(t)}),this.getRatingComponent().getDomElements(t).forEach(function(t){t&&e.appendChild(t)}),[e]},t.prototype.getJsonElements=function(){var t={};return t=l.overrideValues(this.getSurveyInfo().getJsonElements(),t),t=l.overrideValues(this.getCommentComponent().getJsonElements(),t),t=l.overrideValues(this.getRatingComponent().getJsonElements(),t)},t}();!function(t){var e=function(){function t(){}return t}();t.NpsSurveyData=e}(d||(d={})),e.exports=d},{"../Api/IFloodgateStringProvider":8,"../Api/ISurvey":10,"../Api/ISurveyComponent":11,"../SurveyComponents/CommentComponent":27,"../SurveyComponents/PromptComponent":28,"../SurveyComponents/RatingComponent":29,"../Utils":38,"./SurveyDataSource":37}],37:[function(t,e,n){"use strict";var i=t("../GovernedChannel"),r=t("../ISurveyInfo"),o=t("../Utils"),a=function(){function t(t){if(o.isNullOrUndefined(t))throw new Error("data must not be null");if(o.isNullOrUndefined(t.id)||""===t.id)throw new Error("data.id must not be null or empty");if(o.isNullOrUndefined(t.governedChannelType)&&(t.governedChannelType=i.GovernedChannelType.getDefault()),o.isNullOrUndefined(t.expirationTimeUtc)||""===t.expirationTimeUtc)throw new Error("data.expirationTimeUtc must not be null or empty");if(o.isNullOrUndefined(t.activationEvent))throw new Error("data.activationEvent must not be null");(o.isNullOrUndefined(t.backEndIdentifier)||""===t.backEndIdentifier)&&(t.backEndIdentifier=t.id),this.data=t}return t.prototype.getId=function(){return this.data.id},t.prototype.getBackEndId=function(){return this.data.backEndIdentifier},t.prototype.getGovernedChannelType=function(){return this.data.governedChannelType},t.prototype.getRawStartTimeUtc=function(){return this.data.startTimeUtc},t.prototype.getStartTimeUtc=function(){if(o.isNullOrUndefined(this.data.startTimeUtc))return o.getDistantPast();var t=new Date(this.data.startTimeUtc);return o.isDate(t)?t:o.getDistantFuture()},t.prototype.getExpirationTimeUtc=function(){if(o.isNullOrUndefined(this.data.expirationTimeUtc))return o.getDistantPast();var t=new Date(this.data.expirationTimeUtc);return o.isDate(t)?t:o.getDistantPast()},t.prototype.getRawExpirationTimeUtc=function(){return this.data.expirationTimeUtc},t.prototype.isActiveForDate=function(t){return!o.isNullOrUndefined(t)&&(t>=this.getStartTimeUtc()&&t<=this.getExpirationTimeUtc())},t.prototype.getActivationEvent=function(){return this.data.activationEvent},t.prototype.getPreferredLaunchType=function(){return this.data.preferredLaunchType},t.prototype.isAdditionalDataRequested=function(t){for(var e=0,n=this.data.additionalDataRequested;e<n.length;e++){var i=n[e];if(i===t)return!0}return!1},t.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(r.DOM_TYPE_TAGNAME);e.appendChild(t.createTextNode(r.DOM_TYPE_VALUE));var n=t.createElement(r.DOM_ID_TAGNAME);return n.appendChild(t.createTextNode(this.getBackEndId())),[e,n]},t.prototype.getJsonElements=function(){var t={};t[r.JSON_ID_KEYNAME]=this.getBackEndId();var e={};return e[r.JSON_SURVEY_KEYNAME]=t,e},t}();!function(t){var e=function(){function t(){this.preferredLaunchType=r.LaunchType.Default}return t}();t.SurveyDataSourceData=e}(a||(a={})),e.exports=a},{"../GovernedChannel":19,"../ISurveyInfo":23,"../Utils":38}],38:[function(t,e,n){"use strict";function i(t,e,n){switch(e.toLowerCase()){case"h":case"hour":return new Date(t.getTime()+36e5*n);case"m":case"minute":return new Date(t.getTime()+6e4*n);case"s":case"second":return new Date(t.getTime()+1e3*n);default:throw new Error("Invalid interval value of "+e)}}function r(t){return"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.getTime())}function o(t,e){return t in e}function a(t){return null!==t&&!isNaN(t)&&isFinite(t)}function s(t){return null===t||void 0===t}function u(t){return null!==t&&void 0!==t&&"object"==typeof t}function l(t){return"string"==typeof t}function c(t){return"boolean"==typeof t}function d(){return new Date((-116444736e5))}function p(){return new Date(640922112e5)}function g(t,e){if(!t)return null;if(e<0)return f(t,-1*e);var i=t.getTime()+1e3*e;return i<n.MAX_DATE_MILLISECONDS?new Date(i):new Date(n.MAX_DATE_MILLISECONDS)}function f(t,e){if(!t)return null;if(e<0)return e=-e,this.addSecondsWithoutOverflow(t,e);var i=t.getTime()-1e3*e;return i>n.MIN_DATE_MILLISECONDS?new Date(i):new Date(n.MIN_DATE_MILLISECONDS)}function h(t){if(!t)return!1;var e=m(t);return!!e&&e===t}function m(t){if(!t)return null;var e=t.match(I);return!e||e.length<1||!s(e[4])?null:e[0]}function v(){return(y()+y()+"-"+y()+"-4"+y().substr(0,3)+"-"+y()+"-"+y()+y()+y()).toLowerCase()}function y(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function S(t){var e=Object.keys(t);e.sort();var n=[];for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];n.push(t[r])}return n}function b(t){if(!l(t))return null;var e=t?new Date(t):null;return r(e)?e:null}function C(t,e){if(!e)return e;var n=e;if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function T(t){if(!l(t))return!1;var e=/^(\d{4}\-\d\d\-\d\dT\d\d:\d\d:\d\d(\.\d\d\d)?Z)$/;return e.test(t)}function w(t){function e(t){return t<10?"0"+t:t.toString()}return r(t)?t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"Z":null}Object.defineProperty(n,"__esModule",{value:!0}),n.timeAdd=i,n.isDate=r,n.isEnumValue=o,n.isNumber=a,n.isNullOrUndefined=s,n.isObject=u,n.isString=l,n.isBoolean=c,n.getDistantPast=d,n.getDistantFuture=p,n.MAX_DATE_MILLISECONDS=864e13,n.MIN_DATE_MILLISECONDS=-864e13,n.addSecondsWithoutOverflow=g,n.subtractSecondsWithoutOverflow=f;var I="^((?:[a-zA-Z]{2,3}(?:-[a-zA-Z]{3}){0,3})|(?:[a-zA-Z]{4,8}))(?:-([a-zA-Z]{4}))?(?:-([a-zA-Z]{2}|[0-9]{3}))?(-.*)?$";n.isValidLanguageSubTag=h,n.extractLanguageSubtag=m,n.guid=v,n.makeArrayFromObjectValuesSortedByKeyString=S,n.stringToDate=b,n.overrideValues=C,n.isUtcDatetimeString=T,n.dateToShortUtcString=w},{}],39:[function(t,e,n){(function(i,r){!function(t,i){"object"==typeof n&&"undefined"!=typeof e?e.exports=i():"function"==typeof define&&define.amd?define(i):t.ES6Promise=i()}(this,function(){"use strict";function e(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function n(t){return"function"==typeof t}function o(t){j=t}function a(t){Q=t}function s(){return function(){return i.nextTick(p)}}function u(){return"undefined"!=typeof H?function(){H(p)}:d()}function l(){var t=0,e=new Y(p),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function c(){var t=new MessageChannel;return t.port1.onmessage=p,function(){return t.port2.postMessage(0)}}function d(){var t=setTimeout;return function(){return t(p,1)}}function p(){for(var t=0;t<z;t+=2){var e=$[t],n=$[t+1];e(n),$[t]=void 0,$[t+1]=void 0}z=0}function g(){try{var t=Function("return this")().require("vertx");return H=t.runOnLoop||t.runOnContext,u()}catch(t){return d()}}function f(t,e){var n=this,i=new this.constructor(m);void 0===i[et]&&k(i);
var r=n._state;if(r){var o=arguments[r-1];Q(function(){return O(r,i,o,n._result)})}else D(n,i,t,e);return i}function h(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(m);return I(n,t),n}function m(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function S(t){try{return t.then}catch(t){return ot.error=t,ot}}function b(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}function C(t,e,n){Q(function(t){var i=!1,r=b(n,e,function(n){i||(i=!0,e!==n?I(t,n):E(t,n))},function(e){i||(i=!0,F(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&r&&(i=!0,F(t,r))},t)}function T(t,e){e._state===it?E(t,e._result):e._state===rt?F(t,e._result):D(e,void 0,function(e){return I(t,e)},function(e){return F(t,e)})}function w(t,e,i){e.constructor===t.constructor&&i===f&&e.constructor.resolve===h?T(t,e):i===ot?(F(t,ot.error),ot.error=null):void 0===i?E(t,e):n(i)?C(t,e,i):E(t,e)}function I(t,n){t===n?F(t,v()):e(n)?w(t,n,S(n)):E(t,n)}function A(t){t._onerror&&t._onerror(t._result),x(t)}function E(t,e){t._state===nt&&(t._result=e,t._state=it,0!==t._subscribers.length&&Q(x,t))}function F(t,e){t._state===nt&&(t._state=rt,t._result=e,Q(A,t))}function D(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+it]=n,r[o+rt]=i,0===o&&t._state&&Q(x,t)}function x(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,r=void 0,o=t._result,a=0;a<e.length;a+=3)i=e[a],r=e[a+n],i?O(n,i,r,o):r(o);t._subscribers.length=0}}function N(t,e){try{return t(e)}catch(t){return ot.error=t,ot}}function O(t,e,i,r){var o=n(i),a=void 0,s=void 0,u=void 0,l=void 0;if(o){if(a=N(i,r),a===ot?(l=!0,s=a.error,a.error=null):u=!0,e===a)return void F(e,y())}else a=r,u=!0;e._state!==nt||(o&&u?I(e,a):l?F(e,s):t===it?E(e,a):t===rt&&F(e,a))}function _(t,e){try{e(function(e){I(t,e)},function(e){F(t,e)})}catch(e){F(t,e)}}function B(){return at++}function k(t){t[et]=at++,t._state=void 0,t._result=void 0,t._subscribers=[]}function P(){return new Error("Array Methods must be provided an Array")}function L(t){return new st(this,t).promise}function U(t){var e=this;return new e(q(t)?function(n,i){for(var r=t.length,o=0;o<r;o++)e.resolve(t[o]).then(n,i)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function R(t){var e=this,n=new e(m);return F(n,t),n}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function V(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function G(){var t=void 0;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=ut}var W=void 0;W=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var q=W,z=0,H=void 0,j=void 0,Q=function(t,e){$[z]=t,$[z+1]=e,z+=2,2===z&&(j?j(p):tt())},J="undefined"!=typeof window?window:void 0,Z=J||{},Y=Z.MutationObserver||Z.WebKitMutationObserver,K="undefined"==typeof self&&"undefined"!=typeof i&&"[object process]"==={}.toString.call(i),X="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,$=new Array(1e3),tt=void 0;tt=K?s():Y?l():X?c():void 0===J&&"function"==typeof t?g():d();var et=Math.random().toString(36).substring(2),nt=void 0,it=1,rt=2,ot={error:null},at=0,st=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(m),this.promise[et]||k(this.promise),q(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&E(this.promise,this._result))):F(this.promise,P())}return t.prototype._enumerate=function(t){for(var e=0;this._state===nt&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===h){var r=S(t);if(r===f&&t._state!==nt)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(n===ut){var o=new n(m);w(o,t,r),this._willSettleAt(o,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(i(t),e)},t.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===nt&&(this._remaining--,t===rt?F(i,n):this._result[e]=n),0===this._remaining&&E(i,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;D(t,void 0,function(t){return n._settledAt(it,e,t)},function(t){return n._settledAt(rt,e,t)})},t}(),ut=function(){function t(e){this[et]=B(),this._result=this._state=void 0,this._subscribers=[],m!==e&&("function"!=typeof e&&M(),this instanceof t?_(this,e):V())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var e=this,n=e.constructor;return e.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})})},t}();return ut.prototype.then=f,ut.all=L,ut.race=U,ut.resolve=h,ut.reject=R,ut._setScheduler=o,ut._setAsap=a,ut._asap=Q,ut.polyfill=G,ut.Promise=ut,ut})}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:40}],40:[function(t,e,n){function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(d===setTimeout)return setTimeout(t,0);if((d===i||!d)&&setTimeout)return d=setTimeout,setTimeout(t,0);try{return d(t,0)}catch(e){try{return d.call(null,t,0)}catch(e){return d.call(this,t,0)}}}function a(t){if(p===clearTimeout)return clearTimeout(t);if((p===r||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function s(){m&&f&&(m=!1,f.length?h=f.concat(h):v=-1,h.length&&u())}function u(){if(!m){var t=o(s);m=!0;for(var e=h.length;e;){for(f=h,h=[];++v<e;)f&&f[v].run();v=-1,e=h.length}f=null,m=!1,a(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var d,p,g=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:i}catch(t){d=i}try{p="function"==typeof clearTimeout?clearTimeout:r}catch(t){p=r}}();var f,h=[],m=!1,v=-1;g.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new l(t,e)),1!==h.length||m||o(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=c,g.addListener=c,g.once=c,g.off=c,g.removeListener=c,g.removeAllListeners=c,g.emit=c,g.prependListener=c,g.prependOnceListener=c,g.listeners=function(t){return[]},g.binding=function(t){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(t){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},{}],41:[function(t,e,n){"use strict";function i(t){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}function r(t){return new h.Promise(function(e,n){var i=document.createElement("script");i.async=!0,i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,e())}:i.onload=function(){e()},i.onerror=function(){n()},i.src=t;var r=window.origin;r&&"null"!==r&&(i.crossOrigin="anonymous");var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(i,o)})}function o(t){g.initialize(t.environment,m,c.default,t.telemetryGroup?t.telemetryGroup.audienceGroup:void 0,t.appId.toString(),t.sessionId,t.build),f.initialize(t.primaryColour,t.secondaryColour)}function a(t){l.setUIStrings(t)}function s(){return new h.Promise(function(t,e){if(v)t();else{if(!p.get().OfficeBrowserFeedback.initOptions)return void e("Window.OfficeBrowserFeedback.initOptions not set");p.get().OfficeBrowserFeedback.sdkVersion=c.default,d.get().setCommonInitOptions(p.get().OfficeBrowserFeedback.initOptions);var n=d.get().getCommonInitOptions();i(n.stylesUrl);var a=n.intlUrl+n.locale.toLowerCase()+"/"+n.intlFilename;r(a).then(function(){return l.getUIStrings()?(o(n),v=!0,void t()):void e("UiStrings were not loaded from "+a)}).catch(function(t){e("Script load failed for "+a)})}})}function u(){v=!1}n.__esModule=!0;var l=t("./UIStrings/UIStrings"),c=t("./Version"),d=t("./Configuration/Configuration"),p=t("./Window/Window"),g=t("./Logging/Logging"),f=t("./Theme"),h=t("es6-promise"),m="OfficeFeedbackSDK",v=!1;n.initialize=s,n.reset=u,p.setSetUiStrings(a)},{"./Configuration/Configuration":44,"./Logging/Logging":56,"./Theme":62,"./UIStrings/UIStrings":67,"./Version":87,"./Window/Window":89,"es6-promise":39}],42:[function(t,e,n){"use strict";function i(){return new A.Promise(function(t,e){return S.default.isStorageAvailable()?void(E?t():d.initialize().then(function(){f.get().OfficeBrowserFeedback.floodgate=f.get().OfficeBrowserFeedback.floodgate||{};var n=f.get().OfficeBrowserFeedback.floodgate.initOptions;if(n=n||{},void 0!==n.campaignDefinitions){var i=w.FilterValidCampaignDefinitions(n.campaignDefinitions);if(i.error)return void e("floodgate.initOptions.campaignDefinitions error: "+i.error);(new S.default).write(I.IFloodgateStorageProvider.FileType.CampaignDefinitions,JSON.stringify(n.campaignDefinitions))}g.get().setFloodgateInitOptions(f.get().OfficeBrowserFeedback.floodgate.initOptions),T.FloodgateEngine.setTelemetryLogger(new C.default),E=!0,t()}).catch(function(t){e("Initialization failed: {"+t+"}")})):void e("window.localStorage is not available.")})}function r(){return new A.Promise(function(t,e){try{c=T.FloodgateEngine.make(g.get().getCommonInitOptions().build?g.get().getCommonInitOptions().build:"",new h.default,g.get().getFloodgateInitOptions().onSurveyActivatedCallback,new S.default,g.get().getFloodgateInitOptions().settingStorageCallback,new b.default,new y.default),c.start()}catch(t){return void e("Failed to start floodgate engine: "+t.toString())}t()})}function o(){c&&c.stop()}function a(){return c}function s(t){return new A.Promise(function(e,n){return F?void n("Control already open"):(g.get().setFloodgateSurvey(t?t:new v.default),p.createSurvey(function(){F=!1}),F=!0,void e())})}function u(t){return s(new m.default(t))}function l(){d.reset(),E=!1,F=!1}n.__esModule=!0;var c,d=t("./App_Common"),p=t("./UI/UI"),g=t("./Configuration/Configuration"),f=t("./Window/Window"),h=t("./FloodgateCore/AdaptiveSurveyLauncherFactory"),m=t("./FloodgateCore/UISurvey/CustomUISurvey"),v=t("./FloodgateCore/UISurvey/DummyUISurvey"),y=t("./FloodgateCore/FloodgateEnvironmentProvider"),S=t("./FloodgateCore/FloodgateStorageProvider"),b=t("./FloodgateCore/FloodgateStringProvider"),C=t("./FloodgateCore/FloodgateTelemetryLogger"),T=t("@ms-ofb/officefloodgatecore"),w=t("@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider"),I=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),A=t("es6-promise"),E=!1,F=!1;n.initialize=i,n.start=r,n.stop=o,n.getEngine=a,n.showSurvey=s,n.showCustomSurvey=u,n.reset=l,f.setFloodgateShowCustomSurvey(u),f.setFloodgateShowSurvey(s),f.setFloodgateGetEngine(a),f.setFloodgateInitialize(i),f.setFloodgateStart(r),f.setFloodgateStop(o)},{"./App_Common":41,"./Configuration/Configuration":44,"./FloodgateCore/AdaptiveSurveyLauncherFactory":46,"./FloodgateCore/FloodgateEnvironmentProvider":47,"./FloodgateCore/FloodgateStorageProvider":48,"./FloodgateCore/FloodgateStringProvider":49,"./FloodgateCore/FloodgateTelemetryLogger":50,"./FloodgateCore/UISurvey/CustomUISurvey":51,"./FloodgateCore/UISurvey/DummyUISurvey":52,"./UI/UI":84,"./Window/Window":89,"@ms-ofb/officefloodgatecore":1,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5,"@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider":12,"es6-promise":39}],43:[function(t,e,n){"use strict";function i(){return new p.Promise(function(t,e){g?t():s.initialize().then(function(){return d.get().OfficeBrowserFeedback.initOptions?(u.get().setInAppFeedbackInitOptions(d.get().OfficeBrowserFeedback.initOptions),g=!0,void t()):void e("Window.OfficeBrowserFeedback.initOptions not set")}).catch(function(t){e("Initialization failed: {"+t+"}")})})}function r(t){return new p.Promise(function(e,n){return f?void n("Control already open"):void i().then(function(){u.get().setInAppFeedbackLaunchOptions(t),c.createBellyBandMulti(function(){f=!1}),l.getLogger().logEvent(l.EventIds.InApp.UI.Picker.Shown.VALUE,{IsBugEnabled:u.get().getInAppFeedbackInitOptions().bugForm,IsIdeaEnabled:void 0!==u.get().getInAppFeedbackInitOptions().userVoice}),f=!0,e()}).catch(function(t){n("Initialization failed: {"+t+"}")})})}function o(t,e){return new p.Promise(function(n,r){if(f)return void r("Control already open");var o=u.validateFeedbackType(t);i().then(function(){u.get().setInAppFeedbackLaunchOptions(e),c.createBellyBandSingle(function(){f=!1},o),l.getLogger().logEvent(l.EventIds.InApp.UI.Form.Shown.VALUE,{FeedbackType:o}),f=!0,n()}).catch(function(t){r("Initialization failed: {"+t+"}")})})}function a(){s.reset(),g=!1,f=!1}n.__esModule=!0;var s=t("./App_Common"),u=t("./Configuration/Configuration"),l=t("./Logging/Logging"),c=t("./UI/UI"),d=t("./Window/Window"),p=t("es6-promise"),g=!1;n.initialize=i;var f=!1;n.multiFeedback=r,n.singleFeedback=o,n.reset=a,d.setMultiFeedback(r),d.setSingleFeedback(o)},{"./App_Common":41,"./Configuration/Configuration":44,"./Logging/Logging":56,"./UI/UI":84,"./Window/Window":89,"es6-promise":39}],44:[function(t,e,n){"use strict";function i(){return l}function r(t){if(o.expectString(t,"feedbackType"),t===a.FeedbackType[a.FeedbackType.Smile])return a.FeedbackType.Smile;if(t===a.FeedbackType[a.FeedbackType.Frown])return a.FeedbackType.Frown;if(t===a.FeedbackType[a.FeedbackType.Bug])return a.FeedbackType.Bug;throw"feedbackType should be one of Smile, Frown or Bug"}n.__esModule=!0;var o=t("./../Utils"),a=t("./../Constants"),s=t("./../Localization"),u=function(){function t(){}return t.validateCategoryOptions=function(t){if(!t)return{show:!1};if(o.expectBoolean(t.show,"categories.show"),t.customCategories){o.expectArray(t.customCategories,"categories.customCategories");for(var e=0,n=t.customCategories;e<n.length;e++){var i=n[e];if(o.expectString(i,"custom category '"+i+"'"),i.length>20)throw"custom category '"+i+"' too long, max 20 characters."}}return t},t.prototype.getCommonInitOptions=function(){return this.commonInitOptions},t.prototype.getInAppFeedbackInitOptions=function(){return this.inAppFeedbackInitOptions},t.prototype.getInAppFeedbackLaunchOptions=function(){return this.inAppFeedbackLaunchOptions},t.prototype.getFloodgateInitOptions=function(){return this.floodgateInitOptions},t.prototype.getFloodgateSurvey=function(){return this.floodgateSurvey},t.prototype.setCommonInitOptions=function(t){o.expectObject(t,"passedInitOptions");var e={appId:t.appId,applicationGroup:t.applicationGroup||{},build:t.build,cid:t.cid,environment:t.environment,intlFilename:t.intlFilename,intlUrl:t.intlUrl,locale:t.locale,onError:t.onError,originalLocale:t.locale,primaryColour:t.primaryColour,secondaryColour:t.secondaryColour,sessionId:t.sessionId,stylesUrl:t.stylesUrl,telemetryGroup:t.telemetryGroup||{},userEmail:t.userEmail,userEmailConsentDefault:t.userEmailConsentDefault,webGroup:t.webGroup||{}};if(o.expectNumber(e.appId,"initOptions.appId"),!(e.appId%1===0&&e.appId>0))throw"initOptions.appId is not a positive integer: "+e.appId;if(o.expectString(e.stylesUrl,"initOptions.stylesUrl"),o.expectString(e.intlUrl,"initOptions.intlUrl"),void 0!==e.intlFilename?o.expectString(e.intlFilename,"initOptions.intlFilename"):e.intlFilename="officebrowserfeedbackstrings.js",o.expectNumber(e.environment,"initOptions.environment"),1!==e.environment&&0!==e.environment)throw"initOptions.environment has a bad value: "+e.environment;if(void 0!==e.userEmail&&o.expectString(e.userEmail,"initOptions.userEmail"),void 0!==e.userEmailConsentDefault&&o.expectBoolean(e.userEmailConsentDefault,"initOptions.userEmailConsentDefault"),void 0!==e.sessionId?o.expectString(e.sessionId,"initOptions.sessionId"):e.sessionId="00000000-0000-0000-0000-000000000000",e.telemetryGroup.processSessionId=e.sessionId,void 0!==e.cid&&(o.expectString(e.cid,"initOptions.cid"),e.applicationGroup.extendedManifestData=JSON.stringify({cid:e.cid})),void 0!==e.build){o.expectString(e.build,"initOptions.build");var n="^[0-9]{1,9}(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?$";new RegExp(n).test(e.build)||(e.build="0.0.0.0")}else e.build="0.0.0.0";e.telemetryGroup.officeBuild=e.build;var i=new RegExp("^#[0-9a-f]{3}([0-9a-f]{3})?$","i");void 0!==e.primaryColour&&(i.test(e.primaryColour)||(e.primaryColour=void 0)),void 0!==e.secondaryColour&&(i.test(e.secondaryColour)||(e.secondaryColour=void 0)),void 0!==e.locale?(o.expectString(e.locale,"initOptions.locale"),e.locale=s.validate(e.locale)):e.locale="en",void 0===e.onError&&(e.onError=function(t){}),this.commonInitOptions=e},t.prototype.setInAppFeedbackInitOptions=function(t){o.expectObject(t,"passedInitOptions");var e={bugForm:t.bugForm,onDismiss:t.onDismiss,screenshot:t.screenshot,userEmail:t.userEmail,userVoice:void 0!==t.userVoice?{url:t.userVoice.url}:void 0};void 0===e.onDismiss&&(e.onDismiss=function(t){}),void 0!==e.bugForm?o.expectBoolean(e.bugForm,"initOptions.bugForm"):e.bugForm=!1,void 0!==e.userEmail&&o.expectString(e.userEmail,"initOptions.userEmail"),void 0!==e.screenshot?o.expectBoolean(e.screenshot,"initOptions.screenshot"):e.screenshot=!0,void 0!==e.userVoice&&(o.expectObject(e.userVoice,"initOptions.userVoice"),o.expectString(e.userVoice.url,"initOptions.userVoice.url")),this.inAppFeedbackInitOptions=e},t.prototype.setInAppFeedbackLaunchOptions=function(e){if(!this.commonInitOptions)throw"commonInitOptions not set";e||(e={}),this.commonInitOptions.applicationGroup=o.overrideValues(e.applicationGroup,this.commonInitOptions.applicationGroup),this.commonInitOptions.telemetryGroup=o.overrideValues(e.telemetryGroup,this.commonInitOptions.telemetryGroup),this.commonInitOptions.webGroup=o.overrideValues(e.webGroup,this.commonInitOptions.webGroup),e.categories=t.validateCategoryOptions(e.categories),this.inAppFeedbackLaunchOptions=e},t.prototype.setFloodgateInitOptions=function(t){o.expectObject(t,"passedInitOptions");var e={autoDismiss:t.autoDismiss,campaignDefinitions:t.campaignDefinitions,onDismiss:t.onDismiss,onSurveyActivatedCallback:t.onSurveyActivatedCallback,settingStorageCallback:t.settingStorageCallback,uIStringGetter:t.uIStringGetter};if(void 0===e.autoDismiss&&(e.autoDismiss=a.AutoDismissValues.NoAutoDismiss),void 0===e.onDismiss&&(e.onDismiss=function(t,e){}),void 0===e.onSurveyActivatedCallback){var n={onSurveyActivated:function(t){t.launch()}};e.onSurveyActivatedCallback=n}void 0===e.uIStringGetter&&(e.uIStringGetter=function(t){return t}),this.floodgateInitOptions=e},t.prototype.setFloodgateSurvey=function(t){this.floodgateSurvey=t},t}();n.Configuration=u;var l=new u;n.get=i,n.validateFeedbackType=r},{"./../Constants":45,"./../Localization":54,"./../Utils":86}],45:[function(t,e,n){"use strict";n.__esModule=!0;var i=function(){function t(){}return t.AriaLabel="aria-label",t.Class="class",t.DataHtml2CanvasIgnore="data-html2canvas-ignore",t.Disabled="disabled",t.Fill="fill",t.For="for",t.Form="form",t.Height="height",t.HRef="href",t.Id="id",t.MaxLength="maxlength",t.Name="name",t.Placeholder="placeholder",t.Points="points",t.Rel="rel",t.Role="role",t.Source="src",t.Stroke="stroke",t.TabIndex="tabindex",t.Target="target",t.Transform="transform",t.Type="type",t.Value="value",t.ViewBox="viewBox",t.Width="width",t.xlinkHref="xlink:href",t.X="x",t.Y="y",t}();n.AttributeName=i;var r=function(){function t(){}return t.BlankWindow="_blank",t.Button="button",t.Checkbox="checkbox",t.Checked="checked",t.False="false",t.Zero="0",t.Polite="polite",t.Radio="radio",t.Submit="submit",t.Text="text",t.TextAreaMaxLength="1000",t.True="true",t.Unchecked="unchecked",t.NoReferrer="noreferrer",t}();n.AttributeValue=r;var o=function(){function t(){}return t.CLCID="CLCID",t}();n.UrlParameters=o;var a=function(){function t(){}return t.CheckBox="obf-CheckBox",t.FontSubtitle="obf-FontSubtitle",t.FontText="obf-FontText",t.FontSubText="obf-FontSubText",t.FontSubSubText="obf-FontSubSubText",t.Hidden="obf-Hidden",t.Link="obf-Link",t.MarginLeft60px="obf-MarginLeft60px",t.NarrowLayout="obf-NarrowLayout",t.PrivacyStatementLinkDiv="obf-PrivacyStatementLinkDiv",t.Rtl="obf-Rtl",t.Spinner="obf-Spinner",t.SpinnerCircle="obf-SpinnerCircle",t.SubmitButton="obf-SubmitButton",t.TextInput="obf-TextInput",t.Visible="obf-Visible",t.Rating="obf-Rating",t.RatingGraphic="obf-RatingGraphic",t.RatingGraphicFilled="obf-RatingGraphic-Filled",t.ChoiceGroup="obf-ChoiceGroup",t.ChoiceGroupIcon="obf-ChoiceGroupIcon",t.OverallAnchor="obf-OverallAnchor",t.OverallAnchorActive="obf-OverallAnchorActive",t.OverallImage="obf-OverallImage",t.OverallText="obf-OverallText",t.SingleLayout="obf-SingleLayout",t.ShowRightBorder="obf-ShowRightBorder",t.SlideLeft="obf-slideLeft",t.TextAlignLeft="obf-TextAlignLeft",t.FormContainer="obf-FormContainer",t.FormQuestionMiddleText="obf-FormQuestionMiddleText",t.FormMiddleText="obf-FormMiddleText",t.FormCategoriesDropdown="obf-FormCategoriesDropdown",t.FormComment="obf-FormComment",t.FormRatingContainer="obf-FormRatingContainer",t.FormRatingLabel="obf-FormRatingLabel",t.FormRating="obf-FormRating",t.FormEmailInput="obf-FormEmailInput",t.FormBottomContainer="obf-FormBottomContainer",t.FormSubmitButtonContainer="obf-FormSubmitButtonContainer",t.FormScreenshotContainer="obf-FormScreenshotContainer",t.FormScreenshotLabel="obf-FormScreenshotLabel",t.FormScreenshotCheckbox="obf-FormScreenshotCheckbox",t.TFormEmailCheckbox="obf-TFormEmailCheckbox",t.TFormEmailLabel="obf-TFormEmailLabel ",t.EmailCheckBoxLabel="obf-EmailCheckBoxLabel",t.Toast="obf-Toast",t}();n.Classes=a;var s=function(){function t(){}return t.ColumnSeparatorDiv="obf-ColumnSeparatorDiv",t.OverallAnchorsContainer="obf-OverallAnchorsContainer",t.OverallFrownAnchor="obf-OverallFrownAnchor",t.OverallFrownDiv="obf-OverallFrownDiv",t.OverallFrownImage="obf-OverallFrownImage",t.OverallFrownText="obf-OverallFrownText",t.OverallSmileAnchor="obf-OverallSmileAnchor",t.OverallSmileDiv="obf-OverallSmileDiv",t.OverallSmileImage="obf-OverallSmileImage",t.OverallSmileText="obf-OverallSmileText",t.OverallIdeaAnchor="obf-OverallIdeaAnchor",t.OverallIdeaDiv="obf-OverallIdeaDiv",t.OverallIdeaImage="obf-OverallIdeaImage",t.OverallIdeaText="obf-OverallIdeaText",t.OverallBugAnchor="obf-OverallBugAnchor",t.OverallBugDiv="obf-OverallBugDiv",t.OverallBugImage="obf-OverallBugImage",t.OverallBugText="obf-OverallBugText",t.QuestionLeftText="obf-QuestionLeftText",t.LeftFormContainer="obf-LeftFormContainer",t.MainContainer="obf-MainContainer",t.MainContentHolder="obf-MainContentHolder",t.MiddleFormContainer="obf-MiddleFormContainer",t.OverlayBackground="obf-OverlayBackground",t.PrivacyStatementLink="obf-PrivacyStatementLink",t.FirstTabbable="obf-FirstTabbable",t.LastTabbable="obf-LastTabbable",t.SingleFormContainer="obf-SingleFormContainer",t.SingleFormQuestionMiddleText="obf-SingleFormQuestionMiddleText",t.SingleFormCategoriesDropdown="obf-SingleFormCategoriesDropdown",t.SingleFormComment="obf-SingleFormComment",t.SingleFormEmailInput="obf-SingleFormEmailInput",t.SingleFormRating="obf-SingleFormRating",t.SingleFormScreenshotCheckbox="obf-SingleFormScreenshotCheckbox",t.SingleFormSubmitButton="obf-SingleFormSubmitButton",t.SingleFormSubmitButtonSpinner="obf-SingleFormSubmitButtonSpinner",t.BasicFormContainer="obf-BasicFormContainer",t.BasicFormQuestionMiddleText="obf-BasicFormQuestionMiddleText",t.BasicFormCategoriesDropdown="obf-BasicFormCategoriesDropdown",t.BasicFormComment="obf-BasicFormComment",t.BasicFormEmailInput="obf-BasicFormEmailInput",t.BasicFormRating="obf-BasicFormRating",t.BasicFormScreenshotCheckbox="obf-BasicFormScreenshotCheckbox",t.BasicFormSubmitButton="obf-BasicFormSubmitButton",t.BasicFormSubmitButtonSpinner="obf-BasicFormSubmitButtonSpinner",t.UserVoiceFormContainer="obf-UserVoiceFormContainer",t.UserVoiceFormGoButton="obf-UserVoiceFormGoButton",t.ToastContainer="obf-ToastContainer",t.ToastCancel="obf-ToastCancel",t.TPromptContainer="obf-TPromptContainer",t.TPromptTitle="obf-TPromptTitle",t.TPromptText="obf-TPromptText",t.TFormContainer="obf-TFormContainer",t.TFormTitle="obf-TFormTitle",t.TFormRating="obf-TFormRating",t.TFormComment="obf-TFormComment",t.TFormEmailTextBox="obf-TFormEmailTextBox",t.TFormEmailCheckBox="obf-TFormEmailCheckBox",t.TFormEmailLabel="obf-TFormEmailLabel",t.TFormSubmitButton="obf-TFormSubmitButton",t.TFormSubmitButtonSpinner="obf-TFormSubmitButtonSpinner",t.TFormSubmitButtonContainer="obf-TFormSubmitButtonContainer",t}();n.IDs=s;var u=function(){function t(){}return t.Esc=27,t.Tab=9,t}();n.Keys=u;var l;!function(t){t[t.Smile=0]="Smile",t[t.Frown=1]="Frown",t[t.Idea=2]="Idea",t[t.Bug=3]="Bug"}(l=n.FeedbackType||(n.FeedbackType={}));var c;!function(t){t[t.Production=0]="Production",t[t.Int=1]="Int"}(c=n.Environment||(n.Environment={}));var d;!function(t){t[t.NoAutoDismiss=0]="NoAutoDismiss",t[t.SevenSeconds=1]="SevenSeconds",t[t.FourteenSeconds=2]="FourteenSeconds",t[t.TwentyOneSeconds=3]="TwentyOneSeconds",t[t.TwentyEightSeconds=4]="TwentyEightSeconds"}(d=n.AutoDismissValues||(n.AutoDismissValues={}));var p=function(){function t(){}return t.Anchor="A",t.Button="button",t.Defs="defs",t.Div="div",t.FieldSet="fieldset",t.Form="form",t.Img="img",t.Input="input",t.Label="label",t.Legend="legend",t.Option="option",t.Polygon="polygon",t.Select="select",t.Span="span",t.Svg="svg",t.TextArea="textarea",t.Use="use",t}();n.Tags=p;var g=function(){function t(){}return t.PrivacyStatementLink="http://go.microsoft.com/fwlink/?LinkID=390004",t}();n.Urls=g},{}],46:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../FloodgateCore/UISurvey/UISurvey"),r=t("./../Window/Window"),o=function(){function t(){}return t.prototype.makeSurveyLauncher=function(t){return new a(t)},t}();n.default=o;var a=function(){function t(t){this.survey=t}return t.prototype.launch=function(){r.get().OfficeBrowserFeedback.floodgate.showSurvey(new i.default(this.survey))},t}()},{"./../FloodgateCore/UISurvey/UISurvey":53,"./../Window/Window":89}],47:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Configuration/Configuration"),r=function(){function t(){}return t.prototype.getLanguage=function(){return i.get().getCommonInitOptions().originalLocale},t}();n.default=r},{"./../Configuration/Configuration":44}],48:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),r=t("./../Window/Window"),o=t("./../Logging/Logging"),a=i.IFloodgateStorageProvider.FileType,s={};s[a.CampaignDefinitions.toString()]="obf-CampaignDefinitions",s[a.CampaignStates.toString()]="obf-CampaignStates",s[a.FloodgateSettings.toString()]="obf-FloodgateSettings",s[a.GovernedChannelStates.toString()]="obf-GovernedChannelStates",s[a.SurveyActivationStats.toString()]="obf-SurveyActivationStats",s[a.SurveyEventActivityStats.toString()]="obf-SurveyEventActivityStats";var u=function(){function t(){}return t.isStorageAvailable=function(){try{var t="__storage_test__";return r.get().localStorage.setItem(t,t),r.get().localStorage.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==r.get().localStorage.length}},t.prototype.fileLock=function(t){},t.prototype.fileUnlock=function(t){},t.prototype.read=function(t){if(!(t in a&&s.hasOwnProperty(t.toString())))return"";var e,n=s[t];try{e=r.get().localStorage.getItem(n)}catch(t){return o.getLogger().logEvent(o.EventIds.Survey.Floodgate.FileRead.Failed.VALUE,{ErrorMessage:t.toString(),FileName:n}),""}return e},t.prototype.write=function(t,e){if(t in a&&s.hasOwnProperty(t.toString())){var n=s[t];try{r.get().localStorage.setItem(n,e)}catch(t){return void o.getLogger().logEvent(o.EventIds.Survey.Floodgate.FileWrite.Failed.VALUE,{ErrorMessage:t.toString(),FileName:n})}}},t}();n.default=u},{"./../Logging/Logging":56,"./../Window/Window":89,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],49:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),r=t("./../UIStrings/UIStrings"),o=t("./../Configuration/Configuration"),a=function(){function t(){}return t.prototype.loadStringResource=function(t){var e=r.getUIStrings();switch(t){case i.IFloodgateStringProvider.StringType.Nps11RatingValue0:return e.Floodgate.Nps.Rating.Points11Value0;case i.IFloodgateStringProvider.StringType.Nps11RatingValue1:return e.Floodgate.Nps.Rating.Points11Value1;case i.IFloodgateStringProvider.StringType.Nps11RatingValue2:return e.Floodgate.Nps.Rating.Points11Value2;case i.IFloodgateStringProvider.StringType.Nps11RatingValue3:return e.Floodgate.Nps.Rating.Points11Value3;case i.IFloodgateStringProvider.StringType.Nps11RatingValue4:return e.Floodgate.Nps.Rating.Points11Value4;case i.IFloodgateStringProvider.StringType.Nps11RatingValue5:return e.Floodgate.Nps.Rating.Points11Value5;case i.IFloodgateStringProvider.StringType.Nps11RatingValue6:return e.Floodgate.Nps.Rating.Points11Value6;case i.IFloodgateStringProvider.StringType.Nps11RatingValue7:return e.Floodgate.Nps.Rating.Points11Value7;case i.IFloodgateStringProvider.StringType.Nps11RatingValue8:return e.Floodgate.Nps.Rating.Points11Value8;case i.IFloodgateStringProvider.StringType.Nps11RatingValue9:return e.Floodgate.Nps.Rating.Points11Value9;case i.IFloodgateStringProvider.StringType.Nps11RatingValue10:return e.Floodgate.Nps.Rating.Points11Value10;case i.IFloodgateStringProvider.StringType.Nps5RatingValue1:return e.Floodgate.Nps.Rating.Points5Value1;case i.IFloodgateStringProvider.StringType.Nps5RatingValue2:return e.Floodgate.Nps.Rating.Points5Value2;case i.IFloodgateStringProvider.StringType.Nps5RatingValue3:return e.Floodgate.Nps.Rating.Points5Value3;case i.IFloodgateStringProvider.StringType.Nps5RatingValue4:return e.Floodgate.Nps.Rating.Points5Value4;case i.IFloodgateStringProvider.StringType.Nps5RatingValue5:return e.Floodgate.Nps.Rating.Points5Value5;case i.IFloodgateStringProvider.StringType.NpsRatingQuestion:return e.Floodgate.Nps.Rating.Question;case i.IFloodgateStringProvider.StringType.NpsCommentQuestion:return e.Floodgate.Nps.Comment.Question;case i.IFloodgateStringProvider.StringType.NpsPromptNotNowLabel:return e.Floodgate.Nps.Prompt.No;case i.IFloodgateStringProvider.StringType.NpsPromptQuestion:return e.Floodgate.Nps.Prompt.Question;case i.IFloodgateStringProvider.StringType.NpsPromptTitle:return e.Floodgate.Nps.Prompt.Title;case i.IFloodgateStringProvider.StringType.NpsPromptYesLabel:return e.Floodgate.Nps.Prompt.Yes;default:return""}},t.prototype.getCustomString=function(t){return o.get().getFloodgateInitOptions().uIStringGetter(t)},t}();n.default=a},{"./../Configuration/Configuration":44,"./../UIStrings/UIStrings":67,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],50:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../Logging/Logging"),r=function(){function t(){}return t.prototype.log_TriggerMet=function(t,e,n){i.getLogger().logEvent(i.EventIds.Survey.Floodgate.TriggerMet.VALUE,{CampaignId:t,SurveyId:e,SurveyType:n})},t.prototype.log_UserSelected=function(t,e,n){i.getLogger().logEvent(i.EventIds.Survey.Floodgate.UserSelected.VALUE,{CampaignId:t,SurveyId:e,SurveyType:n})},t.prototype.log_CampaignLoad_Failed=function(t){
i.getLogger().logEvent(i.EventIds.Survey.Floodgate.CampaignLoad.Failed.VALUE,{ErrorMessage:t})},t.prototype.log_Event=function(t,e){var n={name:t};i.getLogger().logEvent(n,e)},t}();n.default=r},{"../Logging/Logging":56}],51:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../../Utils"),r=function(){function t(t){this.comment="",this.ratingIndex=-1,this.showPrompt=t.showPrompt,this.showEmailRequest=!!i.isBoolean(t.showEmailRequest)&&t.showEmailRequest,this.survey=t}return t.prototype.getPromptQuestion=function(){return this.survey.promptQuestion},t.prototype.getTitle=function(){return this.survey.title},t.prototype.getPromptYesButtonText=function(){return this.survey.promptYesButtonText},t.prototype.getPromptNoButtonText=function(){return this.survey.promptNoButtonText},t.prototype.getRatingValuesAscending=function(){return this.survey.ratingValuesAscending},t.prototype.getRatingQuestion=function(){return this.survey.ratingQuestion},t.prototype.getCommentQuestion=function(){return this.survey.commentQuestion},t.prototype.setValues=function(t,e){this.comment=e,this.isRatingIndexValid(t)?this.ratingIndex=t:this.ratingIndex=-1},t.prototype.getJsonElements=function(){var t={};return t.comment=this.comment,t.rating=this.getNormalizedRatingScore(),t.survey={surveyId:this.getCampaignId()},t},t.prototype.getSurveyType=function(){return this.survey.surveyType},t.prototype.getCampaignId=function(){return this.survey.campaignId},t.prototype.getId=function(){return this.getCampaignId()},t.prototype.isRatingIndexValid=function(t){return t>=0&&t<this.survey.ratingValuesAscending.length},t.prototype.getNormalizedRatingScore=function(){return this.isRatingIndexValid(this.ratingIndex)?this.survey.isZeroBased?this.ratingIndex/(this.survey.ratingValuesAscending.length-1):(this.ratingIndex+1)/this.survey.ratingValuesAscending.length:-1},t}();n.default=r},{"../../Utils":86}],52:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("../../Utils"),r=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),o=function(){function t(){this.showPrompt=!0,this.showEmailRequest=!0,this.comment=""}return t.prototype.getPromptQuestion=function(){return"Prompt question?"},t.prototype.getTitle=function(){return"Title"},t.prototype.getPromptYesButtonText=function(){return"Yes"},t.prototype.getPromptNoButtonText=function(){return"No"},t.prototype.getRatingValuesAscending=function(){return["worst","worse","ok","better","best"]},t.prototype.getRatingQuestion=function(){return"Rating question?"},t.prototype.getCommentQuestion=function(){return"Comment question?"},t.prototype.setValues=function(t,e){e&&(this.comment=e),i.isInteger(t)&&t>=0&&t<=4&&(this.rating=t/4)},t.prototype.getJsonElements=function(){var t={};return this.comment&&(t.comment=this.comment),this.rating&&(t.rating=this.rating),t},t.prototype.getSurveyType=function(){return r.ISurvey.Type.Nps},t.prototype.getCampaignId=function(){return"10000000-0000-0000-0000-000000000000"},t.prototype.getId=function(){return"00000000-0000-0000-0000-000000000000"},t}();n.default=o},{"../../Utils":86,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],53:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),r=function(){function t(t){if(this.showPrompt=!0,this.showEmailRequest=!1,!t)throw Error("survey must not be null");this.survey=t;var e=t.getComponent(i.ISurveyComponent.Type.Prompt),n=t.getComponent(i.ISurveyComponent.Type.Comment),r=t.getComponent(i.ISurveyComponent.Type.Rating);if(!e)throw Error("prompt component must not be null");if(this.prompt=e,this.showEmailRequest=t.getSurveyInfo().isAdditionalDataRequested(i.ISurveyInfo.AdditionalDataType.EmailAddress),!n)throw Error("comment component must not be null");if(this.comment=n,!r)throw Error("rating component must not be null");this.rating=r}return t.prototype.getPromptQuestion=function(){return this.prompt.getQuestion()},t.prototype.getTitle=function(){return this.prompt.getTitle()},t.prototype.getPromptYesButtonText=function(){return this.prompt.getYesButtonText()},t.prototype.getPromptNoButtonText=function(){return this.prompt.getNoButtonText()},t.prototype.getRatingValuesAscending=function(){return this.rating.getRatingValuesAscending()},t.prototype.getRatingQuestion=function(){return this.rating.getQuestion()},t.prototype.getCommentQuestion=function(){return this.comment.getQuestion()},t.prototype.setValues=function(t,e){this.rating.setSelectedRatingIndex(t),this.comment.setSubmittedText(e)},t.prototype.getJsonElements=function(){return this.survey.getJsonElements()},t.prototype.getSurveyType=function(){return this.survey.getType()},t.prototype.getCampaignId=function(){return this.survey.getSurveyInfo().getBackEndId()},t.prototype.getId=function(){return this.survey.getSurveyInfo().getId()},t}();n.default=r},{"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],54:[function(t,e,n){"use strict";function i(t){var e=t.toLocaleUpperCase();if(e in o)return o[e];for(var n=0,i=r;n<i.length;n++){var a=i[n];if(a.toUpperCase()===e)return a}for(var s=e.split("-")[0],u=0,l=r;u<l.length;u++){var a=l[u];if(a.toUpperCase()===s)return a}return"en"}n.__esModule=!0;var r=["af","am","ar","as","az","be","bg","bn-BD","bn-IN","bs","ca","ca-Es-VALENCIA","chr-Cher","cs","cy","da","de","el","en-GB","es","es-MX","et","eu","fa","fi","fil","fr","fr-CA","ga","gd","gl","gu","ha-Latn-NG","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-KH","kn","ko","kok","ky","lb","lo","lt","lv","mi","mk","ml","mn","mr","ms","mt","nb-NO","ne","nl","nn-NO","or","pa","pl","prs","pt-BR","pt-PT","quz","ro","ru","sd","si","sk","sl","sq","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv","sw","ta","te","th","tk","tr","tt","ug","uk","ur","uz-Latn-UZ","vi","zh-Hans","zh-Hant"],o={"ZH-CN":"zh-Hans","ZH-HK":"zh-Hant","ZH-MO":"zh-Hant","ZH-SG":"zh-Hans","ZH-TW":"zh-Hant"};n.validate=i},{}],55:[function(t,e,n){"use strict";n.__esModule=!0;var i=function(){function t(){}return t.InApp=(e=function(){function t(){}return t}(),e.UI=(n=function(){function t(){}return t}(),n.Picker=(i=function(){function t(){}return t}(),i.Shown=(r=function(){function t(){}return t}(),r.VALUE={name:"InApp_UI_Picker_Shown"},r),i),n.Form=(o=function(){function t(){}return t}(),o.Shown=(a=function(){function t(){}return t}(),a.VALUE={name:"InApp_UI_Form_Shown"},a),o.Submit=(s=function(){function t(){}return t}(),s.VALUE={name:"InApp_UI_Form_Submit"},s),o),n),e),t.Survey=(u=function(){function t(){}return t}(),u.UI=(l=function(){function t(){}return t}(),l.Prompt=(c=function(){function t(){}return t}(),c.Shown=(d=function(){function t(){}return t}(),d.VALUE={name:"Survey_UI_Prompt_Shown"},d),c),l.Form=(p=function(){function t(){}return t}(),p.Shown=(g=function(){function t(){}return t}(),g.VALUE={name:"Survey_UI_Form_Shown"},g),p.Submit=(f=function(){function t(){}return t}(),f.VALUE={name:"Survey_UI_Form_Submit"},f),p),l),u.Floodgate=(h=function(){function t(){}return t}(),h.TriggerMet=(m=function(){function t(){}return t}(),m.VALUE={name:"Survey_Floodgate_TriggerMet"},m),h.UserSelected=(v=function(){function t(){}return t}(),v.VALUE={name:"Survey_Floodgate_UserSelected"},v),h.CampaignLoad=(y=function(){function t(){}return t}(),y.Failed=(S=function(){function t(){}return t}(),S.VALUE={name:"Survey_Floodgate_CampaignLoad_Failed"},S),y),h.FileWrite=(b=function(){function t(){}return t}(),b.Failed=(C=function(){function t(){}return t}(),C.VALUE={name:"Survey_Floodgate_FileWrite_Failed"},C),b),h.FileRead=(T=function(){function t(){}return t}(),T.Failed=(w=function(){function t(){}return t}(),w.VALUE={name:"Survey_Floodgate_FileRead_Failed"},w),T),h),u),t.Shared=(I=function(){function t(){}return t}(),I.Upload=(A=function(){function t(){}return t}(),A.Failed=(E=function(){function t(){}return t}(),E.VALUE={name:"Shared_Upload_Failed"},E),A),I.Screenshot=(F=function(){function t(){}return t}(),F.Render=(D=function(){function t(){}return t}(),D.Failed=(x=function(){function t(){}return t}(),x.VALUE={name:"Shared_Screenshot_Render_Failed"},x),D.Success=(N=function(){function t(){}return t}(),N.VALUE={name:"Shared_Screenshot_Render_Success"},N),D),F.GetContent=(O=function(){function t(){}return t}(),O.Failed=(_=function(){function t(){}return t}(),_.DefaultImage=(B=function(){function t(){}return t}(),B.Returned=(k=function(){function t(){}return t}(),k.VALUE={name:"Shared_Screenshot_GetContent_Failed_DefaultImage_Returned"},k),B),_),O),F),I),t;var e,n,i,r,o,a,s,u,l,c,d,p,g,f,h,m,v,y,S,b,C,T,w,I,A,E,F,D,x,N,O,_,B,k}();n.EventIds=i},{}],56:[function(t,e,n){"use strict";function i(t,e,n,i,r,o,l){c=new p(u.default.create(g.getTenantToken(t),d,new a.App(e,n),new a.Session(s.guid()),new a.Host(r,o,l),new a.Release(i)))}function r(){return c}n.__esModule=!0;var o=t("./../Constants"),a=t("./Telemetry/Contracts"),s=t("./../Utils"),u=t("./Telemetry/TelemetryLoggerFactory"),l=t("./Constants");n.EventIds=l.EventIds;var c,d="Office_Feedback";n.initialize=i,n.getLogger=r;var p=function(){function t(t){if(!t)throw new Error("telemetryLogger must not be null");this.telemetryLogger=t}return t.prototype.logEvent=function(e,n){if(!e)throw new Error("eventId must not be null");n=n||{},n[t.EVENT_ID]=e.name,this.telemetryLogger.logEvent(t.EVENT_NAME,n)},t.EVENT_NAME="SDK",t.EVENT_ID="EventId",t}();n.Logger=p;var g=function(){function t(){}return t.getTenantToken=function(e){return e===o.Environment.Production?t.TENANT_TOKEN_PRODUCTION:t.TENANT_TOKEN_PRE_PRODUCTION},t.TENANT_TOKEN_PRODUCTION="d79e824386c4441cb8c1d4ae15690526-bd443309-5494-444a-aba9-0af9eef99f84-7360",t.TENANT_TOKEN_PRE_PRODUCTION="2bf6a2ffddca4a80a892a0b182132961-625cb102-8b0c-480e-af53-92e48695d08d-7736",t}()},{"./../Constants":45,"./../Utils":86,"./Constants":55,"./Telemetry/Contracts":59,"./Telemetry/TelemetryLoggerFactory":60}],57:[function(t,e,n){"use strict";function i(){return r.AWT}n.__esModule=!0;var r=t("./../../thirdparty/aria-webjs-compact-sdk-1.2.2");n.AWT=i},{"./../../thirdparty/aria-webjs-compact-sdk-1.2.2":90}],58:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./Aria"),r=t("./Contracts"),o=function(){function t(t,e,n,r,o,a){if(!t)throw new Error("tenantToken must not be null");if(!e)throw new Error("namespace must not be null");if(!n)throw new Error("app must not be null");if(!r)throw new Error("session must not be null");i.AWT().initialize(t),this.namespace=e,this.oesApp=n,this.oesSession=r,this.oesHost=o,this.oesRelease=a,this.sequence=1}return t.setApp=function(t,e){t["App.Name"]=e.getName(),t["App.Platform"]=e.getPlatform(),t["App.Version"]=e.getVersion()},t.setSession=function(t,e){t["Session.Id"]=e.getId()},t.setHost=function(t,e){e&&(t["Host.Id"]=e.getId(),t["Host.Version"]=e.getVersion())},t.setEvent=function(t,e){t["Event.Name"]=e.getName(),t["Event.Id"]=e.getId(),t["Event.Source"]=e.getSource(),t["Event.SchemaVersion"]=e.getSchemaVersion(),t["Event.Sequence"]=e.getSequence()},t.setRelease=function(t,e){e&&(t["Release.AudienceGroup"]=e.getAudienceGroup())},t.prototype.logEvent=function(e,n){if(!e)throw new Error("eventName must not be null");var o=new r.Event(this.namespace+t.EVENT_NAME_DELIMITER+e,this.oesSession.getId(),this.sequence),a={};if(null!=n)for(var s in n)n.hasOwnProperty(s)&&(a[t.CUSTOM_PROPERTIES_FIELD_PREFIX+s]=n[s]);t.setApp(a,this.oesApp),t.setSession(a,this.oesSession),t.setHost(a,this.oesHost),t.setRelease(a,this.oesRelease),t.setEvent(a,o),i.AWT().logEvent({name:o.getName(),properties:a}),this.sequence++},t.EVENT_NAME_DELIMITER="_",t.CUSTOM_PROPERTIES_FIELD_PREFIX="Data.",t}();n.default=o},{"./Aria":57,"./Contracts":59}],59:[function(t,e,n){"use strict";n.__esModule=!0;var i=function(){function t(t,e){if(!t)throw new Error("name must not be null");if(!e)throw new Error("version must not be null");this.name=t,this.version=e}return t.prototype.getName=function(){return this.name},t.prototype.getPlatform=function(){return t.PLATFORM},t.prototype.getVersion=function(){return this.version},t.PLATFORM="Web",t}();n.App=i;var r=function(){function t(t){if(!t)throw new Error("id must not be null");this.id=t}return t.prototype.getId=function(){return this.id},t}();n.Session=r;var o=function(){function t(t,e,n){this.id=t,this.sessionId=e,this.version=n}return t.prototype.getId=function(){return this.id},t.prototype.getSessionId=function(){return this.sessionId},t.prototype.getVersion=function(){return this.version},t}();n.Host=o;var a=function(){function t(e,n,i){if(!e)throw new Error("name must not be null");if(!n)throw new Error("sessionId must not be null");if(!i&&0!==i||i<0)throw new Error("sequence must not be negative");this.name=e,this.id=n+t.ID_DELIMITER+i,this.sequence=i}return t.prototype.getName=function(){return this.name},t.prototype.getId=function(){return this.id},t.prototype.getSource=function(){return t.SOURCE},t.prototype.getSchemaVersion=function(){return t.SCHEMA_VERSION},t.prototype.getSequence=function(){return this.sequence},t.ID_DELIMITER=".",t.SOURCE="MsoThin",t.SCHEMA_VERSION=1,t}();n.Event=a;var s=function(){function t(t){this.audienceGroup=t}return t.prototype.getAudienceGroup=function(){return this.audienceGroup},t}();n.Release=s},{}],60:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./AriaTelemetryLogger"),r=function(){function t(){}return t.create=function(t,e,n,r,o,a){return new i.default(t,e,n,r,o,a)},t}();n.default=r},{"./AriaTelemetryLogger":58}],61:[function(t,e,n){"use strict";function i(){var t=r.get().OfficeBrowserFeedback.html2canvas();return t(document.body,{background:"#ffffff"})}n.__esModule=!0;var r=t("./Window/Window");n.createScreenShot=i},{"./Window/Window":89}],62:[function(t,e,n){"use strict";function i(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),t||(t=o),e||(e=a);var n=document.createElement("style");n.textContent="."+r.Classes.OverallAnchor+":hover { background-color: "+e+" } "+("."+r.Classes.OverallAnchorActive+" { background-color: "+t+" } ")+("."+r.Classes.SpinnerCircle+" { background-color: "+t+" } ")+("."+r.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+r.Classes.ChoiceGroupIcon+" { border-color: "+t+" } ")+("."+r.Classes.ChoiceGroup+" input[type=radio]:hover+label>."+r.Classes.ChoiceGroupIcon+" { border-color: "+e+" } ")+("."+r.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+r.Classes.ChoiceGroupIcon+">span { background-color: "+t+" } ")+("."+r.Classes.SubmitButton+" { background-color: "+t+" } ")+("."+r.Classes.SubmitButton+":hover { background-color: "+e+" } ")+("."+r.Classes.Link+" { color: "+t+" } ")+("."+r.Classes.Link+":hover { color: "+e+" } ")+("#"+r.IDs.TPromptTitle+" { color: "+t+" } ")+("#"+r.IDs.TFormTitle+" { color: "+t+" } "),document.body.appendChild(n)}n.__esModule=!0;var r=t("./Constants"),o="#0167B0",a="#194789";n.initialize=i},{"./Constants":45}],63:[function(t,e,n){"use strict";function i(t){return"Survey"===t?t:r.FeedbackType[t]}n.__esModule=!0;var r=t("./../../Constants"),o=function(){function t(t,e,n,r,o,a,s,u){this.manifestData={appId:e,application:a,clientFeedbackId:o,manifestType:t,source:"Client",submitTime:n,telemetry:s,type:i(r),web:u}}return t.prototype.setComment=function(t){this.manifestData.comment=t},t.prototype.setEmail=function(t){this.manifestData.email=t},t.prototype.setCategory=function(t){this.manifestData.telemetry=this.manifestData.telemetry||{},this.manifestData.telemetry.featureArea=t},t.prototype.setValues=function(t){if(t)for(var e in t)if(t.hasOwnProperty(e)){if(this.manifestData.hasOwnProperty(e))throw Error("Key '"+e+"' already exists in manifest.");this.manifestData[e]=t[e]}},t.prototype.getContent=function(){return new Blob([JSON.stringify(this.manifestData)],{type:"application/json"})},t}();n.Manifest=o},{"./../../Constants":45}],64:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../Logging/Logging"),r=function(){function t(t){this.screenshot=t}return t.prototype.getContent=function(){var t;try{t=this.screenshot.toDataURL("image/jpeg").split(",")[1]}catch(e){i.getLogger().logEvent(i.EventIds.Shared.Screenshot.GetContent.Failed.DefaultImage.Returned.VALUE,{ErrorMessage:e.toString()}),t="iVBORw0KGgoAAAANSUhEUgAAAN0AAAA+AQMAAACV2ox1AAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAA////pdmf3QAAAAlwSFlzAAAOwgAADsIBFShKgAAAAjtJREFUSMfV1M1rE0EUAHDBa5r8A9vkL6giFiI0JH+Ih9KLx8TaukkJugShHgrJzYvkVPQkUqgwSePLEELaU+zBg8JKVvSQQNydlsadwCQzziRZ82ETxYMfc3gD8+MxjzcfV8T80f0vkQ8i68tAPSMSQ0PkI6QDpEPkZBHy1Wp1/zjni2lrZq2T2uikDG17A54Hr0vsvwXIl3WXt02zeIHQBSq3DxHk7VO55zIFgLLrcmaaQBGiqCwQArBVQTbNZODNBB5Ee2EEr5eGiDG4k5mcqcy+Ksh+N8K2+bRI1Z68fRMVoV+XmcFwpQJZGohpkds1WtjppGLaq51a2b8yp310UW9/H8VfRj68CIKRsWCFPCCEM419S4bSAOmPmdb3TBrQ4lmnt9n4/Hiv5fTunsOzXbJfLR2rU3Fd5ugOe9mw0lvNOCNxyDdIHkpHCv0S3a+MS0yT+4wkAKx1gBJeVxeMRhSeNZpXJfY+zqAVl+g0mCFRJMgs6oy9+MCMrWZaJJwiWFjuWcIShf+Wk2W9e59OHu21WPdsswZNLKs9wV77mJiaMVbBQ+/1jGZDofFLuOBU/jzG6OQKnkLOZ5EvwolMX2Q19TAX9MWyy/aNarewfZptechdLn8B3TatB/YXB2j4MKw3jTHKX4AO0CbqaSddMokHUbr0PpSXmFG4O4WIu86asCVihfoM6nUmse5gGkbJOyThVesX4UI0d00LBYMr55VuIZl8MkY1uOiTy9v3c+ShuXj5+NdQdL8B+5gmw8WZuREAAAAASUVORK5CYII="}for(var e=atob(t),n=[],r=0;r<e.length;r++)n.push(e.charCodeAt(r));var o=new Blob([new Uint8Array(n)],{type:"image/jpeg"});return o},t}();n.Screenshot=r},{"./../../Logging/Logging":56}],65:[function(t,e,n){"use strict";function i(t,e,n,i,r){var s=function(i){return new o.Promise(function(o,u){var l=new XMLHttpRequest;l.open(t,e,!0),l.timeout=a,l.onload=function(){r(l,o,u)},l.ontimeout=function(){i>0?s(i-1).then(o,u):u(new Error("Request to '"+e+"' timed out. timeout: "+a))},l.onerror=function(){i>0?s(i-1).then(o,u):u(new Error("Request to '"+e+"' errored. "+l.status+": "+l.responseText))},l.send(n)})};return s(i)}function r(t,e,n,r){if(void 0===e)return o.Promise.reject(new Error("Manifest cannot be undefined"));var a=new FormData;return a.append("Manifest",e),n&&a.append("Screenshot",n),r&&a.append("Diagnostics",r),i("POST",t?u:s,a,2,function(t,e,n){200!==t.status&&n(new Error("Non-200 response with status code: "+t.status+", response: "+t.responseText)),e()})}n.__esModule=!0;var o=t("es6-promise"),a=4e3,s="https://petrol-int.office.microsoft.com/v1/feedback",u="https://petrol.office.microsoft.com/v1/feedback";n.send=r},{"es6-promise":39}],66:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants"),r=t("./../Utils"),o=t("./../Logging/Logging"),a=t("./Petrol"),s=t("./Files/Screenshot"),u=t("../Configuration/Configuration"),l=t("./Files/Manifest"),c=function(){function t(t,e,n,i,o,a,s){this.manifest=new l.Manifest(e,n,(new Date).toISOString(),i,r.guid(),o,a,s),this.environment=t}return t.prototype.setComment=function(t){this.manifest.setComment(t)},t.prototype.setEmail=function(t){this.manifest.setEmail(t)},t.prototype.setCategory=function(t){this.manifest.setCategory(t)},t.prototype.setScreenshot=function(t){this.screenshot=new s.Screenshot(t)},t.prototype.setManifestValues=function(t){this.manifest.setValues(t)},t.prototype.submit=function(){var t=this.manifest.getContent(),e=void 0;return this.screenshot&&(e=this.screenshot.getContent()),a.send(this.environment===i.Environment.Production,t,e).catch(function(t){u.get().getCommonInitOptions().onError("Payload submission failed: "+t.message),o.getLogger().logEvent(o.EventIds.Shared.Upload.Failed.VALUE,{ErrorMessage:t.message})})},t}();n.Transporter=c},{"../Configuration/Configuration":44,"./../Constants":45,"./../Logging/Logging":56,"./../Utils":86,"./Files/Manifest":63,"./Files/Screenshot":64,"./Petrol":65}],67:[function(t,e,n){"use strict";function i(t){o=t}function r(){return o}n.__esModule=!0;var o;n.setUIStrings=i,n.getUIStrings=r},{}],68:[function(t,e,n){"use strict";function i(t){var e={};e[u.FeedbackType.Smile]=f,e[u.FeedbackType.Frown]=f,m.get().getInAppFeedbackInitOptions().userVoice&&"en"===m.get().getCommonInitOptions().locale?e[u.FeedbackType.Idea]=h:e[u.FeedbackType.Idea]=f,m.get().getInAppFeedbackInitOptions().bugForm&&(e[u.FeedbackType.Bug]=f),o(d.elementFromJson(c.generateMulti(e)));var n=g.isNarrow();l.registerMulti(e,n,function(e){p.setElementVisibility(u.IDs.OverlayBackground,!1),p.deleteElementById(u.IDs.OverlayBackground),m.get().getInAppFeedbackInitOptions().onDismiss(e),t()}),n&&p.addClassById(u.IDs.OverlayBackground,u.Classes.NarrowLayout)}function r(t,e){o(d.elementFromJson(c.generateSingle())),l.registerSingle(e,function(e){p.setElementVisibility(u.IDs.OverlayBackground,!1),p.deleteElementById(u.IDs.OverlayBackground),m.get().getInAppFeedbackInitOptions().onDismiss(e),t()}),p.addClassById(u.IDs.OverlayBackground,u.Classes.SingleLayout)}function o(t){document.body.insertBefore(t,document.body.firstChild),p.setElementVisibility(u.IDs.OverlayBackground,!0),p.getInternetExplorerVersion()>9||p.getInternetExplorerVersion()===-1?setTimeout(a,900):a()}function a(){p.setElementVisibility(u.IDs.MainContentHolder,!0),document.getElementById(u.IDs.OverallSmileAnchor)?document.getElementById(u.IDs.OverallSmileAnchor).focus():document.getElementById(u.IDs.SingleFormComment)&&document.getElementById(u.IDs.SingleFormComment).focus()}function s(){}n.__esModule=!0;var u=t("./../../Constants"),l=t("./Events"),c=t("./Layout"),d=t("./../Renderer"),p=t("./../Utils"),g=t("./../../WindowProperties"),f=t("./FormTemplates/BasicFormTemplate"),h=t("./FormTemplates/UserVoiceFormTemplate"),m=t("./../../Configuration/Configuration");n.createMulti=i,n.createSingle=r,n.dismiss=s},{"./../../Configuration/Configuration":44,"./../../Constants":45,"./../../WindowProperties":88,"./../Renderer":79,"./../Utils":85,"./Events":69,"./FormTemplates/BasicFormTemplate":70,"./FormTemplates/UserVoiceFormTemplate":73,"./Layout":74}],69:[function(t,e,n){"use strict";function i(t){l(),w(t)}function r(t,e,n){O.registerListener(t,e,n),P.push({event:e,id:t,listener:n})}function o(){for(var t=0,e=P;t<e.length;t++){var n=e[t];O.unregisterListener(n.id,n.event,n.listener)}P=[]}function a(t,e){void 0===e&&(e=function(t){}),k=t,r(F.IDs.SingleFormSubmitButton,"click",C(F.IDs.SingleFormSubmitButton,F.IDs.SingleFormSubmitButtonSpinner,F.IDs.SingleFormComment,F.IDs.SingleFormEmailInput,F.IDs.SingleFormScreenshotCheckbox,F.IDs.SingleFormCategoriesDropdown)),u(e)}function s(t,e,n){void 0===n&&(n=function(t){}),B=e,I=t,r(F.IDs.OverallSmileAnchor,"click",m),r(F.IDs.OverallFrownAnchor,"click",v),r(F.IDs.OverallIdeaAnchor,"click",y),r(F.IDs.OverallBugAnchor,"click",S),r(F.IDs.BasicFormSubmitButton,"click",C(F.IDs.BasicFormSubmitButton,F.IDs.BasicFormSubmitButtonSpinner,F.IDs.BasicFormComment,F.IDs.BasicFormEmailInput,F.IDs.BasicFormScreenshotCheckbox,F.IDs.BasicFormCategoriesDropdown)),r(F.IDs.UserVoiceFormGoButton,"click",T),u(n)}function u(t){w=t,O.addEventListenerHelper(window,"keyup",d),r(F.IDs.OverlayBackground,"click",p),r(F.IDs.MainContainer,"click",g),r(F.IDs.MainContainer,"keyup",c),r(F.IDs.PrivacyStatementLink,"click",f)}function l(){O.removeEventListenerHelper(window,"keyup",d),o()}function c(t){var e=t.keyCode||t.which;e===F.Keys.Tab&&(document.activeElement.id===F.IDs.FirstTabbable&&t.shiftKey||document.activeElement.id===F.IDs.LastTabbable&&!t.shiftKey)&&(t.stopPropagation(),_.cycleTabFocus(document.activeElement))}function d(t){t.keyCode===F.Keys.Esc&&(t.preventDefault(),t.stopPropagation(),i(!1))}function p(t){t.preventDefault(),t.stopPropagation(),i(!1)}function g(t){t.stopPropagation()}function f(t){t.stopPropagation()}function h(t,e){t.preventDefault(),t.stopPropagation(),O.replaceClassesById(F.IDs.OverallSmileAnchor,F.Classes.OverallAnchorActive),O.replaceClassesById(F.IDs.OverallFrownAnchor,F.Classes.OverallAnchorActive),O.replaceClassesById(F.IDs.OverallIdeaAnchor,F.Classes.OverallAnchorActive),O.replaceClassesById(F.IDs.OverallBugAnchor,F.Classes.OverallAnchorActive),O.addClassById(e,F.Classes.OverallAnchorActive),D.getLogger().logEvent(D.EventIds.InApp.UI.Form.Shown.VALUE,{FeedbackType:k});var n=I[k];b(n.containerId),n.onSelect(k)}function m(t){k=F.FeedbackType.Smile,h(t,F.IDs.OverallSmileAnchor)}function v(t){k=F.FeedbackType.Frown,h(t,F.IDs.OverallFrownAnchor)}function y(t){k=F.FeedbackType.Idea,h(t,F.IDs.OverallIdeaAnchor)}function S(t){k=F.FeedbackType.Bug,h(t,F.IDs.OverallBugAnchor)}function b(t){for(var e in I)I.hasOwnProperty(e)&&O.setElementVisibility(I[e].containerId,!1);B?(O.setElementVisibility(F.IDs.LeftFormContainer,!1),O.setElementVisibility(F.IDs.MiddleFormContainer,!0),O.setElementVisibility(t,!0)):(O.addClassById(F.IDs.ColumnSeparatorDiv,F.Classes.ShowRightBorder),O.setElementVisibility(F.IDs.MiddleFormContainer,!0),O.setElementVisibility(t,!0),O.addClassById(F.IDs.LeftFormContainer,F.Classes.SlideLeft),O.addClassById(F.IDs.MiddleFormContainer,F.Classes.SlideLeft))}function C(t,e,n,r,o,a){return function(s){s.preventDefault(),s.stopPropagation(),O.setElementVisibility(t,!1);var u=new N.Spinner(e),l=new A.Transporter(E.get().getCommonInitOptions().environment,"Sas",E.get().getCommonInitOptions().appId,k,E.get().getCommonInitOptions().applicationGroup,E.get().getCommonInitOptions().telemetryGroup,E.get().getCommonInitOptions().webGroup),c=document.getElementById(n),d=c&&!!c.value;d&&l.setComment(c.value);var p=document.getElementById(r),g=p&&!!p.value;g&&l.setEmail(p.value);var f=document.getElementById(o),h=f&&f.checked,m=document.getElementById(a),v=m&&m.selectedIndex>0;if(v&&l.setCategory(m.value),D.getLogger().logEvent(D.EventIds.InApp.UI.Form.Submit.VALUE,{FeedbackType:k,IsEmailIncluded:g,IsScreenshotIncluded:h}),h){var y=performance.now();x.createScreenShot().then(function(t){var e=performance.now();D.getLogger().logEvent(D.EventIds.Shared.Screenshot.Render.Success.VALUE,{TimeMilliseconds:e-y}),l.setScreenshot(t),l.submit()}).catch(function(t){var e=performance.now();D.getLogger().logEvent(D.EventIds.Shared.Screenshot.Render.Failed.VALUE,{ErrorMessage:t,TimeMilliseconds:e-y}),l.submit()})}else l.submit();u.destroy(),i(!0)}}function T(t){t.preventDefault(),t.stopPropagation(),window.open(document.getElementById(F.IDs.UserVoiceFormGoButton).getAttribute(F.AttributeName.Source)),i(!1)}n.__esModule=!0;var w,I,A=t("./../../Transport/Transport"),E=t("./../../Configuration/Configuration"),F=t("./../../Constants"),D=t("./../../Logging/Logging"),x=t("./../../Screenshot"),N=t("./../SpinnerControl"),O=t("./../Utils"),_=t("./TabFocus"),B=!1,k=void 0,P=[];n.registerSingle=a,n.registerMulti=s},{"./../../Configuration/Configuration":44,"./../../Constants":45,"./../../Logging/Logging":56,"./../../Screenshot":61,"./../../Transport/Transport":66,"./../SpinnerControl":80,"./../Utils":85,"./TabFocus":75}],70:[function(t,e,n){"use strict";function i(){var t=c.get().getInAppFeedbackLaunchOptions().categories,e={children:[{attributes:[{name:l.AttributeName.For,value:l.IDs.BasicFormComment}],classes:[l.Classes.FontSubtitle,l.Classes.TextAlignLeft,l.Classes.FormQuestionMiddleText],id:l.IDs.BasicFormQuestionMiddleText,tag:l.Tags.Label},{attributes:[{name:l.AttributeName.Id,value:l.IDs.BasicFormCategoriesDropdown}],brs:t.show,children:s.generate(t?t.customCategories:null),classes:[l.Classes.FontSubText,l.Classes.FormCategoriesDropdown,l.Classes.TextInput],tag:l.Tags.Select},{attributes:[{name:l.AttributeName.Placeholder,value:o.getUIStrings().Form.CommentPlaceholder},{name:l.AttributeName.MaxLength,value:l.AttributeValue.TextAreaMaxLength}],classes:[l.Classes.FontSubText,l.Classes.FormComment,l.Classes.TextInput],id:l.IDs.BasicFormComment,tag:l.Tags.TextArea},{brs:!1,children:[{attributes:[{name:l.AttributeName.For,value:l.IDs.BasicFormRating}],classes:[l.Classes.FontText,l.Classes.TextAlignLeft,l.Classes.FormRatingLabel],innerText:o.getUIStrings().Form.RatingLabel,tag:l.Tags.Label},u.generate(l.IDs.BasicFormRating)],classes:[l.Classes.FormRatingContainer]},{attributes:[{name:l.AttributeName.Type,value:l.AttributeValue.Text},{name:l.AttributeName.Placeholder,value:o.getUIStrings().Form.EmailPlaceholder},{name:l.AttributeName.AriaLabel,value:o.getUIStrings().Form.EmailPlaceholder},{name:l.AttributeName.Name,value:l.IDs.BasicFormEmailInput},{name:l.AttributeName.MaxLength,value:l.AttributeValue.TextAreaMaxLength},{name:l.AttributeName.Value,value:c.get().getInAppFeedbackInitOptions().userEmail?c.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[l.Classes.FontSubText,l.Classes.FormEmailInput,l.Classes.TextInput],id:l.IDs.BasicFormEmailInput,tag:l.Tags.Input},{children:[{children:[{attributes:[{name:l.AttributeName.Type,value:l.AttributeValue.Checkbox},{name:l.AttributeName.Value,value:l.AttributeValue.Unchecked}],brs:c.get().getInAppFeedbackInitOptions().screenshot,classes:[l.Classes.FormScreenshotCheckbox,l.Classes.CheckBox],id:l.IDs.BasicFormScreenshotCheckbox,tag:l.Tags.Input},{attributes:[{name:l.AttributeName.For,value:l.IDs.BasicFormScreenshotCheckbox}],brs:c.get().getInAppFeedbackInitOptions().screenshot,classes:[l.Classes.FontText,l.Classes.TextAlignLeft,l.Classes.FormScreenshotLabel],innerText:o.getUIStrings().Form.ScreenshotLabel,tag:l.Tags.Label}],classes:[l.Classes.FormScreenshotContainer]},{children:[{classes:[l.Classes.FontSubText,l.Classes.SubmitButton],id:l.IDs.BasicFormSubmitButton,innerText:o.getUIStrings().Form.Submit,tag:l.Tags.Button},{classes:[l.Classes.Spinner,l.Classes.Hidden],id:l.IDs.BasicFormSubmitButtonSpinner,tag:l.Tags.Div}],classes:[l.Classes.FormSubmitButtonContainer]}],classes:[l.Classes.FormBottomContainer]}],classes:[l.Classes.Hidden,l.Classes.MarginLeft60px],id:n.containerId};return e}function r(t){switch(t){case l.FeedbackType.Smile:document.getElementById(l.IDs.BasicFormQuestionMiddleText).textContent=o.getUIStrings().SmileForm.Title;break;case l.FeedbackType.Frown:document.getElementById(l.IDs.BasicFormQuestionMiddleText).textContent=o.getUIStrings().FrownForm.Title;break;case l.FeedbackType.Idea:document.getElementById(l.IDs.BasicFormQuestionMiddleText).textContent=o.getUIStrings().IdeaForm.Title;break;case l.FeedbackType.Bug:document.getElementById(l.IDs.BasicFormQuestionMiddleText).textContent=o.getUIStrings().BugForm.Title}document.getElementById(l.IDs.BasicFormComment).focus()}n.__esModule=!0;var o=t("./../../../UIStrings/UIStrings"),a=t("./FormTemplateType"),s=t("./../../CategoriesDropdown"),u=t("./../../RatingControl"),l=t("./../../../Constants"),c=t("./../../../Configuration/Configuration");n.generate=i,n.containerId=l.IDs.BasicFormContainer,n.onSelect=r,n.type=a.FormTemplateType.Basic},{"./../../../Configuration/Configuration":44,"./../../../Constants":45,"./../../../UIStrings/UIStrings":67,"./../../CategoriesDropdown":76,"./../../RatingControl":78,"./FormTemplateType":71}],71:[function(t,e,n){"use strict";n.__esModule=!0;var i;!function(t){t[t.Single=0]="Single",t[t.Basic=1]="Basic",t[t.UserVoice=2]="UserVoice"}(i=n.FormTemplateType||(n.FormTemplateType={}))},{}],72:[function(t,e,n){"use strict";function i(){var t=l.get().getInAppFeedbackLaunchOptions().categories,e={children:[{attributes:[{name:c.AttributeName.For,value:c.IDs.SingleFormComment}],classes:[c.Classes.FontSubtitle,c.Classes.TextAlignLeft,c.Classes.FormQuestionMiddleText],id:c.IDs.SingleFormQuestionMiddleText,innerText:o.getUIStrings().SingleForm.Title,tag:c.Tags.Label},{attributes:[{name:c.AttributeName.Id,value:c.IDs.SingleFormCategoriesDropdown}],brs:t.show,children:s.generate(t?t.customCategories:null),classes:[c.Classes.FontSubText,c.Classes.FormCategoriesDropdown,c.Classes.TextInput],tag:c.Tags.Select},{attributes:[{name:c.AttributeName.Placeholder,value:o.getUIStrings().Form.CommentPlaceholder},{name:c.AttributeName.MaxLength,value:c.AttributeValue.TextAreaMaxLength}],classes:[c.Classes.FontSubText,c.Classes.FormComment,c.Classes.TextInput],id:c.IDs.SingleFormComment,tag:c.Tags.TextArea},{brs:!1,children:[{attributes:[{name:c.AttributeName.For,value:c.IDs.SingleFormRating}],classes:[c.Classes.FontSubText,c.Classes.TextAlignLeft,c.Classes.FormRatingLabel],innerText:o.getUIStrings().Form.RatingLabel,tag:c.Tags.Label},u.generate(c.IDs.SingleFormRating)],classes:[c.Classes.FormRatingContainer]},{attributes:[{name:c.AttributeName.Type,value:c.AttributeValue.Text},{name:c.AttributeName.Placeholder,value:o.getUIStrings().Form.EmailPlaceholder},{name:c.AttributeName.AriaLabel,value:o.getUIStrings().Form.EmailPlaceholder
},{name:c.AttributeName.Name,value:c.IDs.SingleFormEmailInput},{name:c.AttributeName.MaxLength,value:c.AttributeValue.TextAreaMaxLength},{name:c.AttributeName.Value,value:l.get().getInAppFeedbackInitOptions().userEmail?l.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[c.Classes.FontSubText,c.Classes.FormEmailInput,c.Classes.TextInput],id:c.IDs.SingleFormEmailInput,tag:c.Tags.Input},{children:[{attributes:[{name:c.AttributeName.HRef,value:c.Urls.PrivacyStatementLink},{name:c.AttributeName.Target,value:c.AttributeValue.BlankWindow},{name:c.AttributeName.Rel,value:c.AttributeValue.NoReferrer}],classes:[c.Classes.Link],id:c.IDs.PrivacyStatementLink,innerText:o.getUIStrings().PrivacyStatement,tag:c.Tags.Anchor}],classes:[c.Classes.FontSubSubText,c.Classes.TextAlignLeft,c.Classes.PrivacyStatementLinkDiv]},{children:[{children:[{attributes:[{name:c.AttributeName.Type,value:c.AttributeValue.Checkbox},{name:c.AttributeName.Value,value:c.AttributeValue.Unchecked}],brs:l.get().getInAppFeedbackInitOptions().screenshot,classes:[c.Classes.FormScreenshotCheckbox,c.Classes.CheckBox],id:c.IDs.SingleFormScreenshotCheckbox,tag:c.Tags.Input},{attributes:[{name:c.AttributeName.For,value:c.IDs.SingleFormScreenshotCheckbox}],brs:l.get().getInAppFeedbackInitOptions().screenshot,classes:[c.Classes.FontText,c.Classes.TextAlignLeft,c.Classes.FormScreenshotLabel],innerText:o.getUIStrings().Form.ScreenshotLabel,tag:c.Tags.Label}],classes:[c.Classes.FormScreenshotContainer]},{children:[{classes:[c.Classes.FontSubText,c.Classes.SubmitButton],id:c.IDs.SingleFormSubmitButton,innerText:o.getUIStrings().Form.Submit,tag:c.Tags.Button},{classes:[c.Classes.Spinner,c.Classes.Hidden],id:c.IDs.SingleFormSubmitButtonSpinner,tag:c.Tags.Div}],classes:[c.Classes.FormSubmitButtonContainer]}],classes:[c.Classes.FormBottomContainer]}],id:n.containerId};return e}function r(t){document.getElementById(c.IDs.SingleFormComment).focus()}n.__esModule=!0;var o=t("./../../../UIStrings/UIStrings"),a=t("./FormTemplateType"),s=t("./../../CategoriesDropdown"),u=t("./../../RatingControl"),l=t("./../../../Configuration/Configuration"),c=t("./../../../Constants");n.generate=i,n.containerId=c.IDs.SingleFormContainer,n.onSelect=r,n.type=a.FormTemplateType.Single},{"./../../../Configuration/Configuration":44,"./../../../Constants":45,"./../../../UIStrings/UIStrings":67,"./../../CategoriesDropdown":76,"./../../RatingControl":78,"./FormTemplateType":71}],73:[function(t,e,n){"use strict";function i(){var t=u.get().getInAppFeedbackInitOptions().userVoice,e={children:[{classes:[s.Classes.FontSubtitle,s.Classes.TextAlignLeft,s.Classes.FormQuestionMiddleText],innerText:o.getUIStrings().UserVoiceForm.Title},{classes:[s.Classes.FontText,s.Classes.TextAlignLeft,s.Classes.FormMiddleText],innerText:o.getUIStrings().UserVoiceForm.Text},{children:[{children:[{attributes:[{name:s.AttributeName.Source,value:t.url}],classes:[s.Classes.SubmitButton,s.Classes.FontSubText],id:s.IDs.UserVoiceFormGoButton,innerText:o.getUIStrings().UserVoiceForm.Button,tag:s.Tags.Button}],classes:[s.Classes.FormSubmitButtonContainer]}],classes:[s.Classes.FormBottomContainer]}],classes:[s.Classes.Hidden,s.Classes.MarginLeft60px],id:n.containerId};return e}function r(t){document.getElementById(s.IDs.UserVoiceFormGoButton).focus()}n.__esModule=!0;var o=t("./../../../UIStrings/UIStrings"),a=t("./FormTemplateType"),s=t("./../../../Constants"),u=t("./../../../Configuration/Configuration");n.generate=i,n.containerId=s.IDs.UserVoiceFormContainer,n.onSelect=r,n.type=a.FormTemplateType.UserVoice},{"./../../../Configuration/Configuration":44,"./../../../Constants":45,"./../../../UIStrings/UIStrings":67,"./FormTemplateType":71}],74:[function(t,e,n){"use strict";function i(t){var e={attributes:[{name:u.AttributeName.DataHtml2CanvasIgnore,value:u.AttributeValue.True}],children:[{attributes:[{name:u.AttributeName.Role,value:"dialog"},{name:"aria-modal",value:"true"},{name:"aria-describedby",value:u.IDs.QuestionLeftText}],children:[{attributes:[{name:u.AttributeName.TabIndex,value:u.AttributeValue.Zero}],id:u.IDs.FirstTabbable},{children:[{children:[{classes:[u.Classes.FontSubtitle,u.Classes.TextAlignLeft],id:u.IDs.QuestionLeftText,innerText:l.getUIStrings().FeedbackSubtitle},{children:[{children:a(t),id:u.IDs.OverallAnchorsContainer}],id:u.IDs.ColumnSeparatorDiv},{children:[{attributes:[{name:u.AttributeName.HRef,value:u.Urls.PrivacyStatementLink},{name:u.AttributeName.Target,value:u.AttributeValue.BlankWindow},{name:u.AttributeName.Rel,value:u.AttributeValue.NoReferrer}],classes:[u.Classes.Link],id:u.IDs.PrivacyStatementLink,innerText:l.getUIStrings().PrivacyStatement,tag:u.Tags.Anchor}],classes:[u.Classes.FontSubSubText,u.Classes.TextAlignLeft,u.Classes.PrivacyStatementLinkDiv]}],classes:[u.Classes.FormContainer],id:u.IDs.LeftFormContainer},{children:o(t),classes:[u.Classes.FormContainer,u.Classes.Hidden],id:u.IDs.MiddleFormContainer}],classes:[u.Classes.Hidden],id:u.IDs.MainContentHolder,tag:u.Tags.Form},{attributes:[{name:u.AttributeName.TabIndex,value:u.AttributeValue.Zero}],id:u.IDs.LastTabbable}],id:u.IDs.MainContainer}],classes:[c.isRightToLeft()?u.Classes.Rtl:""],id:u.IDs.OverlayBackground};return e}function r(){var t={attributes:[{name:u.AttributeName.DataHtml2CanvasIgnore,value:u.AttributeValue.True}],children:[{children:[{attributes:[{name:u.AttributeName.TabIndex,value:u.AttributeValue.Zero}],id:u.IDs.FirstTabbable},{children:[{children:[d.generate()],classes:[u.Classes.FormContainer],id:u.IDs.MiddleFormContainer}],classes:[u.Classes.Hidden],id:u.IDs.MainContentHolder,tag:u.Tags.Form},{attributes:[{name:u.AttributeName.TabIndex,value:u.AttributeValue.Zero}],id:u.IDs.LastTabbable}],id:u.IDs.MainContainer}],classes:[u.Classes.SingleLayout,c.isRightToLeft()?u.Classes.Rtl:""],id:u.IDs.OverlayBackground};return t}function o(t){var e={children:[]},n={};for(var i in t)if(t.hasOwnProperty(i)){var r=!(t[i].containerId in n);r&&(e.children.push(t[i].generate()),n[t[i].containerId]=!0)}return e.children}function a(t){var e={children:[]};return u.FeedbackType.Smile in t&&e.children.push(s(u.IDs.OverallSmileAnchor,u.IDs.OverallSmileImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM36 58.6c-8.5 0-16-4.1-20.9-10.4l3.5-3.6c3.5 4.5 9.9 7.6 17.4 7.6 7.4 0 13.9-3.1 17.4-7.6l3.6 3.6C52.1 54.4 44.4 58.6 36 58.6Z"/></svg>',u.IDs.OverallSmileText,l.getUIStrings().SmileForm.Anchor)),u.FeedbackType.Frown in t&&e.children.push(s(u.IDs.OverallFrownAnchor,u.IDs.OverallFrownImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM52.8 57.9c-3.3-4.4-9.6-7.3-16.7-7.3 -7.2 0-13.4 3-16.7 7.3l-3.4-3.4c4.7-6.1 11.9-10 20.1-10 8.2 0 15.5 4 20.2 10L52.8 57.9Z"/></svg>',u.IDs.OverallFrownText,l.getUIStrings().FrownForm.Anchor)),u.FeedbackType.Idea in t&&e.children.push(s(u.IDs.OverallIdeaAnchor,u.IDs.OverallIdeaImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M42.3 62H29.2c-1.1 0-2 0.9-2 2s1.9 2 3 2h11.1c1.1 0 3-0.9 3-2S43.4 62 42.3 62ZM36 1.1C25 1.1 14.8 7 14.8 20.6c0 2.2 0.8 4.4 0.7 4.1 1.2 2.9 2.7 5.6 6.3 10.9 4.2 6.3 4.7 7.6 4.8 11.1v1.3c0 1.3 1 3 2.7 3h13.5c1.7 0 2.8-1.7 2.8-3v-1.5c0.1-3.5 0.1-4.7 4.2-10.9 3.6-5.4 5.7-8.4 6.8-11 0 0 0.6-1.6 0.6-4.1C57.2 6.9 47 1.1 36 1.1ZM31.9 11.9c-3.2 0-5.6 4.2-5.5 6.2 0.2 4-4.4 3.8-4.4 0.6 0-5.3 2.8-10.3 8.5-10.9C34.6 7.3 34.6 11.9 31.9 11.9ZM43.6 55h-15c-1.1 0-2 0.9-2 2v1c0 1.1 0.9 2 2 2h15c1.1 0 2-0.9 2-2v-1C45.6 55.9 44.7 55 43.6 55ZM39.1 68h-6c-0.8 0-1.5 0.7-1.5 1.5s1.2 1.5 2 1.5h5c0.8 0 2-0.7 2-1.5S39.9 68 39.1 68Z"/></svg>',u.IDs.OverallIdeaText,l.getUIStrings().IdeaForm.Anchor)),u.FeedbackType.Bug in t&&e.children.push(s(u.IDs.OverallBugAnchor,u.IDs.OverallBugImage,'<svg viewBox="150 100 1748 1748" width="24px" height="24px" focusable="false"><path d="M1824 1088q0 26-19 45t-45 19h-224q0 171-67 290l208 209q19 19 19 45t-19 45q-18 19-45 19t-45-19l-198-197q-5 5-15 13t-42 28.5-65 36.5-82 29-97 13v-896h-128v896q-51 0-101.5-13.5t-87-33-66-39-43.5-32.5l-15-14-183 207q-20 21-48 21-24 0-43-16-19-18-20.5-44.5t15.5-46.5l202-227q-58-114-58-274h-224q-26 0-45-19t-19-45 19-45 45-19h224v-294l-173-173q-19-19-19-45t19-45 45-19 45 19l173 173h844l173-173q19-19 45-19t45 19 19 45-19 45l-173 173v294h224q26 0 45 19t19 45zm-480-576h-640q0-133 93.5-226.5t226.5-93.5 226.5 93.5 93.5 226.5z"/></svg>',u.IDs.OverallBugText,l.getUIStrings().BugForm.Anchor)),e.children}function s(t,e,n,i,r){return{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Button}],children:[{classes:[u.Classes.OverallImage],id:e,innerHTML:n,tag:u.Tags.Div},{classes:[u.Classes.FontSubtitle,u.Classes.OverallText],id:i,innerText:r}],classes:[u.Classes.OverallAnchor,u.Classes.TextAlignLeft],id:t,tag:u.Tags.Button}}n.__esModule=!0;var u=t("./../../Constants"),l=t("./../../UIStrings/UIStrings"),c=t("./../Utils"),d=t("./FormTemplates/SingleFormTemplate");n.generateMulti=i,n.generateSingle=r},{"./../../Constants":45,"./../../UIStrings/UIStrings":67,"./../Utils":85,"./FormTemplates/SingleFormTemplate":72}],75:[function(t,e,n){"use strict";function i(t){var e=r();if(t.id===a.IDs.LastTabbable)for(var n=0;n<e.length;n++){var i=e[n];if(i.id!==a.IDs.FirstTabbable&&o(i))return void i.focus()}else if(t.id===a.IDs.FirstTabbable)for(var n=e.length-1;n>=0;n--){var i=e[n];if(i.id!==a.IDs.LastTabbable&&o(i))return void i.focus()}}function r(){var t="a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']), select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex ='-1']), object, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]";return document.getElementById(a.IDs.MainContainer).querySelectorAll(t)}function o(t){if(!t.parentElement)return!1;if(/\S/.test(t.parentElement.id)){if(t.parentElement.className.indexOf(a.Classes.Visible)>=0)return!0;if(t.parentElement.className.indexOf(a.Classes.Hidden)>=0)return!1}return o(t.parentElement)}n.__esModule=!0;var a=t("./../../Constants");n.cycleTabFocus=i},{"./../../Constants":45}],76:[function(t,e,n){"use strict";function i(t){for(var e=t?t:[],n=[{attributes:[{name:"selected",value:"true"}],innerText:r.getUIStrings().Form.CategoryPlaceholder,tag:o.Tags.Option}],i=0,a=e;i<a.length;i++){var s=a[i];n.push({innerText:s,tag:o.Tags.Option})}return n}n.__esModule=!0;var r=t("./../UIStrings/UIStrings"),o=t("./../Constants");n.generate=i},{"./../Constants":45,"./../UIStrings/UIStrings":67}],77:[function(t,e,n){"use strict";function i(t,e,n){for(var i={children:[{classes:[o.Classes.FontSubText],innerText:e,tag:o.Tags.Legend}],tag:o.Tags.FieldSet},a=0,s=n;a<s.length;a++){var u=s[a];Array.prototype.push.apply(i.children,r(u[0].toString(),u[1],t))}return{children:[i],classes:[o.Classes.ChoiceGroup],id:t}}function r(t,e,n){return[{attributes:[{name:o.AttributeName.Type,value:o.AttributeValue.Radio},{name:o.AttributeName.Value,value:t},{name:o.AttributeName.Name,value:n}],id:t,tag:o.Tags.Input},{attributes:[{name:o.AttributeName.For,value:t}],children:[{children:[{tag:o.Tags.Span}],classes:[o.Classes.ChoiceGroupIcon],tag:o.Tags.Span},{classes:["obf-ChoiceGroupLabel"],innerHTML:e,tag:o.Tags.Span}],classes:[o.Classes.FontSubText],tag:o.Tags.Label}]}n.__esModule=!0;var o=t("./../Constants");n.generateRadioGroup=i},{"./../Constants":45}],78:[function(t,e,n){"use strict";function i(t){return{children:[p,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:t},{name:r.AttributeName.Value,value:"1"}],tag:r.Tags.Input},g,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:t},{name:r.AttributeName.Value,value:"2"}],tag:r.Tags.Input},f,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:t},{name:r.AttributeName.Value,value:"3"}],tag:r.Tags.Input},h,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:t},{name:r.AttributeName.Value,value:"4"}],tag:r.Tags.Input},m,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:t},{name:r.AttributeName.Value,value:"5"}],tag:r.Tags.Input},v],classes:[r.Classes.Rating],id:t,tag:r.Tags.Span}}n.__esModule=!0;var r=t("./../Constants"),o="obf-star",a={children:[{attributes:[{name:r.AttributeName.Id,value:o},{name:r.AttributeName.X,value:"0"},{name:r.AttributeName.Y,value:"0"},{name:r.AttributeName.Width,value:"105"},{name:r.AttributeName.Height,value:"100"},{name:r.AttributeName.Points,value:"52.5, 80.3 84, 100 76.3, 63 105, 38 67.2, 35 52.5, 0 37.8, 35 0, 38 28.7, 63 20, 100 52.5, 80.3"}],id:o,tag:r.Tags.Polygon}],tag:r.Tags.Defs},s={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+o}],tag:r.Tags.Use},u={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+o},{name:r.AttributeName.Transform,value:"translate(105 0)"}],tag:r.Tags.Use},l={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+o},{name:r.AttributeName.Transform,value:"translate(210 0)"}],tag:r.Tags.Use},c={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+o},{name:r.AttributeName.Transform,value:"translate(315 0)"}],tag:r.Tags.Use},d={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+o},{name:r.AttributeName.Transform,value:"translate(420 0)"}],tag:r.Tags.Use},p={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 525 100"}],children:[a,s,u,l,c,d],classes:[r.Classes.RatingGraphic],tag:r.Tags.Svg},g={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 105 100"}],children:[a,s],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg},f={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 210 100"}],children:[a,s,u],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg},h={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 315 100"}],children:[a,s,u,l],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg},m={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 420 100"}],children:[a,s,u,l,c],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg},v={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 525 100"}],children:[a,s,u,l,c,d],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg};n.generate=i},{"./../Constants":45}],79:[function(t,e,n){"use strict";function i(t,e){if("undefined"==typeof t.brs&&(t.brs=!0),!t.brs)return null;t.tag||(t.tag=r.Tags.Div);var n;if(t.tag===r.Tags.Svg&&(e=!0),n=e?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),t.attributes)for(var o=void 0,a=0;a<t.attributes.length;a++)o=t.attributes[a],o.name===r.AttributeName.xlinkHref?n.setAttributeNS("http://www.w3.org/1999/xlink",r.AttributeName.HRef,o.value):n.setAttribute(o.name,o.value);if(t.id&&(n.id=t.id),t.classes){var s=t.classes.join(" ");e?n.setAttribute(r.AttributeName.Class,s):n.className=s}if(t.innerText&&!e&&(n.textContent=t.innerText),t.innerHTML&&!e&&(n.innerHTML=t.innerHTML),t.children)for(var a=0;a<t.children.length;a++){var u=t.children[a];if(u){var l=i(u,e);l&&n.appendChild(l)}}return n}n.__esModule=!0;var r=t("./../Constants");n.elementFromJson=i},{"./../Constants":45}],80:[function(t,e,n){"use strict";function i(t){var e=r(t.element)-g;e<=0&&(e=1),o(t.element,e)}function r(t){return parseFloat(window.getComputedStyle(t).getPropertyValue("opacity"))}function o(t,e){t.style.opacity=e.toString()}function a(){var t=document.createElement("div");return t.classList.add(s.Classes.SpinnerCircle),t.style.width=t.style.height=p*d+"px",t}n.__esModule=!0;var s=t("./../Constants"),u=t("./Utils"),l=90,c=8,d=.2,p=34,g=1/c,f=function(){function t(t){this.circleObjects=[],this.spinnerId=t,this.spinner=document.getElementById(this.spinnerId),this.createCirclesAndArrange(),this.initializeOpacities(),this.start(),u.setElementVisibility(t,!0)}return t.prototype.destroy=function(){u.setElementVisibility(this.spinnerId,!1),this.stop()},t.prototype.start=function(){var t=this;this.stop(),this.interval=setInterval(function(){for(var e=t.circleObjects.length;e--;)i(t.circleObjects[e])},l)},t.prototype.stop=function(){clearInterval(this.interval)},t.prototype.createCirclesAndArrange=function(){for(var t,e=0,n=p*d,i=2*Math.PI/c,r=c,o=.5*(p-n);r--;){var s=a(),u=Math.round(.5*p+o*Math.cos(e)-.5*s.clientWidth)-.5*n,l=Math.round(.5*p+o*Math.sin(e)-.5*s.clientHeight)-.5*n;this.spinner.appendChild(s),s.style.left=u+"px",s.style.top=l+"px",e+=i,t={element:s,j:r},this.circleObjects.push(t)}},t.prototype.initializeOpacities=function(){var t,e=0,n=1;for(e;e<c;e++){var i=this.circleObjects[e];t=g*n++,o(i.element,t)}},t}();n.Spinner=f},{"./../Constants":45,"./Utils":85}],81:[function(t,e,n){"use strict";function i(t){r(),h(t)}function r(){a()}function o(t,e,n){S.registerListener(t,e,n),I.push({event:e,id:t,listener:n})}function a(){for(var t=0,e=I;t<e.length;t++){var n=e[t];S.unregisterListener(n.id,n.event,n.listener)}I=[]}function s(t){void 0===t&&(t=function(t){}),h=t,m=!0,o(y.IDs.ToastContainer,"keyup",l),o(y.IDs.ToastCancel,"click",c),o(y.IDs.TPromptContainer,"click",d),o(y.IDs.TFormSubmitButton,"click",f),o(y.IDs.TFormEmailCheckBox,"click",u),u(null);for(var e=document.querySelectorAll('input[name="'+y.IDs.TFormRating+'"]'),n=0;n<e.length;++n)S.registerListenerToElement(e[n],"click",g);T.get().getFloodgateSurvey().showPrompt?C.getLogger().logEvent(C.EventIds.Survey.UI.Prompt.Shown.VALUE,{CampaignId:T.get().getFloodgateSurvey().getCampaignId(),SurveyId:T.get().getFloodgateSurvey().getId(),SurveyType:T.get().getFloodgateSurvey().getSurveyType()}):p();var r=T.get().getFloodgateInitOptions().autoDismiss;if(r!==y.AutoDismissValues.NoAutoDismiss){var a=void 0;switch(r){case y.AutoDismissValues.SevenSeconds:a=7e3;break;case y.AutoDismissValues.FourteenSeconds:a=14e3;break;case y.AutoDismissValues.TwentyOneSeconds:a=21e3;break;case y.AutoDismissValues.TwentyEightSeconds:a=28e3}void 0!==a&&setTimeout(function(){m&&i(!1)},a)}}function u(t){var e=document.getElementById(y.IDs.TFormEmailCheckBox);if(e){var n=document.getElementById(y.IDs.TFormEmailTextBox);n.value=e.checked?T.get().getCommonInitOptions().userEmail:null,n.disabled=!e.checked}}function l(t){t.keyCode===y.Keys.Esc&&(t.preventDefault(),t.stopPropagation(),i(!1))}function c(t){t.preventDefault(),t.stopPropagation(),i(!1)}function d(t){t.preventDefault(),t.stopPropagation(),p()}function p(){m=!1,S.setElementVisibility(y.IDs.TPromptContainer,!1),S.setElementVisibility(y.IDs.TFormContainer,!0),C.getLogger().logEvent(C.EventIds.Survey.UI.Form.Shown.VALUE,{CampaignId:T.get().getFloodgateSurvey().getCampaignId(),SurveyId:T.get().getFloodgateSurvey().getId(),SurveyType:T.get().getFloodgateSurvey().getSurveyType()})}function g(t){document.getElementById(y.IDs.TFormSubmitButton).disabled=!1}function f(t){t.preventDefault(),t.stopPropagation(),S.setElementVisibility(y.IDs.TFormSubmitButton,!1);var e=new b.Spinner(y.IDs.TFormSubmitButtonSpinner),n=new v.Transporter(T.get().getCommonInitOptions().environment,w.ISurvey.Type[T.get().getFloodgateSurvey().getSurveyType()],T.get().getCommonInitOptions().appId,"Survey",T.get().getCommonInitOptions().applicationGroup,T.get().getCommonInitOptions().telemetryGroup,T.get().getCommonInitOptions().webGroup),r=document.getElementById(y.IDs.TFormComment),o=r&&!!r.value,a=document.querySelector('input[name="'+y.IDs.TFormRating+'"]:checked');T.get().getFloodgateSurvey().setValues(Number(a.value),o?r.value:""),n.setManifestValues(T.get().getFloodgateSurvey().getJsonElements());var s=document.getElementById(y.IDs.TFormEmailCheckBox),u=document.getElementById(y.IDs.TFormEmailTextBox);s&&s.checked&&""!==u.value&&n.setEmail(u.value),n.submit(),e.destroy(),i(!0),C.getLogger().logEvent(C.EventIds.Survey.UI.Form.Submit.VALUE,{CampaignId:T.get().getFloodgateSurvey().getCampaignId(),SurveyId:T.get().getFloodgateSurvey().getId(),SurveyType:T.get().getFloodgateSurvey().getSurveyType()})}n.__esModule=!0;var h,m,v=t("./../../Transport/Transport"),y=t("./../../Constants"),S=t("./../Utils"),b=t("./../SpinnerControl"),C=t("./../../Logging/Logging"),T=t("./../../Configuration/Configuration"),w=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),I=[];n.register=s},{"./../../Configuration/Configuration":44,"./../../Constants":45,"./../../Logging/Logging":56,"./../../Transport/Transport":66,"./../SpinnerControl":80,"./../Utils":85,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],82:[function(t,e,n){"use strict";function i(){var t={attributes:[{name:c.AttributeName.DataHtml2CanvasIgnore,value:c.AttributeValue.True},{name:c.AttributeName.Role,value:"dialog"},{name:"aria-labelledby",value:c.IDs.TPromptTitle},{name:"aria-describedby",value:c.IDs.TPromptText}],children:[{attributes:[{name:c.AttributeName.Type,value:c.AttributeValue.Button},{name:c.AttributeName.AriaLabel,value:d.getUIStrings().CloseLabel}],id:c.IDs.ToastCancel,innerHTML:'<svg viewBox="4 4 16 16" width="16px" height="16px" focusable="false"><path d="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z" fill="#000"/></svg>',tag:c.Tags.Button},r(),a()],classes:[c.Classes.Toast,p.isRightToLeft()?c.Classes.Rtl:""],id:c.IDs.ToastContainer};return t}function r(){var t={attributes:[{name:"aria-labelledby",value:c.IDs.TPromptTitle}],children:[{classes:[c.Classes.FontText,c.Classes.TextAlignLeft],id:c.IDs.TPromptTitle,innerText:l.get().getFloodgateSurvey().getTitle()},{classes:[c.Classes.FontSubText,c.Classes.TextAlignLeft],id:c.IDs.TPromptText,innerText:l.get().getFloodgateSurvey().getPromptQuestion()}],id:c.IDs.TPromptContainer,tag:c.Tags.Button};return t}function o(){var t=l.get().getCommonInitOptions().userEmailConsentDefault;return t?g.AttributeValue.Checked:g.AttributeValue.Unchecked}function a(){var t={children:[{classes:[c.Classes.FontText,c.Classes.TextAlignLeft],id:c.IDs.TFormTitle,innerText:l.get().getFloodgateSurvey().getTitle()},s(),{attributes:[{name:c.AttributeName.Placeholder,value:l.get().getFloodgateSurvey().getCommentQuestion()},{name:c.AttributeName.AriaLabel,value:l.get().getFloodgateSurvey().getCommentQuestion()},{name:c.AttributeName.MaxLength,value:c.AttributeValue.TextAreaMaxLength}],classes:[c.Classes.FontSubText,c.Classes.TextInput],id:c.IDs.TFormComment,tag:c.Tags.TextArea},{brs:l.get().getFloodgateSurvey().showEmailRequest,children:[{attributes:[{name:g.AttributeName.Type,value:g.AttributeValue.Checkbox},{name:o(),value:""}],classes:[g.Classes.TFormEmailCheckbox,g.Classes.CheckBox],id:g.IDs.TFormEmailCheckBox,tag:g.Tags.Input},{attributes:[{name:g.AttributeName.For,value:g.IDs.TFormEmailCheckBox}],classes:[g.Classes.FontSubText,g.Classes.TextAlignLeft,g.Classes.TFormEmailLabel],innerText:d.getUIStrings().Form.EmailCheckBoxLabel,tag:g.Tags.Label},{attributes:[{name:g.AttributeName.Type,value:g.AttributeValue.Text},{name:g.AttributeName.Placeholder,value:d.getUIStrings().Form.EmailPlaceholder},{name:g.AttributeName.AriaLabel,value:d.getUIStrings().Form.EmailPlaceholder},{name:g.AttributeName.Name,value:g.IDs.BasicFormEmailInput},{name:g.AttributeName.MaxLength,value:g.AttributeValue.TextAreaMaxLength},{name:g.AttributeName.Value,value:l.get().getCommonInitOptions().userEmailConsentDefault?l.get().getCommonInitOptions().userEmail:""}],classes:[g.Classes.FontSubText,g.Classes.FormEmailInput,g.Classes.TextInput],id:g.IDs.TFormEmailTextBox,tag:g.Tags.Input}]},{children:[{attributes:[{name:c.AttributeName.HRef,value:c.Urls.PrivacyStatementLink},{name:c.AttributeName.Target,value:c.AttributeValue.BlankWindow},{name:c.AttributeName.Rel,value:c.AttributeValue.NoReferrer}],classes:[c.Classes.Link],innerText:d.getUIStrings().PrivacyStatement,tag:c.Tags.Anchor}],classes:[c.Classes.FontSubSubText,c.Classes.TextAlignLeft,c.Classes.PrivacyStatementLinkDiv]},{children:[{attributes:[{name:c.AttributeName.Disabled,value:c.AttributeValue.True}],classes:[c.Classes.FontSubText,c.Classes.SubmitButton],id:c.IDs.TFormSubmitButton,innerText:d.getUIStrings().Form.Submit,tag:c.Tags.Button},{classes:[c.Classes.Spinner,c.Classes.Hidden],id:c.IDs.TFormSubmitButtonSpinner,tag:c.Tags.Div}],id:c.IDs.TFormSubmitButtonContainer}],classes:[c.Classes.Hidden],id:c.IDs.TFormContainer};return t}function s(){for(var t=[],e=l.get().getFloodgateSurvey().getRatingValuesAscending(),n=0,i=0,r=e;i<r.length;i++){var o=r[i];t.push([n,o]),n++}return u.generateRadioGroup(c.IDs.TFormRating,l.get().getFloodgateSurvey().getRatingQuestion(),t.reverse())}n.__esModule=!0;var u=t("./../ChoiceGroupControl"),l=t("./../../Configuration/Configuration"),c=t("./../../Constants"),d=t("./../../UIStrings/UIStrings"),p=t("./../Utils"),g=t("./../../Constants");n.generate=i},{"./../../Configuration/Configuration":44,"./../../Constants":45,"./../../UIStrings/UIStrings":67,"./../ChoiceGroupControl":77,"./../Utils":85}],83:[function(t,e,n){"use strict";function i(t){r(u.elementFromJson(s.generate())),a.register(function(e){l.setElementVisibility(o.IDs.ToastContainer,!1),l.deleteElementById(o.IDs.ToastContainer),c.get().getFloodgateInitOptions().onDismiss(c.get().getFloodgateSurvey().getCampaignId(),e),t()})}function r(t){document.body.insertBefore(t,document.body.firstChild),l.setElementVisibility(o.IDs.ToastContainer,!0)}n.__esModule=!0;var o=t("./../../Constants"),a=t("./Events"),s=t("./Layout"),u=t("./../Renderer"),l=t("./../Utils"),c=t("./../../Configuration/Configuration");n.createSurvey=i},{"./../../Configuration/Configuration":44,"./../../Constants":45,"./../Renderer":79,"./../Utils":85,"./Events":81,"./Layout":82}],84:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./BellyBand/BellyBand");n.createBellyBandMulti=i.createMulti;var r=t("./BellyBand/BellyBand");n.createBellyBandSingle=r.createSingle;var o=t("./Toast/Toast");n.createSurvey=o.createSurvey},{"./BellyBand/BellyBand":68,"./Toast/Toast":83}],85:[function(t,e,n){"use strict";function i(t,e){var n=e?m.Classes.Hidden:m.Classes.Visible,i=e?m.Classes.Visible:m.Classes.Hidden;s(t,n,i)}function r(t){var e=document.getElementById(t);null!=e&&null!=e.parentNode&&e.parentNode.removeChild(e)}function o(t,e){var n=document.getElementById(t);n&&(n.className.match(new RegExp("\\b"+e+"\\b"))||(n.className=n.className+" "+e))}function a(t,e){var n=document.getElementById(t);n&&(n.className=n.className.split(new RegExp("\\b"+e+"\\b","i")).join(" "),n.className=n.className.split(/\s+/).join(" "))}function s(t,e,n){a(t,e),o(t,n)}function u(t,e,n){var i=document.getElementById(t);i&&i.setAttribute(e,n)}function l(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}function c(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&t.detachEvent("on"+e,n)}function d(t,e,n){var i=document.getElementById(t);i&&l(i,e,n)}function p(t,e,n){t&&l(t,e,n)}function g(t,e,n){var i=document.getElementById(t);i&&c(i,e,n)}function f(){var t=-1,e=window.navigator.userAgent;if(e.indexOf("Trident")>-1){var n=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})");null!=n.exec(e)&&(t=parseFloat(RegExp.$1),t+=4)}return t}function h(){return"rtl"===getComputedStyle(document.documentElement).direction}n.__esModule=!0;var m=t("./../Constants");n.setElementVisibility=i,n.deleteElementById=r,n.addClassById=o,n.deleteClassById=a,n.replaceClassesById=s,n.setAttributeOnHtmlElement=u,n.addEventListenerHelper=l,n.removeEventListenerHelper=c,n.registerListener=d,n.registerListenerToElement=p,n.unregisterListener=g,n.getInternetExplorerVersion=f,n.isRightToLeft=h},{"./../Constants":45}],86:[function(t,e,n){"use strict";function i(t){return"number"==typeof t}function r(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}function o(t){return"string"==typeof t}function a(t){return!u(t)&&"object"==typeof t}function s(t){return"boolean"==typeof t}function u(t){return null==t}function l(t){return o(t)&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(t)}function c(t,e){if(!a(t))throw e+" is not an object: "+t}function d(t,e){if(!i(t))throw e+" is not a number: "+t}function p(t,e){if(!o(t))throw e+" is not a string: "+t}function g(t,e){if(!s(t))throw e+" is not a boolean: "+t}function f(t,e){if(!l(t))throw e+" is not a guid: "+t}function h(t,e){if(!Array.isArray(t))throw e+" is not an array: "+t}function m(){return(v()+v()+"-"+v()+"-4"+v().substr(0,3)+"-"+v()+"-"+v()+v()+v()).toLowerCase()}function v(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function y(t,e){if(!e)return e;var n=e;if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}n.__esModule=!0,n.isInteger=r,n.isBoolean=s,n.expectObject=c,n.expectNumber=d,n.expectString=p,n.expectBoolean=g,n.expectGuid=f,n.expectArray=h,n.guid=m,n.overrideValues=y},{}],87:[function(t,e,n){"use strict";n.__esModule=!0,n.default="1.2.9"},{}],88:[function(t,e,n){"use strict";function i(){var t=800;return!window.innerWidth||window.innerWidth<t}n.__esModule=!0,n.isNarrow=i},{}],89:[function(t,e,n){"use strict";function i(){return window}function r(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.setUiStrings=t}function o(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.singleFeedback=t}function a(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.multiFeedback=t}function s(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.showSurvey=t}function u(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.showCustomSurvey=t}function l(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.initialize=t}function c(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.start=t}function d(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.stop=t}function p(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.getEngine=t}n.__esModule=!0,n.get=i,n.setSetUiStrings=r,n.setSingleFeedback=o,n.setMultiFeedback=a,n.setFloodgateShowSurvey=s,n.setFloodgateShowCustomSurvey=u,n.setFloodgateInitialize=l,n.setFloodgateStart=c,n.setFloodgateStop=d,n.setFloodgateGetEngine=p},{}],90:[function(t,e,n){!function(t,i){if("object"==typeof n&&"object"==typeof e)e.exports=i();else if("function"==typeof define&&define.amd)define([],i);else{var r=i();for(var o in r)("object"==typeof n?n:t)[o]=r[o]}}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e);
},e.p="",e(e.s=15)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.low=0,this.high=0,this.low=parseInt(t,10),this.low<0&&(this.high=-1)}return t.prototype.Equals=function(e){var n=new t(e);return this.low===n.low&&this.high===n.high},t}();e.Int64=i;var r=function(){function t(t){this.low=0,this.high=0,this.low=parseInt(t,10)}return t.prototype.Equals=function(e){var n=new t(e);return this.low===n.low&&this.high===n.high},t}();e.UInt64=r;var o=function(){function t(){}return t.ToByte=function(t){return this.ToUInt8(t)},t.ToInt16=function(t){var e=(32768&t)<<16>>16;return 32767&t|e},t.ToInt32=function(t){var e=2147483648&t;return 2147483647&t|e},t.ToUInt8=function(t){return 255&t},t.ToUInt32=function(t){return 4294967295&t},t}();e.Number=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i;!function(t){t[t.NotSet=0]="NotSet",t[t.DistinguishedName=1]="DistinguishedName",t[t.GenericData=2]="GenericData",t[t.IPV4Address=3]="IPV4Address",t[t.IPv6Address=4]="IPv6Address",t[t.MailSubject=5]="MailSubject",t[t.PhoneNumber=6]="PhoneNumber",t[t.QueryString=7]="QueryString",t[t.SipAddress=8]="SipAddress",t[t.SmtpAddress=9]="SmtpAddress",t[t.Identity=10]="Identity",t[t.Uri=11]="Uri",t[t.Fqdn=12]="Fqdn",t[t.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(i=e.AWTPiiKind||(e.AWTPiiKind={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),r=n(1),o=n(3),a=function(){function t(){}return t.getPayloadBlob=function(t,e){var n=new i.IO.MemoryStream,r=new i.CompactBinaryProtocolWriter(n);return r.WriteFieldBegin(i.BondDataType.BT_MAP,3),r.WriteMapContainerBegin(e,i.BondDataType.BT_STRING,i.BondDataType.BT_LIST),Object.keys(t).forEach(function(e){r.WriteString(e);var n=t[e];r.WriteContainerBegin(1,i.BondDataType.BT_STRUCT),r.WriteFieldBegin(i.BondDataType.BT_STRING,2),r.WriteString("act_default_source"),r.WriteFieldBegin(i.BondDataType.BT_STRING,5),r.WriteString(o.newGuid()),r.WriteFieldBegin(i.BondDataType.BT_INT64,6),r.WriteInt64(o.numberToBondInt64(Date.now())),r.WriteFieldBegin(i.BondDataType.BT_LIST,8),r.WriteContainerBegin(n.length,i.BondDataType.BT_STRUCT);for(var a=0;a<n.length;++a)r.WriteBlob(n[a]);r.WriteStructEnd(!1)}),r.WriteStructEnd(!1),n.GetBuffer()},t.getEventBlob=function(t){var e=new i.IO.MemoryStream,n=new i.CompactBinaryProtocolWriter(e);n.WriteFieldBegin(i.BondDataType.BT_STRING,1),n.WriteString(t.id),n.WriteFieldBegin(i.BondDataType.BT_INT64,3),n.WriteInt64(o.numberToBondInt64(t.timestamp)),n.WriteFieldBegin(i.BondDataType.BT_STRING,5),n.WriteString(t.type),n.WriteFieldBegin(i.BondDataType.BT_STRING,6),n.WriteString(t.name);var a=[],s=[];return Object.keys(t.properties).forEach(function(e){var n=t.properties[e];n.pii===r.AWTPiiKind.NotSet?a.push(e):s.push(e)}),a.length&&(n.WriteFieldBegin(i.BondDataType.BT_MAP,13),n.WriteMapContainerBegin(a.length,i.BondDataType.BT_STRING,i.BondDataType.BT_STRING),a.forEach(function(e){n.WriteString(e),n.WriteString(t.properties[e].value)})),s.length&&(n.WriteFieldBegin(i.BondDataType.BT_MAP,30),n.WriteMapContainerBegin(s.length,i.BondDataType.BT_STRING,i.BondDataType.BT_STRUCT),s.forEach(function(e){n.WriteString(e),n.WriteFieldBegin(i.BondDataType.BT_INT32,1),n.WriteInt32(1),n.WriteFieldBegin(i.BondDataType.BT_INT32,2),n.WriteInt32(t.properties[e].pii),n.WriteFieldBegin(i.BondDataType.BT_STRING,3),n.WriteString(t.properties[e].value),n.WriteStructEnd(!1)})),n.WriteStructEnd(!1),e.GetBuffer()},t.base64Encode=function(t){return i.Encoding.Base64.GetString(t)},t}();e.default=a},function(t,e,n){"use strict";function i(t){var e=new a.Int64("0");return e.low=4294967295&t,e.high=Math.floor(t/4294967296),e}function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(s,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})}function o(t){return!isNaN(t)&&null!==t&&t>=0&&t<=13}Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),s=/[xy]/g;e.numberToBondInt64=i,e.newGuid=r,e.isPii=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Version="1.2.2",e.FullVersionString="AWT-Web-CJS-"+e.Version},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1);e.AWTPiiKind=i.AWTPiiKind;var r=n(13);e.AWT=r.default,e.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i;!function(t){t[t.BT_STOP=0]="BT_STOP",t[t.BT_STOP_BASE=1]="BT_STOP_BASE",t[t.BT_UINT8=3]="BT_UINT8",t[t.BT_UINT32=5]="BT_UINT32",t[t.BT_UINT64=6]="BT_UINT64",t[t.BT_STRING=9]="BT_STRING",t[t.BT_STRUCT=10]="BT_STRUCT",t[t.BT_LIST=11]="BT_LIST",t[t.BT_MAP=13]="BT_MAP",t[t.BT_INT32=16]="BT_INT32",t[t.BT_INT64=17]="BT_INT64",t[t.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(i=e.BondDataType||(e.BondDataType={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=function(){function t(){}return t.GetBytes=function(t){for(var e=[],n=0;n<t.length;++n){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++n)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e},t}();e.Utf8=r;var o=function(){function t(){}return t.GetString=function(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=t.length%3,r=function(t){return[e.charAt(t>>18&63),e.charAt(t>>12&63),e.charAt(t>>6&63),e.charAt(63&t)].join("")},o=0,a=t.length-i;o<a;o+=3){var s=(t[o]<<16)+(t[o+1]<<8)+t[o+2];n.push(r(s))}switch(i){case 1:var s=t[t.length-1];n.push(e.charAt(s>>2)),n.push(e.charAt(s<<4&63)),n.push("==");break;case 2:var u=(t[t.length-2]<<8)+t[t.length-1];n.push(e.charAt(u>>10)),n.push(e.charAt(u>>4&63)),n.push(e.charAt(u<<2&63)),n.push("=")}return n.join("")},t}();e.Base64=o;var a=function(){function t(){}return t.GetBytes=function(t){for(var e=[];4294967168&t;)e.push(127&t|128),t>>>=7;return e.push(127&t),e},t}();e.Varint=a;var s=function(){function t(){}return t.GetBytes=function(t){for(var e=t.low,n=t.high,i=[];n||4294967168&e;)i.push(127&e|128),e=(127&n)<<25|e>>>7,n>>>=7;return i.push(127&e),i},t}();e.Varint64=s;var u=function(){function t(){}return t.EncodeZigzag32=function(t){return t=i.Number.ToInt32(t),t<<1^t>>31},t.EncodeZigzag64=function(t){var e=t.low,n=t.high,r=n<<1|e>>>31,o=e<<1;2147483648&n&&(r=~r,o=~o);var a=new i.UInt64("0");return a.low=o,a.high=r,a},t}();e.Zigzag=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=function(){function t(){this._buffer=[]}return t.prototype.WriteByte=function(t){this._buffer.push(i.Number.ToByte(t))},t.prototype.Write=function(t,e,n){for(;n--;)this.WriteByte(t[e++])},t.prototype.GetBuffer=function(){return this._buffer},t}();e.MemoryStream=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6);e.BondDataType=i.BondDataType;var r=n(7);e.Encoding=r;var o=n(8);e.IO=o;var a=n(0);e.Int64=a.Int64,e.UInt64=a.UInt64,e.Number=a.Number;var s=function(){function t(t){this._stream=t}return t.prototype.WriteBlob=function(t){this._stream.Write(t,0,t.length)},t.prototype.WriteContainerBegin=function(t,e){this.WriteUInt8(e),this.WriteUInt32(t)},t.prototype.WriteMapContainerBegin=function(t,e,n){this.WriteUInt8(e),this.WriteUInt8(n),this.WriteUInt32(t)},t.prototype.WriteFieldBegin=function(t,e){e<=5?this._stream.WriteByte(t|e<<5):e<=255?(this._stream.WriteByte(192|t),this._stream.WriteByte(e)):(this._stream.WriteByte(224|t),this._stream.WriteByte(e),this._stream.WriteByte(e>>8))},t.prototype.WriteInt32=function(t){t=r.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},t.prototype.WriteInt64=function(t){this.WriteUInt64(r.Zigzag.EncodeZigzag64(t))},t.prototype.WriteString=function(t){if(""===t)this.WriteUInt32(0);else{var e=r.Utf8.GetBytes(t);this.WriteUInt32(e.length),this._stream.Write(e,0,e.length)}},t.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?i.BondDataType.BT_STOP_BASE:i.BondDataType.BT_STOP)},t.prototype.WriteUInt32=function(t){var e=r.Varint.GetBytes(a.Number.ToUInt32(t));this._stream.Write(e,0,e.length)},t.prototype.WriteUInt64=function(t){var e=r.Varint64.GetBytes(t);this._stream.Write(e,0,e.length)},t.prototype.WriteUInt8=function(t){this._stream.WriteByte(a.Number.ToUInt8(t))},t}();e.CompactBinaryProtocolWriter=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=1e3,r=function(){function t(){this._killedTokenDictionary={}}return t.prototype.setKillSwitchTenants=function(t,e){var n=this;if(t&&e)try{var r=t.split(",");if("this-request-only"===e)return r;var o=parseInt(e,10)*i;r.forEach(function(t){n._killedTokenDictionary[t]=Date.now()+o})}catch(t){return[]}return[]},t.prototype.isTenantKilled=function(t){return void 0!==this._killedTokenDictionary[t]&&this._killedTokenDictionary[t]>Date.now()||(delete this._killedTokenDictionary[t],!1)},t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=function(){function t(t,e){this._maxRequestSize=t,this._outboundQueue=e,this._currentBatch={},this._currentBatchSize=0}return t.prototype.addEventToBatch=function(t){var e=i.default.getEventBlob(t);e.length>this._maxRequestSize||(this._currentBatchSize+e.length>this._maxRequestSize?this.flushBatch():(void 0===this._currentBatch[t.tenantToken]&&(this._currentBatch[t.tenantToken]=[]),this._currentBatch[t.tenantToken].push(e),this._currentBatchSize+=e.length))},t.prototype.flushBatch=function(){this._currentBatchSize>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentBatchSize=0)},t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=.8,r=1.2,o=3e3,a=12e4,s=function(){function t(){}return t.shouldRetryForStatus=function(t){return!(t>=300&&t<500&&408!==t||501===t||505===t)},t.getMillisToBackoffForRetry=function(t){var e=0,n=o*i,s=o*r,u=Math.floor(Math.random()*(s-n))+n;return e=Math.pow(4,t)*u,Math.min(e,a)},t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(14),o=n(3),a=n(4),s="allTkns",u=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,l=/\./g,c=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,d=function(){function t(){}return t.initialize=function(t,e){if(void 0===e&&(e={}),this._isInitialized)throw"Already Initialized";this._defaultTenantToken=t,this._overrideValuesFromConfig(e),r.default.initialize(this._config),this._isInitialized=!0},t.flush=function(t){this._isInitialized&&!this._isDestroyed&&r.default.flush(t)},t.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._isDestroyed=!0,r.default.flushAndTeardown())},t.setContext=function(t,e,n){void 0===n&&(n=s),e=this._sanitizeProperty(t,e),null!==e&&(this._contextProperties[n]||(this._contextProperties[n]={}),this._contextProperties[n][t]=e)},t.logEvent=function(t){var e=this;if(this._isInitialized){if(!t.name||!t.properties)return;t.name=t.name.toLowerCase(),t.name.replace(l,"_");var n="";if(t.type?(t.type.toLowerCase(),n="custom."):t.type="custom",!u.test(t.name)||!u.test(t.type))return;if(t.type=n+t.type,isNaN(t.timestamp)&&(t.timestamp=(new Date).getTime()),t.tenantToken||(t.tenantToken=this._defaultTenantToken),t.id=o.newGuid(),Object.keys(t.properties).forEach(function(n){t.properties[n]=e._sanitizeProperty(n,t.properties[n]),null===t.properties[n]&&delete t.properties[n]}),this._addContextIfAbsent(t,t.tenantToken),this._addContextIfAbsent(t,s),0===Object.keys(t.properties).length)return;this._setDefaultProperty(t,"EventInfo.InitId",this._getInitId(t.tenantToken)),this._setDefaultProperty(t,"EventInfo.Sequence",this._getSequenceId(t.tenantToken)),this._setDefaultProperty(t,"EventInfo.SdkVersion",a.FullVersionString),this._setDefaultProperty(t,"EventInfo.Name",t.name),this._setDefaultProperty(t,"EventInfo.Time",new Date(t.timestamp).toISOString()),r.default.sendEvent(t)}},t._overrideValuesFromConfig=function(t){t.collectorUrl&&(this._config.collectorUrl=t.collectorUrl),t.sendingTimer>1e3&&(this._config.sendingTimer=t.sendingTimer)},t._getInitId=function(t){return void 0===this._initIdMap[t]&&(this._initIdMap[t]=o.newGuid()),this._initIdMap[t]},t._getSequenceId=function(t){return void 0===this._sequenceIdMap[t]&&(this._sequenceIdMap[t]=0),(++this._sequenceIdMap[t]).toString()},t._setDefaultProperty=function(t,e,n){t.properties[e]={value:n,pii:i.AWTPiiKind.NotSet}},t._addContextIfAbsent=function(t,e){if(this._contextProperties[e]){var n=this._contextProperties[e];Object.keys(n).forEach(function(e){t.properties[e]||(t.properties[e]=n[e])})}},t._sanitizeProperty=function(t,e){return"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e||(e={value:e}),c.test(t)&&void 0!==e&&null!==e&&null!==e.value&&void 0!==e.value&&""!==e.value?("undefined"==typeof e.pii&&(e.pii=i.AWTPiiKind.NotSet),e.value=e.value.toString(),o.isPii(e.pii)?e:null):null},t._isInitialized=!1,t._isDestroyed=!1,t._contextProperties={},t._sequenceIdMap={},t._initIdMap={},t._config={collectorUrl:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",sendingTimer:1e3},t}();e.default=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),r=n(2),o=n(12),a=n(10),s=n(4),u=250,l=2936012,c=4,d=function(){function t(){}return t.initialize=function(t){this._inboundQueues.push([]),this._recordBatcher=new i.default(l,this._outboundQueue),this._newEventsAllowed=!0,"undefined"==typeof Uint8Array&&(this._urlString+="&content-encoding=base64"),this._sendingTimer=t.sendingTimer,this._urlString=t.collectorUrl+this._urlString+"&x-apikey="},t.sendEvent=function(t){var e=this;this._newEventsAllowed&&(this._inboundQueues[this._inboundQueues.length-1].push(t),!this._running&&this._timeout<0&&!this._isCurrentlyFlushing&&(this._timeout=setTimeout(function(){return e._batchAndSendEvents(!1)},this._sendingTimer)))},t.flushAndTeardown=function(){this._newEventsAllowed=!1,this._batchAndSendEvents(!0)},t.flush=function(t){this._inboundQueues.push([]),this._isCurrentlyFlushing?this._flushQueue.push(t):(this._isCurrentlyFlushing=!0,this._flush(t))},t._batchAndSendEvents=function(t){for(this._running=!0;this._inboundQueues[0].length>0&&this._outboundQueue.length<1;)this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());0===this._outboundQueue.length&&this._recordBatcher.flushBatch(),this._sendRequest(this._outboundQueue.pop(),0,t)},t._retryRequestIfNeeded=function(t,e,n,i,r){var a=this,s=!0;if(t&&"undefined"!=typeof t.status){var u=this._killSwitch.setKillSwitchTenants(t.getResponseHeader("kill-tokens"),t.getResponseHeader("kill-duration-seconds"));u.forEach(function(t){delete e[t],n--}),(!o.default.shouldRetryForStatus(t.status)||n<=0)&&(s=!1)}s&&r<c?setTimeout(function(){return a._sendRequest(e,r+1,!1)},o.default.getMillisToBackoffForRetry(r)):this._handleRequestFinished(null)},t._sendRequest=function(t,e,n){var i=this;try{var o=new XMLHttpRequest,a=0,s="";if(Object.keys(t).forEach(function(e){i._killSwitch.isTenantKilled(e)?delete t[e]:(s.length>0&&(s+=","),s+=e,a++)}),o.open("POST",this._urlString+s,!n),n||(o.ontimeout=function(){i._retryRequestIfNeeded(o,t,a,s,e)},o.onerror=function(){i._retryRequestIfNeeded(o,t,a,s,e)},o.onload=function(){i._handleRequestFinished(o)}),a>0){var u=r.default.getPayloadBlob(t,a);"undefined"==typeof Uint8Array?o.send(r.default.base64Encode(u)):o.send(new Uint8Array(u))}else n&&this._handleRequestFinished(null)}catch(t){this._handleRequestFinished(null)}},t._handleRequestFinished=function(t){var e=this;t&&this._killSwitch.setKillSwitchTenants(t.getResponseHeader("kill-tokens"),t.getResponseHeader("kill-duration-seconds")),this._inboundQueues[0].length>0?this._timeout=setTimeout(function(){return e._batchAndSendEvents(!1)},this._sendingTimer):(this._timeout=-1,this._running=!1)},t._flush=function(t){var e=this;this._running||(this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._inboundQueues[0].length>0&&this._batchAndSendEvents(!1)),this._checkPrimaryInboundQueueEmpty(function(){e._inboundQueues.shift(),null!==t&&void 0!==t&&t(),e._flushQueue.length>0?setTimeout(function(){return e._flush(e._flushQueue.shift())},e._sendingTimer):(e._isCurrentlyFlushing=!1,e._inboundQueues[0].length>0&&(e._timeout=setTimeout(function(){return e._batchAndSendEvents(!1)},e._sendingTimer)))})},t._checkPrimaryInboundQueueEmpty=function(t){var e=this;0===this._inboundQueues[0].length?this._checkOutboundQueueEmptyAndSent(t):setTimeout(function(){return e._checkPrimaryInboundQueueEmpty(t)},u)},t._checkOutboundQueueEmptyAndSent=function(t){var e=this;this._running?setTimeout(function(){return e._checkOutboundQueueEmptyAndSent(t)},u):t()},t._outboundQueue=[],t._inboundQueues=[],t._newEventsAllowed=!1,t._killSwitch=new a.default,t._isCurrentlyFlushing=!1,t._flushQueue=[],t._running=!1,t._timeout=-1,t._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+s.FullVersionString,t}();e.default=d},function(t,e,n){t.exports=n(5)}])})},{}],91:[function(t,e,n){(function(e){var n=t("es6-promise").Promise;!function(t){window.OfficeBrowserFeedback.html2canvas=t}(function(){var i;return function e(n,i,r){function o(s,u){if(!i[s]){if(!n[s]){var l="function"==typeof t&&t;if(!u&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[s]={exports:{}};n[s][0].call(d.exports,function(t){var e=n[s][1][t];return o(e?e:t)},d,d.exports,e,n,i,r)}return i[s].exports}for(var a="function"==typeof t&&t,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,n,r){(function(t){!function(e){function o(t){throw RangeError(k[t])}function a(t,e){for(var n=t.length;n--;)t[n]=e(t[n]);return t}function s(t,e){return a(t.split(B),e).join(".")}function u(t){for(var e,n,i=[],r=0,o=t.length;r<o;)e=t.charCodeAt(r++),e>=55296&&e<=56319&&r<o?(n=t.charCodeAt(r++),56320==(64512&n)?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--)):i.push(e);return i}function l(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=U(t>>>10&1023|55296),t=56320|1023&t),e+=U(t)}).join("")}function c(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:w}function d(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function p(t,e,n){var i=0;for(t=n?L(t/F):t>>1,t+=L(t/e);t>P*A>>1;i+=w)t=L(t/P);return L(i+(P+1)*t/(t+E))}function g(t){var e,n,i,r,a,s,u,d,g,f,h=[],m=t.length,v=0,y=x,S=D;for(n=t.lastIndexOf(N),n<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&o("not-basic"),h.push(t.charCodeAt(i));for(r=n>0?n+1:0;r<m;){for(a=v,s=1,u=w;r>=m&&o("invalid-input"),d=c(t.charCodeAt(r++)),(d>=w||d>L((T-v)/s))&&o("overflow"),v+=d*s,g=u<=S?I:u>=S+A?A:u-S,!(d<g);u+=w)f=w-g,s>L(T/f)&&o("overflow"),s*=f;e=h.length+1,S=p(v-a,e,0==a),L(v/e)>T-y&&o("overflow"),y+=L(v/e),v%=e,h.splice(v++,0,y)}return l(h)}function f(t){var e,n,i,r,a,s,l,c,g,f,h,m,v,y,S,b=[];for(t=u(t),m=t.length,e=x,n=0,a=D,s=0;s<m;++s)h=t[s],h<128&&b.push(U(h));for(i=r=b.length,r&&b.push(N);i<m;){for(l=T,s=0;s<m;++s)h=t[s],h>=e&&h<l&&(l=h);for(v=i+1,l-e>L((T-n)/v)&&o("overflow"),n+=(l-e)*v,e=l,s=0;s<m;++s)if(h=t[s],h<e&&++n>T&&o("overflow"),h==e){for(c=n,g=w;f=g<=a?I:g>=a+A?A:g-a,!(c<f);g+=w)S=c-f,y=w-f,b.push(U(d(f+S%y,0))),c=L(S/y);b.push(U(d(c,0))),a=p(n,v,i==r),n=0,++i}++n,++e}return b.join("")}function h(t){return s(t,function(t){return O.test(t)?g(t.slice(4).toLowerCase()):t})}function m(t){return s(t,function(t){return _.test(t)?"xn--"+f(t):t})}var v="object"==typeof r&&r,y="object"==typeof n&&n&&n.exports==v&&n,S="object"==typeof t&&t;S.global!==S&&S.window!==S||(e=S);var b,C,T=2147483647,w=36,I=1,A=26,E=38,F=700,D=72,x=128,N="-",O=/^xn--/,_=/[^ -~]/,B=/\x2E|\u3002|\uFF0E|\uFF61/g,k={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},P=w-I,L=Math.floor,U=String.fromCharCode;if(b={version:"1.2.4",ucs2:{decode:u,encode:l},decode:g,encode:f,toASCII:m,toUnicode:h},"function"==typeof i&&"object"==typeof i.amd&&i.amd)i("punycode",function(){return b});else if(v&&!v.nodeType)if(y)y.exports=b;else for(C in b)b.hasOwnProperty(C)&&(v[C]=b[C]);else e.punycode=b}(this)}).call(this,"undefined"!=typeof e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,i){function r(t,e,n){!t.defaultView||e===t.defaultView.pageXOffset&&n===t.defaultView.pageYOffset||t.defaultView.scrollTo(e,n)}function o(t,e){try{e&&(e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t.getContext("2d").getImageData(0,0,t.width,t.height),0,0))}catch(e){u("Unable to copy canvas content from",t,e)}}function a(t,e){for(var n=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),i=t.firstChild;i;)e!==!0&&1===i.nodeType&&"SCRIPT"===i.nodeName||n.appendChild(a(i,e)),i=i.nextSibling;return 1===t.nodeType&&(n._scrollTop=t.scrollTop,n._scrollLeft=t.scrollLeft,"CANVAS"===t.nodeName?o(t,n):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(n.value=t.value)),n}function s(t){if(1===t.nodeType){t.scrollTop=t._scrollTop,t.scrollLeft=t._scrollLeft;for(var e=t.firstChild;e;)s(e),e=e.nextSibling}}var u=t("./log");e.exports=function(t,e,i,o,u,l,c){var d=a(t.documentElement,u.javascriptEnabled),p=e.createElement("iframe");return p.className="html2canvas-container",p.style.visibility="hidden",p.style.position="fixed",p.style.left="-10000px",p.style.top="0px",p.style.border="0",p.width=i,p.height=o,p.scrolling="no",e.body.appendChild(p),new n(function(e){var n=p.contentWindow.document;p.contentWindow.onload=p.onload=function(){var t=setInterval(function(){n.body.childNodes.length>0&&(s(n.documentElement),clearInterval(t),"view"===u.type&&(p.contentWindow.scrollTo(l,c),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||p.contentWindow.scrollY===c&&p.contentWindow.scrollX===l||(n.documentElement.style.top=-c+"px",n.documentElement.style.left=-l+"px",n.documentElement.style.position="absolute")),e(p))},50)},n.open(),n.write("<!DOCTYPE html><html></html>"),r(t,l,c),n.replaceChild(n.adoptNode(d),n.documentElement),n.close()})}},{"./log":13}],3:[function(t,e,n){function i(t){this.r=0,this.g=0,this.b=0,this.a=null;this.fromArray(t)||this.namedColor(t)||this.rgb(t)||this.rgba(t)||this.hex6(t)||this.hex3(t)}i.prototype.darken=function(t){var e=1-t;return new i([Math.round(this.r*e),Math.round(this.g*e),Math.round(this.b*e),this.a])},i.prototype.isTransparent=function(){return 0===this.a},i.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},i.prototype.fromArray=function(t){return Array.isArray(t)&&(this.r=Math.min(t[0],255),this.g=Math.min(t[1],255),this.b=Math.min(t[2],255),t.length>3&&(this.a=t[3])),Array.isArray(t)};var r=/^#([a-f0-9]{3})$/i;i.prototype.hex3=function(t){var e=null;return null!==(e=t.match(r))&&(this.r=parseInt(e[1][0]+e[1][0],16),this.g=parseInt(e[1][1]+e[1][1],16),this.b=parseInt(e[1][2]+e[1][2],16)),null!==e};var o=/^#([a-f0-9]{6})$/i;i.prototype.hex6=function(t){var e=null;return null!==(e=t.match(o))&&(this.r=parseInt(e[1].substring(0,2),16),this.g=parseInt(e[1].substring(2,4),16),this.b=parseInt(e[1].substring(4,6),16)),null!==e};var a=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;i.prototype.rgb=function(t){var e=null;return null!==(e=t.match(a))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3])),null!==e};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;i.prototype.rgba=function(t){var e=null;return null!==(e=t.match(s))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3]),this.a=Number(e[4])),null!==e},i.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},i.prototype.namedColor=function(t){t=t.toLowerCase();var e=u[t];if(e)this.r=e[0],this.g=e[1],this.b=e[2];else if("transparent"===t)return this.r=this.g=this.b=this.a=0,!0;return!!e},i.prototype.isColor=!0;var u={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};e.exports=i},{}],4:[function(t,e,r){function o(t,e){var i=I++;if(e=e||{},e.logging&&(y.options.logging=!0,y.options.start=Date.now()),e.async="undefined"==typeof e.async||e.async,e.allowTaint="undefined"!=typeof e.allowTaint&&e.allowTaint,e.removeContainer="undefined"==typeof e.removeContainer||e.removeContainer,e.javascriptEnabled="undefined"!=typeof e.javascriptEnabled&&e.javascriptEnabled,e.imageTimeout="undefined"==typeof e.imageTimeout?1e4:e.imageTimeout,e.renderer="function"==typeof e.renderer?e.renderer:f,e.strict=!!e.strict,"string"==typeof t){if("string"!=typeof e.proxy)return n.reject("Proxy must be used when rendering url");var r=null!=e.width?e.width:window.innerWidth,o=null!=e.height?e.height:window.innerHeight;return C(p(t),e.proxy,document,r,o,e).then(function(t){return s(t.contentWindow.document.documentElement,t,e,r,o)})}var u=(void 0===t?[document.documentElement]:t.length?t:[t])[0];return u.setAttribute(w+i,i),a(u.ownerDocument,e,u.ownerDocument.defaultView.innerWidth,u.ownerDocument.defaultView.innerHeight,i).then(function(t){return"function"==typeof e.onrendered&&(y("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),e.onrendered(t)),t})}function a(t,e,i,r,o){return b(t,t,i,r,e,t.defaultView.pageXOffset,t.defaultView.pageYOffset).then(function(a){y("Document cloned");var u=w+o,l="["+u+"='"+o+"']";t.querySelector(l).removeAttribute(u);var c=a.contentWindow,d=c.document.querySelector(l),p="function"==typeof e.onclone?n.resolve(e.onclone(c.document)):n.resolve(!0);return p.then(function(){return s(d,a,e,i,r)})})}function s(t,e,n,i,r){var o=e.contentWindow,a=new g(o.document),s=new h(n,a),p=T(t),f="view"===n.type?i:c(o.document),v="view"===n.type?r:d(o.document),S=new n.renderer(f,v,s,n,document),b=new m(t,S,a,s,n);return b.ready.then(function(){y("Finished rendering");var i;return i="view"===n.type?l(S.canvas,{width:S.canvas.width,height:S.canvas.height,top:0,left:0,x:0,y:0}):t===o.document.body||t===o.document.documentElement||null!=n.canvas?S.canvas:l(S.canvas,{width:null!=n.width?n.width:p.width,height:null!=n.height?n.height:p.height,top:p.top,left:p.left,x:0,y:0}),u(e,n),i})}function u(t,e){e.removeContainer&&(t.parentNode.removeChild(t),y("Cleaned up container"))}function l(t,e){var n=document.createElement("canvas"),i=Math.min(t.width-1,Math.max(0,e.left)),r=Math.min(t.width,Math.max(1,e.left+e.width)),o=Math.min(t.height-1,Math.max(0,e.top)),a=Math.min(t.height,Math.max(1,e.top+e.height));n.width=e.width,n.height=e.height;var s=r-i,u=a-o;return y("Cropping canvas at:","left:",e.left,"top:",e.top,"width:",s,"height:",u),y("Resulting crop with width",e.width,"and height",e.height,"with x",i,"and y",o),n.getContext("2d").drawImage(t,i,o,s,u,e.x,e.y,s,u),n}function c(t){return Math.max(Math.max(t.body.scrollWidth,t.documentElement.scrollWidth),Math.max(t.body.offsetWidth,t.documentElement.offsetWidth),Math.max(t.body.clientWidth,t.documentElement.clientWidth))}function d(t){return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}function p(t){var e=document.createElement("a");return e.href=t,e.href=e.href,e}var g=t("./support"),f=t("./renderers/canvas"),h=t("./imageloader"),m=t("./nodeparser"),v=t("./nodecontainer"),y=t("./log"),S=t("./utils"),b=t("./clone"),C=t("./proxy").loadUrlDocument,T=S.getBounds,w="data-html2canvas-node",I=0;o.CanvasRenderer=f,o.NodeContainer=v,o.log=y,o.utils=S;var A="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return n.reject("No canvas support")}:o;e.exports=A,"function"==typeof i&&i.amd&&i("html2canvas",[],function(){return A})},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(t,e,i){function r(t){if(this.src=t,o("DummyImageContainer for",t),!this.promise||!this.image){o("Initiating DummyImageContainer"),r.prototype.image=new Image;var e=this.image;r.prototype.promise=new n(function(t,n){
e.onload=t,e.onerror=n,e.src=a(),e.complete===!0&&t(e)})}}var o=t("./log"),a=t("./utils").smallImage;e.exports=r},{"./log":13,"./utils":26}],6:[function(t,e,n){function i(t,e){var n,i,o=document.createElement("div"),a=document.createElement("img"),s=document.createElement("span"),u="Hidden Text";o.style.visibility="hidden",o.style.fontFamily=t,o.style.fontSize=e,o.style.margin=0,o.style.padding=0,document.body.appendChild(o),a.src=r(),a.width=1,a.height=1,a.style.margin=0,a.style.padding=0,a.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=e,s.style.margin=0,s.style.padding=0,s.appendChild(document.createTextNode(u)),o.appendChild(s),o.appendChild(a),n=a.offsetTop-s.offsetTop+1,o.removeChild(s),o.appendChild(document.createTextNode(u)),o.style.lineHeight="normal",a.style.verticalAlign="super",i=a.offsetTop-o.offsetTop+1,document.body.removeChild(o),this.baseline=n,this.lineWidth=1,this.middle=i}var r=t("./utils").smallImage;e.exports=i},{"./utils":26}],7:[function(t,e,n){function i(){this.data={}}var r=t("./font");i.prototype.getMetrics=function(t,e){return void 0===this.data[t+"-"+e]&&(this.data[t+"-"+e]=new r(t,e)),this.data[t+"-"+e]},e.exports=i},{"./font":6}],8:[function(t,e,i){function r(e,i,r){this.image=null,this.src=e;var o=this,s=a(e);this.promise=(i?new n(function(t){"about:blank"===e.contentWindow.document.URL||null==e.contentWindow.document.documentElement?e.contentWindow.onload=e.onload=function(){t(e)}:t(e)}):this.proxyLoad(r.proxy,s,r)).then(function(e){var n=t("./core");return n(e.contentWindow.document.documentElement,{type:"view",width:e.width,height:e.height,proxy:r.proxy,javascriptEnabled:r.javascriptEnabled,removeContainer:r.removeContainer,allowTaint:r.allowTaint,imageTimeout:r.imageTimeout/2})}).then(function(t){return o.image=t})}var o=t("./utils"),a=o.getBounds,s=t("./proxy").loadUrlDocument;r.prototype.proxyLoad=function(t,e,n){var i=this.src;return s(i.src,t,i.ownerDocument,e.width,e.height,n)},e.exports=r},{"./core":4,"./proxy":16,"./utils":26}],9:[function(t,e,i){function r(t){this.src=t.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=n.resolve(!0)}r.TYPES={LINEAR:1,RADIAL:2},r.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,e.exports=r},{}],10:[function(t,e,i){function r(t,e){this.src=t,this.image=new Image;var i=this;this.tainted=null,this.promise=new n(function(n,r){i.image.onload=n,i.image.onerror=r,e&&(i.image.crossOrigin="anonymous"),i.image.src=t,i.image.complete===!0&&n(i.image)})}e.exports=r},{}],11:[function(t,e,i){function r(t,e){this.link=null,this.options=t,this.support=e,this.origin=this.getOrigin(window.location.href)}var o=t("./log"),a=t("./imagecontainer"),s=t("./dummyimagecontainer"),u=t("./proxyimagecontainer"),l=t("./framecontainer"),c=t("./svgcontainer"),d=t("./svgnodecontainer"),p=t("./lineargradientcontainer"),g=t("./webkitgradientcontainer"),f=t("./utils").bind;r.prototype.findImages=function(t){var e=[];return t.reduce(function(t,e){switch(e.node.nodeName){case"IMG":return t.concat([{args:[e.node.src],method:"url"}]);case"svg":case"IFRAME":return t.concat([{args:[e.node],method:e.node.nodeName}])}return t},[]).forEach(this.addImage(e,this.loadImage),this),e},r.prototype.findBackgroundImage=function(t,e){return e.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(t,this.loadImage),this),t},r.prototype.addImage=function(t,e){return function(n){n.args.forEach(function(i){this.imageExists(t,i)||(t.splice(0,0,e.call(this,n)),o("Added image #"+t.length,"string"==typeof i?i.substring(0,100):i))},this)}},r.prototype.hasImageBackground=function(t){return"none"!==t.method},r.prototype.loadImage=function(t){if("url"===t.method){var e=t.args[0];return!this.isSVG(e)||this.support.svg||this.options.allowTaint?e.match(/data:image\/.*;base64,/i)?new a(e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),(!1)):this.isSameOrigin(e)||this.options.allowTaint===!0||this.isSVG(e)?new a(e,(!1)):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new a(e,(!0)):this.options.proxy?new u(e,this.options.proxy):new s(e):new c(e)}return"linear-gradient"===t.method?new p(t):"gradient"===t.method?new g(t):"svg"===t.method?new d(t.args[0],this.support.svg):"IFRAME"===t.method?new l(t.args[0],this.isSameOrigin(t.args[0].src),this.options):new s(t)},r.prototype.isSVG=function(t){return"svg"===t.substring(t.length-3).toLowerCase()||c.prototype.isInline(t)},r.prototype.imageExists=function(t,e){return t.some(function(t){return t.src===e})},r.prototype.isSameOrigin=function(t){return this.getOrigin(t)===this.origin},r.prototype.getOrigin=function(t){var e=this.link||(this.link=document.createElement("a"));return e.href=t,e.href=e.href,e.protocol+e.hostname+e.port},r.prototype.getPromise=function(t){return this.timeout(t,this.options.imageTimeout).catch(function(){var e=new s(t.src);return e.promise.then(function(e){t.image=e})})},r.prototype.get=function(t){var e=null;return this.images.some(function(n){return(e=n).src===t})?e:null},r.prototype.fetch=function(t){return this.images=t.reduce(f(this.findBackgroundImage,this),this.findImages(t)),this.images.forEach(function(t,e){t.promise.then(function(){o("Succesfully loaded image #"+(e+1),t)},function(n){o("Failed loading image #"+(e+1),t,n)})}),this.ready=n.all(this.images.map(this.getPromise,this)),o("Finished searching images"),this},r.prototype.timeout=function(t,e){var i,r=n.race([t.promise,new n(function(n,r){i=setTimeout(function(){o("Timed out loading image",t),r(t)},e)})]).then(function(t){return clearTimeout(i),t});return r.catch(function(){clearTimeout(i)}),r},e.exports=r},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(t,e,n){function i(t){r.apply(this,arguments),this.type=r.TYPES.LINEAR;var e=i.REGEXP_DIRECTION.test(t.args[0])||!r.REGEXP_COLORSTOP.test(t.args[0]);e?t.args[0].split(/\s+/).reverse().forEach(function(t,e){switch(t){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var n=this.y0,i=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=i,this.y1=n;break;case"center":break;default:var r=.01*parseFloat(t,10);if(isNaN(r))break;0===e?(this.y0=r,this.y1=1-this.y0):(this.x0=r,this.x1=1-this.x0)}},this):(this.y0=0,this.y1=1),this.colorStops=t.args.slice(e?1:0).map(function(t){var e=t.match(r.REGEXP_COLORSTOP),n=+e[2],i=0===n?"%":e[3];return{color:new o(e[1]),stop:"%"===i?n/100:null}}),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(t,e){null===t.stop&&this.colorStops.slice(e).some(function(n,i){return null!==n.stop&&(t.stop=(n.stop-this.colorStops[e-1].stop)/(i+1)+this.colorStops[e-1].stop,!0)},this)},this)}var r=t("./gradientcontainer"),o=t("./color");i.prototype=Object.create(r.prototype),i.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,e.exports=i},{"./color":3,"./gradientcontainer":9}],13:[function(t,e,n){var i=function(){i.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-i.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};i.options={logging:!1},e.exports=i},{}],14:[function(t,e,n){function i(t,e){this.node=t,this.parent=e,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function r(t){var e=t.options[t.selectedIndex||0];return e?e.text||"":""}function o(t){if(t&&"matrix"===t[1])return t[2].split(",").map(function(t){return parseFloat(t.trim())});if(t&&"matrix3d"===t[1]){var e=t[2].split(",").map(function(t){return parseFloat(t.trim())});return[e[0],e[1],e[4],e[5],e[12],e[13]]}}function a(t){return t.toString().indexOf("%")!==-1}function s(t){return t.replace("px","")}function u(t){return parseFloat(t)}var l=t("./color"),c=t("./utils"),d=c.getBounds,p=c.parseBackgrounds,g=c.offsetBounds;i.prototype.cloneTo=function(t){t.visible=this.visible,t.borders=this.borders,t.bounds=this.bounds,t.clip=this.clip,t.backgroundClip=this.backgroundClip,t.computedStyles=this.computedStyles,t.styles=this.styles,t.backgroundImages=this.backgroundImages,t.opacity=this.opacity},i.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},i.prototype.assignStack=function(t){this.stack=t,t.children.push(this)},i.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},i.prototype.css=function(t){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[t]||(this.styles[t]=this.computedStyles[t])},i.prototype.prefixedCss=function(t){var e=["webkit","moz","ms","o"],n=this.css(t);return void 0===n&&e.some(function(e){return n=this.css(e+t.substr(0,1).toUpperCase()+t.substr(1)),void 0!==n},this),void 0===n?null:n},i.prototype.computedStyle=function(t){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,t)},i.prototype.cssInt=function(t){var e=parseInt(this.css(t),10);return isNaN(e)?0:e},i.prototype.color=function(t){return this.colors[t]||(this.colors[t]=new l(this.css(t)))},i.prototype.cssFloat=function(t){var e=parseFloat(this.css(t));return isNaN(e)?0:e},i.prototype.fontWeight=function(){var t=this.css("fontWeight");switch(parseInt(t,10)){case 401:t="bold";break;case 400:t="normal"}return t},i.prototype.parseClip=function(){var t=this.css("clip").match(this.CLIP);return t?{top:parseInt(t[1],10),right:parseInt(t[2],10),bottom:parseInt(t[3],10),left:parseInt(t[4],10)}:null},i.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=p(this.css("backgroundImage")))},i.prototype.cssList=function(t,e){var n=(this.css(t)||"").split(",");return n=n[e||0]||n[0]||"auto",n=n.trim().split(" "),1===n.length&&(n=[n[0],a(n[0])?"auto":n[0]]),n},i.prototype.parseBackgroundSize=function(t,e,n){var i,r,o=this.cssList("backgroundSize",n);if(a(o[0]))i=t.width*parseFloat(o[0])/100;else{if(/contain|cover/.test(o[0])){var s=t.width/t.height,u=e.width/e.height;return s<u^"contain"===o[0]?{width:t.height*u,height:t.height}:{width:t.width,height:t.width/u}}i=parseInt(o[0],10)}return r="auto"===o[0]&&"auto"===o[1]?e.height:"auto"===o[1]?i/e.width*e.height:a(o[1])?t.height*parseFloat(o[1])/100:parseInt(o[1],10),"auto"===o[0]&&(i=r/e.height*e.width),{width:i,height:r}},i.prototype.parseBackgroundPosition=function(t,e,n,i){var r,o,s=this.cssList("backgroundPosition",n);return r=a(s[0])?(t.width-(i||e).width)*(parseFloat(s[0])/100):parseInt(s[0],10),o="auto"===s[1]?r/e.width*e.height:a(s[1])?(t.height-(i||e).height)*parseFloat(s[1])/100:parseInt(s[1],10),"auto"===s[0]&&(r=o/e.height*e.width),{left:r,top:o}},i.prototype.parseBackgroundRepeat=function(t){return this.cssList("backgroundRepeat",t)[0]},i.prototype.parseTextShadows=function(){var t=this.css("textShadow"),e=[];if(t&&"none"!==t)for(var n=t.match(this.TEXT_SHADOW_PROPERTY),i=0;n&&i<n.length;i++){var r=n[i].match(this.TEXT_SHADOW_VALUES);e.push({color:new l(r[0]),offsetX:r[1]?parseFloat(r[1].replace("px","")):0,offsetY:r[2]?parseFloat(r[2].replace("px","")):0,blur:r[3]?r[3].replace("px",""):0})}return e},i.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var t=this.parseBounds(),e=this.prefixedCss("transformOrigin").split(" ").map(s).map(u);e[0]+=t.left,e[1]+=t.top,this.transformData={origin:e,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},i.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var t=this.prefixedCss("transform"),e=t?o(t.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=e?e:[1,0,0,1,0,0]}return this.transformMatrix},i.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?g(this.node):d(this.node))},i.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},i.prototype.getValue=function(){var t=this.node.value||"";return"SELECT"===this.node.tagName?t=r(this.node):"password"===this.node.type&&(t=Array(t.length+1).join("")),0===t.length?this.node.placeholder||"":t},i.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,i.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,i.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,i.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,e.exports=i},{"./color":3,"./utils":26}],15:[function(t,e,i){function r(t,e,i,r,o){G("Starting NodeParser"),this.renderer=e,this.options=o,this.range=null,this.support=i,this.renderQueue=[],this.stack=new J((!0),1,t.ownerDocument,null);var a=new q(t,null);if(o.background&&e.rectangle(0,0,e.width,e.height,new Q(o.background)),t===t.ownerDocument.documentElement){var s=new q(a.color("backgroundColor").isTransparent()?t.ownerDocument.body:t.ownerDocument.documentElement,null);e.rectangle(0,0,e.width,e.height,s.color("backgroundColor"))}a.visibile=a.isElementVisible(),this.createPseudoHideStyles(t.ownerDocument),this.disableAnimations(t.ownerDocument),this.nodes=L([a].concat(this.getChildren(a)).filter(function(t){return t.visible=t.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new j,G("Fetched nodes, total:",this.nodes.length),G("Calculate overflow clips"),this.calculateOverflowClips(),G("Start fetching images"),this.images=r.fetch(this.nodes.filter(D)),this.ready=this.images.ready.then(Y(function(){return G("Images loaded, starting parsing"),G("Creating stacking contexts"),this.createStackingContexts(),G("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),G("Render queue created with "+this.renderQueue.length+" items"),new n(Y(function(t){o.async?"function"==typeof o.async?o.async.call(this,this.renderQueue,t):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,t)):t():(this.renderQueue.forEach(this.paint,this),t())},this))},this))}function o(t){return t.parent&&t.parent.clip.length}function a(t){return t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})}function s(){}function u(t,e,n,i){return t.map(function(r,o){if(r.width>0){var a=e.left,s=e.top,u=e.width,l=e.height-t[2].width;switch(o){case 0:l=t[0].width,r.args=p({c1:[a,s],c2:[a+u,s],c3:[a+u-t[1].width,s+l],c4:[a+t[3].width,s+l]},i[0],i[1],n.topLeftOuter,n.topLeftInner,n.topRightOuter,n.topRightInner);break;case 1:a=e.left+e.width-t[1].width,u=t[1].width,r.args=p({c1:[a+u,s],c2:[a+u,s+l+t[2].width],c3:[a,s+l],c4:[a,s+t[0].width]},i[1],i[2],n.topRightOuter,n.topRightInner,n.bottomRightOuter,n.bottomRightInner);break;case 2:s=s+e.height-t[2].width,l=t[2].width,r.args=p({c1:[a+u,s+l],c2:[a,s+l],c3:[a+t[3].width,s],c4:[a+u-t[3].width,s]},i[2],i[3],n.bottomRightOuter,n.bottomRightInner,n.bottomLeftOuter,n.bottomLeftInner);break;case 3:u=t[3].width,r.args=p({c1:[a,s+l+t[2].width],c2:[a,s],c3:[a+u,s+t[0].width],c4:[a+u,s+l]},i[3],i[0],n.bottomLeftOuter,n.bottomLeftInner,n.topLeftOuter,n.topLeftInner)}}return r})}function l(t,e,n,i){var r=4*((Math.sqrt(2)-1)/3),o=n*r,a=i*r,s=t+n,u=e+i;return{topLeft:d({x:t,y:u},{x:t,y:u-a},{x:s-o,y:e},{x:s,y:e}),topRight:d({x:t,y:e},{x:t+o,y:e},{x:s,y:u-a},{x:s,y:u}),bottomRight:d({x:s,y:e},{x:s,y:e+a},{x:t+o,y:u},{x:t,y:u}),bottomLeft:d({x:s,y:u},{x:s-o,y:u},{x:t,y:e+a},{x:t,y:e})}}function c(t,e,n){var i=t.left,r=t.top,o=t.width,a=t.height,s=e[0][0]<o/2?e[0][0]:o/2,u=e[0][1]<a/2?e[0][1]:a/2,c=e[1][0]<o/2?e[1][0]:o/2,d=e[1][1]<a/2?e[1][1]:a/2,p=e[2][0]<o/2?e[2][0]:o/2,g=e[2][1]<a/2?e[2][1]:a/2,f=e[3][0]<o/2?e[3][0]:o/2,h=e[3][1]<a/2?e[3][1]:a/2,m=o-c,v=a-g,y=o-p,S=a-h;return{topLeftOuter:l(i,r,s,u).topLeft.subdivide(.5),topLeftInner:l(i+n[3].width,r+n[0].width,Math.max(0,s-n[3].width),Math.max(0,u-n[0].width)).topLeft.subdivide(.5),topRightOuter:l(i+m,r,c,d).topRight.subdivide(.5),topRightInner:l(i+Math.min(m,o+n[3].width),r+n[0].width,m>o+n[3].width?0:c-n[3].width,d-n[0].width).topRight.subdivide(.5),bottomRightOuter:l(i+y,r+v,p,g).bottomRight.subdivide(.5),bottomRightInner:l(i+Math.min(y,o-n[3].width),r+Math.min(v,a+n[0].width),Math.max(0,p-n[1].width),g-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:l(i,r+S,f,h).bottomLeft.subdivide(.5),bottomLeftInner:l(i+n[3].width,r+S,Math.max(0,f-n[3].width),h-n[2].width).bottomLeft.subdivide(.5)}}function d(t,e,n,i){var r=function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}};return{start:t,startControl:e,endControl:n,end:i,subdivide:function(o){var a=r(t,e,o),s=r(e,n,o),u=r(n,i,o),l=r(a,s,o),c=r(s,u,o),p=r(l,c,o);return[d(t,a,l,p),d(p,c,u,i)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,n.x,n.y,i.x,i.y])},curveToReversed:function(i){i.push(["bezierCurve",n.x,n.y,e.x,e.y,t.x,t.y])}}}function p(t,e,n,i,r,o,a){var s=[];return e[0]>0||e[1]>0?(s.push(["line",i[1].start.x,i[1].start.y]),i[1].curveTo(s)):s.push(["line",t.c1[0],t.c1[1]]),n[0]>0||n[1]>0?(s.push(["line",o[0].start.x,o[0].start.y]),o[0].curveTo(s),s.push(["line",a[0].end.x,a[0].end.y]),a[0].curveToReversed(s)):(s.push(["line",t.c2[0],t.c2[1]]),s.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(s.push(["line",r[1].end.x,r[1].end.y]),r[1].curveToReversed(s)):s.push(["line",t.c4[0],t.c4[1]]),s}function g(t,e,n,i,r,o,a){e[0]>0||e[1]>0?(t.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(t),i[1].curveTo(t)):t.push(["line",o,a]),(n[0]>0||n[1]>0)&&t.push(["line",r[0].start.x,r[0].start.y])}function f(t){return t.cssInt("zIndex")<0}function h(t){return t.cssInt("zIndex")>0}function m(t){return 0===t.cssInt("zIndex")}function v(t){return["inline","inline-block","inline-table"].indexOf(t.css("display"))!==-1}function y(t){return t instanceof J}function S(t){return t.node.data.trim().length>0}function b(t){return/^(normal|none|0px)$/.test(t.parent.css("letterSpacing"))}function C(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(e){var n=t.css("border"+e+"Radius"),i=n.split(" ");return i.length<=1&&(i[1]=i[0]),i.map(B)})}function T(t){return t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE}function w(t){var e=t.css("position"),n=["absolute","relative","fixed"].indexOf(e)!==-1?t.css("zIndex"):"auto";return"auto"!==n}function I(t){return"static"!==t.css("position")}function A(t){return"none"!==t.css("float")}function E(t){return["inline-block","inline-table"].indexOf(t.css("display"))!==-1}function F(t){var e=this;return function(){return!t.apply(e,arguments)}}function D(t){return t.node.nodeType===Node.ELEMENT_NODE}function x(t){return t.isPseudoElement===!0}function N(t){return t.node.nodeType===Node.TEXT_NODE}function O(t){return function(e,n){return e.cssInt("zIndex")+t.indexOf(e)/t.length-(n.cssInt("zIndex")+t.indexOf(n)/t.length)}}function _(t){return t.getOpacity()<1}function B(t){return parseInt(t,10)}function k(t){return t.width}function P(t){return t.node.nodeType!==Node.ELEMENT_NODE||["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(t.node.nodeName)===-1}function L(t){return[].concat.apply([],t)}function U(t){var e=t.substr(0,1);return e===t.substr(t.length-1)&&e.match(/'|"/)?t.substr(1,t.length-2):t}function R(t){for(var e,n=[],i=0,r=!1;t.length;)M(t[i])===r?(e=t.splice(0,i),e.length&&n.push(W.ucs2.encode(e)),r=!r,i=0):i++,i>=t.length&&(e=t.splice(0,i),e.length&&n.push(W.ucs2.encode(e)));return n}function M(t){return[32,13,10,9,45].indexOf(t)!==-1}function V(t){return/[^\u0000-\u00ff]/.test(t)}var G=t("./log"),W=t("punycode"),q=t("./nodecontainer"),z=t("./textcontainer"),H=t("./pseudoelementcontainer"),j=t("./fontmetrics"),Q=t("./color"),J=t("./stackingcontext"),Z=t("./utils"),Y=Z.bind,K=Z.getBounds,X=Z.parseBackgrounds,$=Z.offsetBounds;r.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(t){if(D(t)){x(t)&&t.appendToDOM(),t.borders=this.parseBorders(t);var e="hidden"===t.css("overflow")?[t.borders.clip]:[],n=t.parseClip();n&&["absolute","fixed"].indexOf(t.css("position"))!==-1&&e.push([["rect",t.bounds.left+n.left,t.bounds.top+n.top,n.right-n.left,n.bottom-n.top]]),t.clip=o(t)?t.parent.clip.concat(e):e,t.backgroundClip="hidden"!==t.css("overflow")?t.clip.concat([t.borders.clip]):t.clip,x(t)&&t.cleanDOM()}else N(t)&&(t.clip=o(t)?t.parent.clip:[]);x(t)||(t.bounds=null)},this)},r.prototype.asyncRenderer=function(t,e,n){n=n||Date.now(),this.paint(t[this.renderIndex++]),t.length===this.renderIndex?e():n+20>Date.now()?this.asyncRenderer(t,e,n):setTimeout(Y(function(){this.asyncRenderer(t,e)},this),0)},r.prototype.createPseudoHideStyles=function(t){this.createStyles(t,"."+H.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+H.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},r.prototype.disableAnimations=function(t){this.createStyles(t,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},r.prototype.createStyles=function(t,e){var n=t.createElement("style");n.innerHTML=e,t.body.appendChild(n)},r.prototype.getPseudoElements=function(t){var e=[[t]];if(t.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(t,":before"),i=this.getPseudoElement(t,":after");n&&e.push(n),i&&e.push(i)}return L(e)},r.prototype.getPseudoElement=function(t,e){var n=t.computedStyle(e);if(!n||!n.content||"none"===n.content||"-moz-alt-content"===n.content||"none"===n.display)return null;for(var i=U(n.content),r="url"===i.substr(0,3),o=document.createElement(r?"img":"html2canvaspseudoelement"),s=new H(o,t,e),u=n.length-1;u>=0;u--){var l=a(n.item(u));o.style[l]=n[l]}if(o.className=H.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+H.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,r)return o.src=X(i)[0].args[0],[s];var c=document.createTextNode(i);return o.appendChild(c),[s,new z(c,s)]},r.prototype.getChildren=function(t){return L([].filter.call(t.node.childNodes,T).map(function(e){var n=[e.nodeType===Node.TEXT_NODE?new z(e,t):new q(e,t)].filter(P);return e.nodeType===Node.ELEMENT_NODE&&n.length&&"TEXTAREA"!==e.tagName?n[0].isElementVisible()?n.concat(this.getChildren(n[0])):[]:n},this))},r.prototype.newStackingContext=function(t,e){var n=new J(e,t.getOpacity(),t.node,t.parent);t.cloneTo(n);var i=e?n.getParentStack(this):n.parent.stack;i.contexts.push(n),t.stack=n},r.prototype.createStackingContexts=function(){this.nodes.forEach(function(t){D(t)&&(this.isRootElement(t)||_(t)||w(t)||this.isBodyWithTransparentRoot(t)||t.hasTransform())?this.newStackingContext(t,!0):D(t)&&(I(t)&&m(t)||E(t)||A(t))?this.newStackingContext(t,!1):t.assignStack(t.parent.stack)},this)},r.prototype.isBodyWithTransparentRoot=function(t){return"BODY"===t.node.nodeName&&t.parent.color("backgroundColor").isTransparent()},r.prototype.isRootElement=function(t){return null===t.parent},r.prototype.sortStackingContexts=function(t){t.contexts.sort(O(t.contexts.slice(0))),t.contexts.forEach(this.sortStackingContexts,this)},r.prototype.parseTextBounds=function(t){return function(e,n,i){if("none"!==t.parent.css("textDecoration").substr(0,4)||0!==e.trim().length){if(this.support.rangeBounds&&!t.parent.hasTransform()){var r=i.slice(0,n).join("").length;return this.getRangeBounds(t.node,r,e.length)}if(t.node&&"string"==typeof t.node.data){var o=t.node.splitText(e.length),a=this.getWrapperBounds(t.node,t.parent.hasTransform());return t.node=o,a}}else this.support.rangeBounds&&!t.parent.hasTransform()||(t.node=t.node.splitText(e.length));return{}}},r.prototype.getWrapperBounds=function(t,e){var n=t.ownerDocument.createElement("html2canvaswrapper"),i=t.parentNode,r=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),i.replaceChild(n,t);var o=e?$(n):K(n);return i.replaceChild(r,n),o},r.prototype.getRangeBounds=function(t,e,n){var i=this.range||(this.range=t.ownerDocument.createRange());return i.setStart(t,e),i.setEnd(t,e+n),i.getBoundingClientRect()},r.prototype.parse=function(t){var e=t.contexts.filter(f),n=t.children.filter(D),i=n.filter(F(A)),r=i.filter(F(I)).filter(F(v)),o=n.filter(F(I)).filter(A),a=i.filter(F(I)).filter(v),u=t.contexts.concat(i.filter(I)).filter(m),l=t.children.filter(N).filter(S),c=t.contexts.filter(h);e.concat(r).concat(o).concat(a).concat(u).concat(l).concat(c).forEach(function(t){this.renderQueue.push(t),y(t)&&(this.parse(t),this.renderQueue.push(new s))},this)},r.prototype.paint=function(t){try{t instanceof s?this.renderer.ctx.restore():N(t)?(x(t.parent)&&t.parent.appendToDOM(),this.paintText(t),x(t.parent)&&t.parent.cleanDOM()):this.paintNode(t)}catch(t){if(G(t),this.options.strict)throw t}},r.prototype.paintNode=function(t){y(t)&&(this.renderer.setOpacity(t.opacity),this.renderer.ctx.save(),t.hasTransform()&&this.renderer.setTransform(t.parseTransform())),"INPUT"===t.node.nodeName&&"checkbox"===t.node.type?this.paintCheckbox(t):"INPUT"===t.node.nodeName&&"radio"===t.node.type?this.paintRadio(t):this.paintElement(t)},r.prototype.paintElement=function(t){var e=t.parseBounds();this.renderer.clip(t.backgroundClip,function(){this.renderer.renderBackground(t,e,t.borders.borders.map(k))},this),this.renderer.clip(t.clip,function(){this.renderer.renderBorders(t.borders.borders)},this),this.renderer.clip(t.backgroundClip,function(){switch(t.node.nodeName){case"svg":case"IFRAME":var n=this.images.get(t.node);n?this.renderer.renderImage(t,e,t.borders,n):G("Error loading <"+t.node.nodeName+">",t.node);break;case"IMG":var i=this.images.get(t.node.src);i?this.renderer.renderImage(t,e,t.borders,i):G("Error loading <img>",t.node.src);break;case"CANVAS":this.renderer.renderImage(t,e,t.borders,{image:t.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(t)}},this)},r.prototype.paintCheckbox=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height),i={width:n-1,height:n-1,top:e.top,left:e.left},r=[3,3],o=[r,r,r,r],a=[1,1,1,1].map(function(t){return{color:new Q("#A5A5A5"),width:t}}),s=c(i,o,a);this.renderer.clip(t.backgroundClip,function(){this.renderer.rectangle(i.left+1,i.top+1,i.width-2,i.height-2,new Q("#DEDEDE")),this.renderer.renderBorders(u(a,i,s,o)),t.node.checked&&(this.renderer.font(new Q("#424242"),"normal","normal","bold",n-3+"px","arial"),this.renderer.text("",i.left+n/6,i.top+n-1))},this)},r.prototype.paintRadio=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height)-2;this.renderer.clip(t.backgroundClip,function(){this.renderer.circleStroke(e.left+1,e.top+1,n,new Q("#DEDEDE"),1,new Q("#A5A5A5")),t.node.checked&&this.renderer.circle(Math.ceil(e.left+n/4)+1,Math.ceil(e.top+n/4)+1,Math.floor(n/2),new Q("#424242"))},this)},r.prototype.paintFormValue=function(t){var e=t.getValue();if(e.length>0){var n=t.node.ownerDocument,i=n.createElement("html2canvaswrapper"),r=["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"];r.forEach(function(e){try{i.style[e]=t.css(e)}catch(t){G("html2canvas: Parse: Exception caught in renderFormValue: "+t.message)}});var o=t.parseBounds();i.style.position="fixed",i.style.left=o.left+"px",i.style.top=o.top+"px",i.textContent=e,n.body.appendChild(i),this.paintText(new z(i.firstChild,t)),n.body.removeChild(i)}},r.prototype.paintText=function(t){t.applyTextTransform();var e=W.ucs2.decode(t.node.data),n=this.options.letterRendering&&!b(t)||V(t.node.data)?e.map(function(t){return W.ucs2.encode([t])}):R(e),i=t.parent.fontWeight(),r=t.parent.css("fontSize"),o=t.parent.css("fontFamily"),a=t.parent.parseTextShadows();this.renderer.font(t.parent.color("color"),t.parent.css("fontStyle"),t.parent.css("fontVariant"),i,r,o),a.length?this.renderer.fontShadow(a[0].color,a[0].offsetX,a[0].offsetY,a[0].blur):this.renderer.clearShadow(),this.renderer.clip(t.parent.clip,function(){n.map(this.parseTextBounds(t),this).forEach(function(e,i){e&&(this.renderer.text(n[i],e.left,e.bottom),this.renderTextDecoration(t.parent,e,this.fontMetrics.getMetrics(o,r)))},this)},this)},r.prototype.renderTextDecoration=function(t,e,n){switch(t.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(e.left,Math.round(e.top+n.baseline+n.lineWidth),e.width,1,t.color("color"));break;case"overline":this.renderer.rectangle(e.left,Math.round(e.top),e.width,1,t.color("color"));break;case"line-through":this.renderer.rectangle(e.left,Math.ceil(e.top+n.middle+n.lineWidth),e.width,1,t.color("color"))}};var tt={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};r.prototype.parseBorders=function(t){var e=t.parseBounds(),n=C(t),i=["Top","Right","Bottom","Left"].map(function(e,n){var i=t.css("border"+e+"Style"),r=t.color("border"+e+"Color");"inset"===i&&r.isBlack()&&(r=new Q([255,255,255,r.a]));var o=tt[i]?tt[i][n]:null;return{width:t.cssInt("border"+e+"Width"),color:o?r[o[0]](o[1]):r,args:null}}),r=c(e,n,i);return{clip:this.parseBackgroundClip(t,r,i,n,e),borders:u(i,e,r,n)}},r.prototype.parseBackgroundClip=function(t,e,n,i,r){var o=t.css("backgroundClip"),a=[];switch(o){case"content-box":case"padding-box":g(a,i[0],i[1],e.topLeftInner,e.topRightInner,r.left+n[3].width,r.top+n[0].width),g(a,i[1],i[2],e.topRightInner,e.bottomRightInner,r.left+r.width-n[1].width,r.top+n[0].width),g(a,i[2],i[3],e.bottomRightInner,e.bottomLeftInner,r.left+r.width-n[1].width,r.top+r.height-n[2].width),g(a,i[3],i[0],e.bottomLeftInner,e.topLeftInner,r.left+n[3].width,r.top+r.height-n[2].width);break;default:g(a,i[0],i[1],e.topLeftOuter,e.topRightOuter,r.left,r.top),g(a,i[1],i[2],e.topRightOuter,e.bottomRightOuter,r.left+r.width,r.top),g(a,i[2],i[3],e.bottomRightOuter,e.bottomLeftOuter,r.left+r.width,r.top+r.height),g(a,i[3],i[0],e.bottomLeftOuter,e.topLeftOuter,r.left,r.top+r.height)}return a},e.exports=r},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(t,e,i){function r(t,e,i){var r="withCredentials"in new XMLHttpRequest;if(!e)return n.reject("No proxy configured");var o=s(r),l=u(e,t,o);return r?d(l):a(i,l,o).then(function(t){return h(t.content)})}function o(t,e,i){var r="crossOrigin"in new Image,o=s(r),l=u(e,t,o);return r?n.resolve(l):a(i,l,o).then(function(t){return"data:"+t.type+";base64,"+t.content})}function a(t,e,i){return new n(function(n,r){var o=t.createElement("script"),a=function(){delete window.OfficeBrowserFeedback.html2canvas.proxy[i],t.body.removeChild(o)};window.OfficeBrowserFeedback.html2canvas.proxy[i]=function(t){a(),n(t)},o.src=e,o.onerror=function(t){a(),r(t)},t.body.appendChild(o)})}function s(t){return t?"":"html2canvas_"+Date.now()+"_"+ ++m+"_"+Math.round(1e5*Math.random())}function u(t,e,n){return t+"?url="+encodeURIComponent(e)+(n.length?"&callback=html2canvas.proxy."+n:"")}function l(t){return function(e){var n,i=new DOMParser;try{
n=i.parseFromString(e,"text/html")}catch(t){g("DOMParser not supported, falling back to createHTMLDocument"),n=document.implementation.createHTMLDocument("");try{n.open(),n.write(e),n.close()}catch(t){g("createHTMLDocument write not supported, falling back to document.body.innerHTML"),n.body.innerHTML=e}}var r=n.querySelector("base");if(!r||!r.href.host){var o=n.createElement("base");o.href=t,n.head.insertBefore(o,n.head.firstChild)}return n}}function c(t,e,n,i,o,a){return new r(t,e,window.document).then(l(t)).then(function(t){return f(t,n,i,o,a,0,0)})}var d=t("./xhr"),p=t("./utils"),g=t("./log"),f=t("./clone"),h=p.decode64,m=0;i.Proxy=r,i.ProxyURL=o,i.loadUrlDocument=c},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(t,e,i){function r(t,e){var i=document.createElement("a");i.href=t,t=i.href,this.src=t,this.image=new Image;var r=this;this.promise=new n(function(n,i){r.image.crossOrigin="Anonymous",r.image.onload=n,r.image.onerror=i,new o(t,e,document).then(function(t){r.image.src=t}).catch(i)})}var o=t("./proxy").ProxyURL;e.exports=r},{"./proxy":16}],18:[function(t,e,n){function i(t,e,n){r.call(this,t,e),this.isPseudoElement=!0,this.before=":before"===n}var r=t("./nodecontainer");i.prototype.cloneTo=function(t){i.prototype.cloneTo.call(this,t),t.isPseudoElement=!0,t.before=this.before},i.prototype=Object.create(r.prototype),i.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},i.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},i.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},i.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",i.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",e.exports=i},{"./nodecontainer":14}],19:[function(t,e,n){function i(t,e,n,i,r){this.width=t,this.height=e,this.images=n,this.options=i,this.document=r}var r=t("./log");i.prototype.renderImage=function(t,e,n,i){var r=t.cssInt("paddingLeft"),o=t.cssInt("paddingTop"),a=t.cssInt("paddingRight"),s=t.cssInt("paddingBottom"),u=n.borders,l=e.width-(u[1].width+u[3].width+r+a),c=e.height-(u[0].width+u[2].width+o+s);this.drawImage(i,0,0,i.image.width||l,i.image.height||c,e.left+r+u[3].width,e.top+o+u[0].width,l,c)},i.prototype.renderBackground=function(t,e,n){e.height>0&&e.width>0&&(this.renderBackgroundColor(t,e),this.renderBackgroundImage(t,e,n))},i.prototype.renderBackgroundColor=function(t,e){var n=t.color("backgroundColor");n.isTransparent()||this.rectangle(e.left,e.top,e.width,e.height,n)},i.prototype.renderBorders=function(t){t.forEach(this.renderBorder,this)},i.prototype.renderBorder=function(t){t.color.isTransparent()||null===t.args||this.drawShape(t.args,t.color)},i.prototype.renderBackgroundImage=function(t,e,n){var i=t.parseBackgroundImages();i.reverse().forEach(function(i,o,a){switch(i.method){case"url":var s=this.images.get(i.args[0]);s?this.renderBackgroundRepeating(t,e,s,a.length-(o+1),n):r("Error loading background-image",i.args[0]);break;case"linear-gradient":case"gradient":var u=this.images.get(i.value);u?this.renderBackgroundGradient(u,e,n):r("Error loading background-image",i.args[0]);break;case"none":break;default:r("Unknown background-image type",i.args[0])}},this)},i.prototype.renderBackgroundRepeating=function(t,e,n,i,r){var o=t.parseBackgroundSize(e,n.image,i),a=t.parseBackgroundPosition(e,n.image,i,o),s=t.parseBackgroundRepeat(i);switch(s){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,a,o,e,e.left+r[3],e.top+a.top+r[0],99999,o.height,r);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,a,o,e,e.left+a.left+r[3],e.top+r[0],o.width,99999,r);break;case"no-repeat":this.backgroundRepeatShape(n,a,o,e,e.left+a.left+r[3],e.top+a.top+r[0],o.width,o.height,r);break;default:this.renderBackgroundRepeat(n,a,o,{top:e.top,left:e.left},r[3],r[0])}},e.exports=i},{"./log":13}],20:[function(t,e,n){function i(t,e){o.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=t,this.canvas.height=e),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},s("Initialized CanvasRenderer with size",t,"x",e)}function r(t){return t.length>0}var o=t("../renderer"),a=t("../lineargradientcontainer"),s=t("../log");i.prototype=Object.create(o.prototype),i.prototype.setFillStyle=function(t){return this.ctx.fillStyle="object"==typeof t&&t.isColor?t.toString():t,this.ctx},i.prototype.rectangle=function(t,e,n,i,r){this.setFillStyle(r).fillRect(t,e,n,i)},i.prototype.circle=function(t,e,n,i){this.setFillStyle(i),this.ctx.beginPath(),this.ctx.arc(t+n/2,e+n/2,n/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},i.prototype.circleStroke=function(t,e,n,i,r,o){this.circle(t,e,n,i),this.ctx.strokeStyle=o.toString(),this.ctx.stroke()},i.prototype.drawShape=function(t,e){this.shape(t),this.setFillStyle(e).fill()},i.prototype.taints=function(t){if(null===t.tainted){this.taintCtx.drawImage(t.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),t.tainted=!1}catch(e){this.taintCtx=document.createElement("canvas").getContext("2d"),t.tainted=!0}}return t.tainted},i.prototype.drawImage=function(t,e,n,i,r,o,a,s,u){this.taints(t)&&!this.options.allowTaint||this.ctx.drawImage(t.image,e,n,i,r,o,a,s,u)},i.prototype.clip=function(t,e,n){this.ctx.save(),t.filter(r).forEach(function(t){this.shape(t).clip()},this),e.call(n),this.ctx.restore()},i.prototype.shape=function(t){return this.ctx.beginPath(),t.forEach(function(t,e){"rect"===t[0]?this.ctx.rect.apply(this.ctx,t.slice(1)):this.ctx[0===e?"moveTo":t[0]+"To"].apply(this.ctx,t.slice(1))},this),this.ctx.closePath(),this.ctx},i.prototype.font=function(t,e,n,i,r,o){this.setFillStyle(t).font=[e,n,i,r,o].join(" ").split(",")[0]},i.prototype.fontShadow=function(t,e,n,i){this.setVariable("shadowColor",t.toString()).setVariable("shadowOffsetY",e).setVariable("shadowOffsetX",n).setVariable("shadowBlur",i)},i.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},i.prototype.setOpacity=function(t){this.ctx.globalAlpha=t},i.prototype.setTransform=function(t){this.ctx.translate(t.origin[0],t.origin[1]),this.ctx.transform.apply(this.ctx,t.matrix),this.ctx.translate(-t.origin[0],-t.origin[1])},i.prototype.setVariable=function(t,e){return this.variables[t]!==e&&(this.variables[t]=this.ctx[t]=e),this},i.prototype.text=function(t,e,n){this.ctx.fillText(t,e,n)},i.prototype.backgroundRepeatShape=function(t,e,n,i,r,o,a,s,u){var l=[["line",Math.round(r),Math.round(o)],["line",Math.round(r+a),Math.round(o)],["line",Math.round(r+a),Math.round(s+o)],["line",Math.round(r),Math.round(s+o)]];this.clip([l],function(){this.renderBackgroundRepeat(t,e,n,i,u[3],u[0])},this)},i.prototype.renderBackgroundRepeat=function(t,e,n,i,r,o){var a=Math.round(i.left+e.left+r),s=Math.round(i.top+e.top+o);this.setFillStyle(this.ctx.createPattern(this.resizeImage(t,n),"repeat")),this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},i.prototype.renderBackgroundGradient=function(t,e){if(t instanceof a){var n=this.ctx.createLinearGradient(e.left+e.width*t.x0,e.top+e.height*t.y0,e.left+e.width*t.x1,e.top+e.height*t.y1);t.colorStops.forEach(function(t){n.addColorStop(t.stop,t.color.toString())}),this.rectangle(e.left,e.top,e.width,e.height,n)}},i.prototype.resizeImage=function(t,e){var n=t.image;if(n.width===e.width&&n.height===e.height)return n;var i,r=document.createElement("canvas");return r.width=e.width,r.height=e.height,i=r.getContext("2d"),i.drawImage(n,0,0,n.width,n.height,0,0,e.width,e.height),r},e.exports=i},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(t,e,n){function i(t,e,n,i){r.call(this,n,i),this.ownStacking=t,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*e}var r=t("./nodecontainer");i.prototype=Object.create(r.prototype),i.prototype.getParentStack=function(t){var e=this.parent?this.parent.stack:null;return e?e.ownStacking?e:e.getParentStack(t):t.stack},e.exports=i},{"./nodecontainer":14}],22:[function(t,e,n){function i(t){this.rangeBounds=this.testRangeBounds(t),this.cors=this.testCORS(),this.svg=this.testSVG()}i.prototype.testRangeBounds=function(t){var e,n,i,r,o=!1;return t.createRange&&(e=t.createRange(),e.getBoundingClientRect&&(n=t.createElement("boundtest"),n.style.height="123px",n.style.display="block",t.body.appendChild(n),e.selectNode(n),i=e.getBoundingClientRect(),r=i.height,123===r&&(o=!0),t.body.removeChild(n))),o},i.prototype.testCORS=function(){return"undefined"!=typeof(new Image).crossOrigin},i.prototype.testSVG=function(){var t=new Image,e=document.createElement("canvas"),n=e.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),e.toDataURL()}catch(t){return!1}return!0},e.exports=i},{}],23:[function(t,e,i){function r(t){this.src=t,this.image=null;var e=this;this.promise=this.hasFabric().then(function(){return e.isInline(t)?n.resolve(e.inlineFormatting(t)):o(t)}).then(function(t){return new n(function(n){window.OfficeBrowserFeedback.html2canvas.svg.fabric.loadSVGFromString(t,e.createCanvas.call(e,n))})})}var o=t("./xhr"),a=t("./utils").decode64;r.prototype.hasFabric=function(){return window.OfficeBrowserFeedback.html2canvas.svg&&window.OfficeBrowserFeedback.html2canvas.svg.fabric?n.resolve():n.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},r.prototype.inlineFormatting=function(t){return/^data:image\/svg\+xml;base64,/.test(t)?this.decode64(this.removeContentType(t)):this.removeContentType(t)},r.prototype.removeContentType=function(t){return t.replace(/^data:image\/svg\+xml(;base64)?,/,"")},r.prototype.isInline=function(t){return/^data:image\/svg\+xml/i.test(t)},r.prototype.createCanvas=function(t){var e=this;return function(n,i){var r=new window.OfficeBrowserFeedback.html2canvas.svg.fabric.StaticCanvas("c");e.image=r.lowerCanvasEl,r.setWidth(i.width).setHeight(i.height).add(window.OfficeBrowserFeedback.html2canvas.svg.fabric.util.groupSVGElements(n,i)).renderAll(),t(r.lowerCanvasEl)}},r.prototype.decode64=function(t){return"function"==typeof window.atob?window.atob(t):a(t)},e.exports=r},{"./utils":26,"./xhr":28}],24:[function(t,e,i){function r(t,e){this.src=t,this.image=null;var i=this;this.promise=e?new n(function(e,n){i.image=new Image,i.image.onload=e,i.image.onerror=n,i.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(t),i.image.complete===!0&&e(i.image)}):this.hasFabric().then(function(){return new n(function(e){window.OfficeBrowserFeedback.html2canvas.svg.fabric.parseSVGDocument(t,i.createCanvas.call(i,e))})})}var o=t("./svgcontainer");r.prototype=Object.create(o.prototype),e.exports=r},{"./svgcontainer":23}],25:[function(t,e,n){function i(t,e){o.call(this,t,e)}function r(t,e,n){if(t.length>0)return e+n.toUpperCase()}var o=t("./nodecontainer");i.prototype=Object.create(o.prototype),i.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},i.prototype.transform=function(t){var e=this.node.data;switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,r);case"uppercase":return e.toUpperCase();default:return e}},e.exports=i},{"./nodecontainer":14}],26:[function(t,e,n){n.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},n.bind=function(t,e){return function(){return t.apply(e,arguments)}},n.decode64=function(t){var e,n,i,r,o,a,s,u,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=t.length,d="";for(e=0;e<c;e+=4)n=l.indexOf(t[e]),i=l.indexOf(t[e+1]),r=l.indexOf(t[e+2]),o=l.indexOf(t[e+3]),a=n<<2|i>>4,s=(15&i)<<4|r>>2,u=(3&r)<<6|o,d+=64===r?String.fromCharCode(a):64===o||o===-1?String.fromCharCode(a,s):String.fromCharCode(a,s,u);return d},n.getBounds=function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect(),n=null==t.offsetWidth?e.width:t.offsetWidth;return{top:e.top,bottom:e.bottom||e.top+e.height,right:e.left+n,left:e.left,width:n,height:null==t.offsetHeight?e.height:t.offsetHeight}}return{}},n.offsetBounds=function(t){var e=t.offsetParent?n.offsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,right:t.offsetLeft+e.left+t.offsetWidth,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},n.parseBackgrounds=function(t){var e,n,i,r,o,a,s,u=" \r\n\t",l=[],c=0,d=0,p=function(){e&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&s.push(n),"-"===e.substr(0,1)&&(r=e.indexOf("-",1)+1)>0&&(i=e.substr(0,r),e=e.substr(r)),l.push({prefix:i,method:e.toLowerCase(),value:o,args:s,image:null})),s=[],e=i=n=o=""};return s=[],e=i=n=o="",t.split("").forEach(function(t){if(!(0===c&&u.indexOf(t)>-1)){switch(t){case'"':a?a===t&&(a=null):a=t;break;case"(":if(a)break;if(0===c)return c=1,void(o+=t);d++;break;case")":if(a)break;if(1===c){if(0===d)return c=0,o+=t,void p();d--}break;case",":if(a)break;if(0===c)return void p();if(1===c&&0===d&&!e.match(/^url$/i))return s.push(n),n="",void(o+=t)}o+=t,0===c?e+=t:n+=t}}),p(),l}},{}],27:[function(t,e,n){function i(t){r.apply(this,arguments),this.type="linear"===t.args[0]?r.TYPES.LINEAR:r.TYPES.RADIAL}var r=t("./gradientcontainer");i.prototype=Object.create(r.prototype),e.exports=i},{"./gradientcontainer":9}],28:[function(t,e,i){function r(t){return new n(function(e,n){var i=new XMLHttpRequest;i.open("GET",t),i.onload=function(){200===i.status?e(i.responseText):n(new Error(i.statusText))},i.onerror=function(){n(new Error("Network Error"))},i.send()})}e.exports=r},{}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"es6-promise":39}]},{},[42,43,91]);
//# sourceMappingURL=officebrowserfeedback_floodgate.min.js.map
